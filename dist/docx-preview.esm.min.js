import e from"jszip";import t from"konva";function r(e,t,r,a){return new(r||(r=Promise))((function(n,s){function i(e){try{o(a.next(e))}catch(e){s(e)}}function l(e){try{o(a.throw(e))}catch(e){s(e)}}function o(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,l)}o((a=a.apply(e,t||[])).next())}))}function a(e,t,r,a){if("a"===r&&!a)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!a:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?a:"a"===r?a.call(e):a?a.value:t.get(e)}"function"==typeof SuppressedError&&SuppressedError;const n={"application/andrew-inset":["ez"],"application/appinstaller":["appinstaller"],"application/applixware":["aw"],"application/appx":["appx"],"application/appxbundle":["appxbundle"],"application/atom+xml":["atom"],"application/atomcat+xml":["atomcat"],"application/atomdeleted+xml":["atomdeleted"],"application/atomsvc+xml":["atomsvc"],"application/atsc-dwd+xml":["dwd"],"application/atsc-held+xml":["held"],"application/atsc-rsat+xml":["rsat"],"application/automationml-aml+xml":["aml"],"application/automationml-amlx+zip":["amlx"],"application/bdoc":["bdoc"],"application/calendar+xml":["xcs"],"application/ccxml+xml":["ccxml"],"application/cdfx+xml":["cdfx"],"application/cdmi-capability":["cdmia"],"application/cdmi-container":["cdmic"],"application/cdmi-domain":["cdmid"],"application/cdmi-object":["cdmio"],"application/cdmi-queue":["cdmiq"],"application/cpl+xml":["cpl"],"application/cu-seeme":["cu"],"application/cwl":["cwl"],"application/dash+xml":["mpd"],"application/dash-patch+xml":["mpp"],"application/davmount+xml":["davmount"],"application/docbook+xml":["dbk"],"application/dssc+der":["dssc"],"application/dssc+xml":["xdssc"],"application/ecmascript":["ecma"],"application/emma+xml":["emma"],"application/emotionml+xml":["emotionml"],"application/epub+zip":["epub"],"application/exi":["exi"],"application/express":["exp"],"application/fdf":["fdf"],"application/fdt+xml":["fdt"],"application/font-tdpfr":["pfr"],"application/geo+json":["geojson"],"application/gml+xml":["gml"],"application/gpx+xml":["gpx"],"application/gxf":["gxf"],"application/gzip":["gz"],"application/hjson":["hjson"],"application/hyperstudio":["stk"],"application/inkml+xml":["ink","inkml"],"application/ipfix":["ipfix"],"application/its+xml":["its"],"application/java-archive":["jar","war","ear"],"application/java-serialized-object":["ser"],"application/java-vm":["class"],"application/javascript":["*js"],"application/json":["json","map"],"application/json5":["json5"],"application/jsonml+json":["jsonml"],"application/ld+json":["jsonld"],"application/lgr+xml":["lgr"],"application/lost+xml":["lostxml"],"application/mac-binhex40":["hqx"],"application/mac-compactpro":["cpt"],"application/mads+xml":["mads"],"application/manifest+json":["webmanifest"],"application/marc":["mrc"],"application/marcxml+xml":["mrcx"],"application/mathematica":["ma","nb","mb"],"application/mathml+xml":["mathml"],"application/mbox":["mbox"],"application/media-policy-dataset+xml":["mpf"],"application/mediaservercontrol+xml":["mscml"],"application/metalink+xml":["metalink"],"application/metalink4+xml":["meta4"],"application/mets+xml":["mets"],"application/mmt-aei+xml":["maei"],"application/mmt-usd+xml":["musd"],"application/mods+xml":["mods"],"application/mp21":["m21","mp21"],"application/mp4":["mp4","mpg4","mp4s","m4p"],"application/msix":["msix"],"application/msixbundle":["msixbundle"],"application/msword":["doc","dot"],"application/mxf":["mxf"],"application/n-quads":["nq"],"application/n-triples":["nt"],"application/node":["cjs"],"application/octet-stream":["bin","dms","lrf","mar","so","dist","distz","pkg","bpk","dump","elc","deploy","exe","dll","deb","dmg","iso","img","msi","msp","msm","buffer"],"application/oda":["oda"],"application/oebps-package+xml":["opf"],"application/ogg":["ogx"],"application/omdoc+xml":["omdoc"],"application/onenote":["onetoc","onetoc2","onetmp","onepkg"],"application/oxps":["oxps"],"application/p2p-overlay+xml":["relo"],"application/patch-ops-error+xml":["xer"],"application/pdf":["pdf"],"application/pgp-encrypted":["pgp"],"application/pgp-keys":["asc"],"application/pgp-signature":["sig","*asc"],"application/pics-rules":["prf"],"application/pkcs10":["p10"],"application/pkcs7-mime":["p7m","p7c"],"application/pkcs7-signature":["p7s"],"application/pkcs8":["p8"],"application/pkix-attr-cert":["ac"],"application/pkix-cert":["cer"],"application/pkix-crl":["crl"],"application/pkix-pkipath":["pkipath"],"application/pkixcmp":["pki"],"application/pls+xml":["pls"],"application/postscript":["ai","eps","ps"],"application/provenance+xml":["provx"],"application/pskc+xml":["pskcxml"],"application/raml+yaml":["raml"],"application/rdf+xml":["rdf","owl"],"application/reginfo+xml":["rif"],"application/relax-ng-compact-syntax":["rnc"],"application/resource-lists+xml":["rl"],"application/resource-lists-diff+xml":["rld"],"application/rls-services+xml":["rs"],"application/route-apd+xml":["rapd"],"application/route-s-tsid+xml":["sls"],"application/route-usd+xml":["rusd"],"application/rpki-ghostbusters":["gbr"],"application/rpki-manifest":["mft"],"application/rpki-roa":["roa"],"application/rsd+xml":["rsd"],"application/rss+xml":["rss"],"application/rtf":["rtf"],"application/sbml+xml":["sbml"],"application/scvp-cv-request":["scq"],"application/scvp-cv-response":["scs"],"application/scvp-vp-request":["spq"],"application/scvp-vp-response":["spp"],"application/sdp":["sdp"],"application/senml+xml":["senmlx"],"application/sensml+xml":["sensmlx"],"application/set-payment-initiation":["setpay"],"application/set-registration-initiation":["setreg"],"application/shf+xml":["shf"],"application/sieve":["siv","sieve"],"application/smil+xml":["smi","smil"],"application/sparql-query":["rq"],"application/sparql-results+xml":["srx"],"application/sql":["sql"],"application/srgs":["gram"],"application/srgs+xml":["grxml"],"application/sru+xml":["sru"],"application/ssdl+xml":["ssdl"],"application/ssml+xml":["ssml"],"application/swid+xml":["swidtag"],"application/tei+xml":["tei","teicorpus"],"application/thraud+xml":["tfi"],"application/timestamped-data":["tsd"],"application/toml":["toml"],"application/trig":["trig"],"application/ttml+xml":["ttml"],"application/ubjson":["ubj"],"application/urc-ressheet+xml":["rsheet"],"application/urc-targetdesc+xml":["td"],"application/voicexml+xml":["vxml"],"application/wasm":["wasm"],"application/watcherinfo+xml":["wif"],"application/widget":["wgt"],"application/winhlp":["hlp"],"application/wsdl+xml":["wsdl"],"application/wspolicy+xml":["wspolicy"],"application/xaml+xml":["xaml"],"application/xcap-att+xml":["xav"],"application/xcap-caps+xml":["xca"],"application/xcap-diff+xml":["xdf"],"application/xcap-el+xml":["xel"],"application/xcap-ns+xml":["xns"],"application/xenc+xml":["xenc"],"application/xfdf":["xfdf"],"application/xhtml+xml":["xhtml","xht"],"application/xliff+xml":["xlf"],"application/xml":["xml","xsl","xsd","rng"],"application/xml-dtd":["dtd"],"application/xop+xml":["xop"],"application/xproc+xml":["xpl"],"application/xslt+xml":["*xsl","xslt"],"application/xspf+xml":["xspf"],"application/xv+xml":["mxml","xhvml","xvml","xvm"],"application/yang":["yang"],"application/yin+xml":["yin"],"application/zip":["zip"],"audio/3gpp":["*3gpp"],"audio/aac":["adts","aac"],"audio/adpcm":["adp"],"audio/amr":["amr"],"audio/basic":["au","snd"],"audio/midi":["mid","midi","kar","rmi"],"audio/mobile-xmf":["mxmf"],"audio/mp3":["*mp3"],"audio/mp4":["m4a","mp4a"],"audio/mpeg":["mpga","mp2","mp2a","mp3","m2a","m3a"],"audio/ogg":["oga","ogg","spx","opus"],"audio/s3m":["s3m"],"audio/silk":["sil"],"audio/wav":["wav"],"audio/wave":["*wav"],"audio/webm":["weba"],"audio/xm":["xm"],"font/collection":["ttc"],"font/otf":["otf"],"font/ttf":["ttf"],"font/woff":["woff"],"font/woff2":["woff2"],"image/aces":["exr"],"image/apng":["apng"],"image/avci":["avci"],"image/avcs":["avcs"],"image/avif":["avif"],"image/bmp":["bmp","dib"],"image/cgm":["cgm"],"image/dicom-rle":["drle"],"image/dpx":["dpx"],"image/emf":["emf"],"image/fits":["fits"],"image/g3fax":["g3"],"image/gif":["gif"],"image/heic":["heic"],"image/heic-sequence":["heics"],"image/heif":["heif"],"image/heif-sequence":["heifs"],"image/hej2k":["hej2"],"image/hsj2":["hsj2"],"image/ief":["ief"],"image/jls":["jls"],"image/jp2":["jp2","jpg2"],"image/jpeg":["jpeg","jpg","jpe"],"image/jph":["jph"],"image/jphc":["jhc"],"image/jpm":["jpm","jpgm"],"image/jpx":["jpx","jpf"],"image/jxr":["jxr"],"image/jxra":["jxra"],"image/jxrs":["jxrs"],"image/jxs":["jxs"],"image/jxsc":["jxsc"],"image/jxsi":["jxsi"],"image/jxss":["jxss"],"image/ktx":["ktx"],"image/ktx2":["ktx2"],"image/png":["png"],"image/sgi":["sgi"],"image/svg+xml":["svg","svgz"],"image/t38":["t38"],"image/tiff":["tif","tiff"],"image/tiff-fx":["tfx"],"image/webp":["webp"],"image/wmf":["wmf"],"message/disposition-notification":["disposition-notification"],"message/global":["u8msg"],"message/global-delivery-status":["u8dsn"],"message/global-disposition-notification":["u8mdn"],"message/global-headers":["u8hdr"],"message/rfc822":["eml","mime"],"model/3mf":["3mf"],"model/gltf+json":["gltf"],"model/gltf-binary":["glb"],"model/iges":["igs","iges"],"model/jt":["jt"],"model/mesh":["msh","mesh","silo"],"model/mtl":["mtl"],"model/obj":["obj"],"model/prc":["prc"],"model/step+xml":["stpx"],"model/step+zip":["stpz"],"model/step-xml+zip":["stpxz"],"model/stl":["stl"],"model/u3d":["u3d"],"model/vrml":["wrl","vrml"],"model/x3d+binary":["*x3db","x3dbz"],"model/x3d+fastinfoset":["x3db"],"model/x3d+vrml":["*x3dv","x3dvz"],"model/x3d+xml":["x3d","x3dz"],"model/x3d-vrml":["x3dv"],"text/cache-manifest":["appcache","manifest"],"text/calendar":["ics","ifb"],"text/coffeescript":["coffee","litcoffee"],"text/css":["css"],"text/csv":["csv"],"text/html":["html","htm","shtml"],"text/jade":["jade"],"text/javascript":["js","mjs"],"text/jsx":["jsx"],"text/less":["less"],"text/markdown":["md","markdown"],"text/mathml":["mml"],"text/mdx":["mdx"],"text/n3":["n3"],"text/plain":["txt","text","conf","def","list","log","in","ini"],"text/richtext":["rtx"],"text/rtf":["*rtf"],"text/sgml":["sgml","sgm"],"text/shex":["shex"],"text/slim":["slim","slm"],"text/spdx":["spdx"],"text/stylus":["stylus","styl"],"text/tab-separated-values":["tsv"],"text/troff":["t","tr","roff","man","me","ms"],"text/turtle":["ttl"],"text/uri-list":["uri","uris","urls"],"text/vcard":["vcard"],"text/vtt":["vtt"],"text/wgsl":["wgsl"],"text/xml":["*xml"],"text/yaml":["yaml","yml"],"video/3gpp":["3gp","3gpp"],"video/3gpp2":["3g2"],"video/h261":["h261"],"video/h263":["h263"],"video/h264":["h264"],"video/iso.segment":["m4s"],"video/jpeg":["jpgv"],"video/jpm":["*jpm","*jpgm"],"video/mj2":["mj2","mjp2"],"video/mp2t":["ts"],"video/mp4":["*mp4","mp4v","*mpg4"],"video/mpeg":["mpeg","mpg","mpe","m1v","m2v"],"video/ogg":["ogv"],"video/quicktime":["qt","mov"],"video/webm":["webm"]};var s,i,l;Object.freeze(n);s=new WeakMap,i=new WeakMap,l=new WeakMap;var o,c=new class{constructor(...e){s.set(this,new Map),i.set(this,new Map),l.set(this,new Map);for(const t of e)this.define(t)}define(e,t=!1){for(let[r,n]of Object.entries(e)){r=r.toLowerCase(),n=n.map((e=>e.toLowerCase())),a(this,l,"f").has(r)||a(this,l,"f").set(r,new Set);const e=a(this,l,"f").get(r);let o=!0;for(let l of n){const n=l.startsWith("*");if(l=n?l.slice(1):l,null==e||e.add(l),o&&a(this,i,"f").set(r,l),o=!1,n)continue;const c=a(this,s,"f").get(l);if(c&&c!=r&&!t)throw new Error(`"${r} -> ${l}" conflicts with "${c} -> ${l}". Pass \`force=true\` to override this definition.`);a(this,s,"f").set(l,r)}}return this}getType(e){var t;if("string"!=typeof e)return null;const r=e.replace(/^.*[/\\]/,"").toLowerCase(),n=r.replace(/^.*\./,"").toLowerCase(),i=r.length<e.length;return!(n.length<r.length-1)&&i?null:null!==(t=a(this,s,"f").get(n))&&void 0!==t?t:null}getExtension(e){var t,r;return"string"!=typeof e?null:null!==(r=(e=null===(t=null==e?void 0:e.split)||void 0===t?void 0:t.call(e,";")[0])&&a(this,i,"f").get(e.trim().toLowerCase()))&&void 0!==r?r:null}getAllExtensions(e){var t;return"string"!=typeof e?null:null!==(t=a(this,l,"f").get(e.toLowerCase()))&&void 0!==t?t:null}_freeze(){this.define=()=>{throw new Error("define() not allowed for built-in Mime objects. See https://github.com/broofa/mime/blob/main/README.md#custom-mime-instances")},Object.freeze(this);for(const e of a(this,l,"f").values())Object.freeze(e);return this}_getTestState(){return{types:a(this,s,"f"),extensions:a(this,i,"f")}}}(n)._freeze();!function(e){e.OfficeDocument="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",e.FontTable="http://schemas.openxmlformats.org/officeDocument/2006/relationships/fontTable",e.Image="http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",e.Numbering="http://schemas.openxmlformats.org/officeDocument/2006/relationships/numbering",e.Styles="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",e.StylesWithEffects="http://schemas.microsoft.com/office/2007/relationships/stylesWithEffects",e.Theme="http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",e.Settings="http://schemas.openxmlformats.org/officeDocument/2006/relationships/settings",e.WebSettings="http://schemas.openxmlformats.org/officeDocument/2006/relationships/webSettings",e.Hyperlink="http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",e.Footnotes="http://schemas.openxmlformats.org/officeDocument/2006/relationships/footnotes",e.Endnotes="http://schemas.openxmlformats.org/officeDocument/2006/relationships/endnotes",e.Footer="http://schemas.openxmlformats.org/officeDocument/2006/relationships/footer",e.Header="http://schemas.openxmlformats.org/officeDocument/2006/relationships/header",e.ExtendedProperties="http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",e.CoreProperties="http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",e.CustomProperties="http://schemas.openxmlformats.org/package/2006/relationships/metadata/custom-properties",e.Comments="http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments"}(o||(o={}));const p={wordml:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",drawingml:"http://schemas.openxmlformats.org/drawingml/2006/main",picture:"http://schemas.openxmlformats.org/drawingml/2006/picture",compatibility:"http://schemas.openxmlformats.org/markup-compatibility/2006",math:"http://schemas.openxmlformats.org/officeDocument/2006/math"},d={Px:{mul:1/9525,unit:"px"},Dxa:{mul:.05,unit:"pt"},Emu:{mul:1/12700,unit:"pt"},FontSize:{mul:.5,unit:"pt"},Border:{mul:.125,unit:"pt"},Point:{mul:1,unit:"pt"},RelativeRect:{mul:1e-5,unit:""},TablePercent:{mul:.02,unit:"%"},LineHeight:{mul:1/240,unit:""},Opacity:{mul:1e-5,unit:""},VmlEmu:{mul:1/12700,unit:""},degree:{mul:1/6e4,unit:"deg"}};function h(e,t=d.Dxa,r=!0){if(!e)return null;if("number"==typeof e){let a=e*t.mul;return r?`${a.toFixed(2)}${t.unit}`:a}if(/.+(p[xt]|%)$/.test(e))return e;let a=parseFloat(e)*t.mul;return r?`${a.toFixed(2)}${t.unit}`:a}function m(e,t,r){if(e.namespaceURI!=p.wordml)return!1;switch(e.localName){case"color":t.color=r.attr(e,"val");break;case"sz":t.fontSize=r.lengthAttr(e,"val",d.FontSize);break;default:return!1}return!0}class u{elements(e,t=null){const r=[];for(let a=0,n=e.childNodes.length;a<n;a++){let n=e.childNodes.item(a);1!=n.nodeType||null!=t&&n.localName!=t||r.push(n)}return r}element(e,t){for(let r=0,a=e.childNodes.length;r<a;r++){let a=e.childNodes.item(r);if(1==a.nodeType&&a.localName==t)return a}return null}elementAttr(e,t,r){let a=this.element(e,t);return a?this.attr(a,r):void 0}attrs(e){return Array.from(e.attributes)}attr(e,t){for(let r=0,a=e.attributes.length;r<a;r++){let a=e.attributes.item(r);if(a.localName==t)return a.value}return null}intAttr(e,t,r=null){let a=this.attr(e,t);return a?parseInt(a):r}hexAttr(e,t,r=null){let a=this.attr(e,t);return a?parseInt(a,16):r}floatAttr(e,t,r=null){let a=this.attr(e,t);return a?parseFloat(a):r}boolAttr(e,t,r=null){return function(e,t=!1){switch(e){case"1":case"on":case"true":return!0;case"0":case"off":case"false":return!1;default:return t}}(this.attr(e,t),r)}lengthAttr(e,t,r=d.Dxa,a){var n;return null!==(n=h(this.attr(e,t),r))&&void 0!==n?n:a}numberAttr(e,t,r=d.Dxa,a=0){var n;return null!==(n=h(this.attr(e,t),r,!1))&&void 0!==n?n:a}}const f=new u;class g{constructor(e,t){this._package=e,this.path=t}load(){return r(this,void 0,void 0,(function*(){this.rels=yield this._package.loadRelationships(this.path);const e=yield this._package.load(this.path),t=this._package.parseXmlDocument(e);this._package.options.keepOrigin&&(this._xmlDocument=t),this.parseXml(t.firstElementChild)}))}save(){var e;this._package.update(this.path,(e=this._xmlDocument,(new XMLSerializer).serializeToString(e)))}parseXml(e){}}const b={embedRegular:"regular",embedBold:"bold",embedItalic:"italic",embedBoldItalic:"boldItalic"};function y(e,t){return t.elements(e).map((e=>function(e,t){let r={name:t.attr(e,"name"),embedFontRefs:[]};for(let a of t.elements(e))switch(a.localName){case"family":r.family=t.attr(a,"val");break;case"altName":r.altName=t.attr(a,"val");break;case"embedRegular":case"embedBold":case"embedItalic":case"embedBoldItalic":r.embedFontRefs.push(v(a,t))}return r}(e,t)))}function v(e,t){return{id:t.attr(e,"id"),key:t.attr(e,"fontKey"),type:b[e.localName]}}class x extends g{parseXml(e){this.fonts=y(e,this._package.xmlParser)}}function k(e){return null==e?void 0:e.replace(/[ .]+/g,"-").replace(/[&]+/g,"and").toLowerCase()}function w(e){let t=e.lastIndexOf("/")+1;return[0==t?"":e.substring(0,t),0==t?e:e.substring(t)]}function S(e,t){try{const r="http://docx/";return new URL(e,r+t).toString().substring(r.length)}catch(r){return`${t}${e}`}}function P(e,t){return e.reduce(((e,r)=>(e[t(r)]=r,e)),{})}function C(e){return e&&"object"==typeof e&&!Array.isArray(e)}function M(e){return"string"==typeof e||e instanceof String}function N(e,...t){var r;if(!t.length)return e;const a=t.shift();if(C(e)&&C(a))for(const t in a)if(C(a[t])){N(null!==(r=e[t])&&void 0!==r?r:e[t]={},a[t])}else e[t]=a[t];return N(e,...t)}function T(e){return Array.isArray(e)?e:[e]}function A(){if("object"==typeof crypto){if("function"==typeof crypto.randomUUID)return crypto.randomUUID();if("function"==typeof crypto.getRandomValues&&"function"==typeof Uint8Array){return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,(e=>{const t=Number(e);return(t^crypto.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16)}))}}let e=(new Date).getTime(),t="undefined"!=typeof performance&&performance.now&&1e3*performance.now()||0;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(r=>{let a=16*Math.random();return e>0?(a=(e+a)%16|0,e=Math.floor(e/16)):(a=(t+a)%16|0,t=Math.floor(t/16)),("x"===r?a:3&a|8).toString(16)}))}class E{constructor(e,t){this._zip=e,this.options=t,this.xmlParser=new u}get(e){return this._zip.files[function(e){return e.startsWith("/")?e.substr(1):e}(e)]}update(e,t){this._zip.file(e,t)}static load(t,a){return r(this,void 0,void 0,(function*(){const r=yield e.loadAsync(t);return new E(r,a)}))}save(e="blob"){return this._zip.generateAsync({type:e})}load(e,t="string"){var r,a;return null!==(a=null===(r=this.get(e))||void 0===r?void 0:r.async(t))&&void 0!==a?a:Promise.resolve(null)}loadRelationships(e=null){return r(this,void 0,void 0,(function*(){let t="_rels/.rels";if(null!=e){const[r,a]=w(e);t=`${r}_rels/${a}.rels`}const r=yield this.load(t);return r?(a=this.parseXmlDocument(r).firstElementChild,(n=this.xmlParser).elements(a).map((e=>({id:n.attr(e,"Id"),type:n.attr(e,"Type"),target:n.attr(e,"Target"),targetMode:n.attr(e,"TargetMode")})))):null;var a,n}))}parseXmlDocument(e){return function(e,t=!1){var r;t&&(e=e.replace(/<[?].*[?]>/,"")),e=65279===(r=e).charCodeAt(0)?r.substring(1):r;const a=(new DOMParser).parseFromString(e,"application/xml"),n=null===(s=a.getElementsByTagName("parsererror")[0])||void 0===s?void 0:s.textContent;var s;if(n)throw new Error(n);return a}(e,this.options.trimXmlDeclaration)}}class R extends g{constructor(e,t,r){super(e,t),this._documentParser=r}parseXml(e){this.body=this._documentParser.parseDocumentFile(e)}}function $(e,t){return{type:t.attr(e,"val"),color:t.attr(e,"color"),size:t.lengthAttr(e,"sz",d.Border),offset:t.lengthAttr(e,"space",d.Point),frame:t.boolAttr(e,"frame"),shadow:t.boolAttr(e,"shadow")}}function j(e,t){var r={};for(let a of t.elements(e))switch(a.localName){case"left":r.left=$(a,t);break;case"top":r.top=$(a,t);break;case"right":r.right=$(a,t);break;case"bottom":r.bottom=$(a,t)}return r}var F,D,B;function I(e,t=f){var r,a;let n={},s={};for(let i of t.elements(e))switch(i.localName){case"pgSz":n.pageSize={width:t.lengthAttr(i,"w"),height:t.lengthAttr(i,"h"),orientation:t.attr(i,"orient")},s.pageSize={width:t.intAttr(i,"w"),height:t.intAttr(i,"h")};break;case"type":n.type=t.attr(i,"val");break;case"pgMar":n.pageMargins={left:t.lengthAttr(i,"left"),right:t.lengthAttr(i,"right"),top:t.lengthAttr(i,"top"),bottom:t.lengthAttr(i,"bottom"),header:t.lengthAttr(i,"header"),footer:t.lengthAttr(i,"footer"),gutter:t.lengthAttr(i,"gutter")},s.pageMargins={left:t.intAttr(i,"left"),right:t.intAttr(i,"right"),top:t.intAttr(i,"top"),bottom:t.intAttr(i,"bottom"),header:t.intAttr(i,"header"),footer:t.intAttr(i,"footer"),gutter:t.intAttr(i,"gutter")};break;case"cols":n.columns=L(i,t);break;case"headerReference":(null!==(r=n.headerRefs)&&void 0!==r?r:n.headerRefs=[]).push(_(i,t));break;case"footerReference":(null!==(a=n.footerRefs)&&void 0!==a?a:n.footerRefs=[]).push(_(i,t));break;case"titlePg":n.titlePage=t.boolAttr(i,"val",!0);break;case"pgBorders":n.pageBorders=j(i,t);break;case"pgNumType":n.pageNumber=O(i,t)}let{width:i,height:l}=s.pageSize,{left:o,right:c,top:p,bottom:d}=s.pageMargins;return n.contentSize={width:h(i-o-c),height:h(l-p-d)},n}function L(e,t){return{count:t.intAttr(e,"num"),space:t.lengthAttr(e,"space"),separator:t.boolAttr(e,"sep"),equalWidth:t.boolAttr(e,"equalWidth",!0),columns:t.elements(e,"col").map((e=>({width:t.lengthAttr(e,"w"),space:t.lengthAttr(e,"space")})))}}function O(e,t){return{chapSep:t.attr(e,"chapSep"),chapStyle:t.attr(e,"chapStyle"),format:t.attr(e,"fmt"),start:t.intAttr(e,"start")}}function _(e,t){return{id:t.attr(e,"id"),type:t.attr(e,"type")}}function H(e,t){let r={};for(let a of t.elements(e))V(a,r,t);return r}function V(e,t,r){return!!m(e,t,r)}function z(e,t){let r={};for(let a of t.elements(e))W(a,r,t);return r}function W(e,t,r){if(e.namespaceURI!=p.wordml)return!1;if(m(e,t,r))return!0;switch(e.localName){case"tabs":t.tabs=function(e,t){return t.elements(e,"tab").map((e=>({position:t.lengthAttr(e,"pos"),leader:t.attr(e,"leader"),style:t.attr(e,"val")})))}(e,r);break;case"sectPr":t.sectionProps=I(e,r);break;case"numPr":t.numbering=function(e,t){var r={};for(let a of t.elements(e))switch(a.localName){case"numId":r.id=t.attr(a,"val");break;case"ilvl":r.level=t.intAttr(a,"val")}return r}(e,r);break;case"spacing":return t.lineSpacing=function(e,t){return{before:t.lengthAttr(e,"before"),after:t.lengthAttr(e,"after"),line:t.intAttr(e,"line"),lineRule:t.attr(e,"lineRule")}}(e,r),!1;case"textAlignment":return t.textAlignment=r.attr(e,"val"),!1;case"keepLines":t.keepLines=r.boolAttr(e,"val",!0);break;case"keepNext":t.keepNext=r.boolAttr(e,"val",!0);break;case"pageBreakBefore":t.pageBreakBefore=r.boolAttr(e,"val",!0);break;case"outlineLvl":t.outlineLevel=r.intAttr(e,"val");break;case"pStyle":t.styleName=r.attr(e,"val");break;case"rPr":t.runProps=H(e,r);break;default:return!1}return!0}function U(e,t){let r={id:t.attr(e,"numId"),overrides:[]};for(let a of t.elements(e))switch(a.localName){case"abstractNumId":r.abstractId=t.attr(a,"val");break;case"lvlOverride":r.overrides.push(G(a,t))}return r}function q(e,t){let r={id:t.attr(e,"abstractNumId"),levels:[]};for(let a of t.elements(e))switch(a.localName){case"name":r.name=t.attr(a,"val");break;case"multiLevelType":r.multiLevelType=t.attr(a,"val");break;case"numStyleLink":r.numberingStyleLink=t.attr(a,"val");break;case"styleLink":r.styleLink=t.attr(a,"val");break;case"lvl":r.levels.push(X(a,t))}return r}function X(e,t){let r={level:t.intAttr(e,"ilvl")};for(let a of t.elements(e))switch(a.localName){case"start":r.start=t.attr(a,"val");break;case"lvlRestart":r.restart=t.intAttr(a,"val");break;case"numFmt":r.format=t.attr(a,"val");break;case"lvlText":r.text=t.attr(a,"val");break;case"lvlJc":r.justification=t.attr(a,"val");break;case"lvlPicBulletId":r.bulletPictureId=t.attr(a,"val");break;case"pStyle":r.paragraphStyle=t.attr(a,"val");break;case"pPr":r.paragraphProps=z(a,t);break;case"rPr":r.runProps=H(a,t)}return r}function G(e,t){let r={level:t.intAttr(e,"ilvl")};for(let a of t.elements(e))switch(a.localName){case"startOverride":r.start=t.intAttr(a,"val");break;case"lvl":r.numberingLevel=X(a,t)}return r}function J(e,t){var r=t.element(e,"pict"),a=r&&t.element(r,"shape"),n=a&&t.element(a,"imagedata");return n?{id:t.attr(e,"numPicBulletId"),referenceId:t.attr(n,"id"),style:t.attr(a,"style")}:null}!function(e){e.Continuous="continuous",e.NextPage="nextPage",e.NextColumn="nextColumn",e.EvenPage="evenPage",e.OddPage="oddPage"}(F||(F={}));class K extends g{constructor(e,t,r){super(e,t),this._documentParser=r}parseXml(e){Object.assign(this,function(e,t){let r={numberings:[],abstractNumberings:[],bulletPictures:[]};for(let a of t.elements(e))switch(a.localName){case"num":r.numberings.push(U(a,t));break;case"abstractNum":r.abstractNumberings.push(q(a,t));break;case"numPicBullet":r.bulletPictures.push(J(a,t))}return r}(e,this._package.xmlParser)),this.domNumberings=this._documentParser.parseNumberingFile(e)}}class Y extends g{constructor(e,t,r){super(e,t),this._documentParser=r}parseXml(e){this.styles=this._documentParser.parseStylesFile(e)}}!function(e){e.Document="document",e.Paragraph="paragraph",e.Run="run",e.Break="break",e.NoBreakHyphen="noBreakHyphen",e.Table="table",e.Row="row",e.Cell="cell",e.Hyperlink="hyperlink",e.Drawing="drawing",e.Image="image",e.Text="text",e.Tab="tab",e.Symbol="symbol",e.BookmarkStart="bookmarkStart",e.BookmarkEnd="bookmarkEnd",e.Footer="footer",e.Header="header",e.FootnoteReference="footnoteReference",e.EndnoteReference="endnoteReference",e.Footnote="footnote",e.Endnote="endnote",e.SimpleField="simpleField",e.ComplexField="complexField",e.Instruction="instruction",e.VmlPicture="vmlPicture",e.Shape="shape",e.MmlMath="mmlMath",e.MmlMathParagraph="mmlMathParagraph",e.MmlFraction="mmlFraction",e.MmlFunction="mmlFunction",e.MmlFunctionName="mmlFunctionName",e.MmlNumerator="mmlNumerator",e.MmlDenominator="mmlDenominator",e.MmlRadical="mmlRadical",e.MmlBase="mmlBase",e.MmlDegree="mmlDegree",e.MmlSuperscript="mmlSuperscript",e.MmlSubscript="mmlSubscript",e.MmlPreSubSuper="mmlPreSubSuper",e.MmlSubArgument="mmlSubArgument",e.MmlSuperArgument="mmlSuperArgument",e.MmlNary="mmlNary",e.MmlDelimiter="mmlDelimiter",e.MmlRun="mmlRun",e.MmlEquationArray="mmlEquationArray",e.MmlLimit="mmlLimit",e.MmlLimitLower="mmlLimitLower",e.MmlMatrix="mmlMatrix",e.MmlMatrixRow="mmlMatrixRow",e.MmlBox="mmlBox",e.MmlBar="mmlBar",e.MmlGroupChar="mmlGroupChar",e.VmlElement="vmlElement",e.Inserted="inserted",e.Deleted="deleted",e.DeletedText="deletedText",e.Comment="comment",e.CommentReference="commentReference",e.CommentRangeStart="commentRangeStart",e.CommentRangeEnd="commentRangeEnd"}(D||(D={}));class Z{constructor(){this.children=[],this.cssStyle={}}}!function(e){e.Inline="Inline",e.None="None",e.TopAndBottom="TopAndBottom",e.Tight="Tight",e.Through="Through",e.Square="Square",e.Polygon="Polygon"}(B||(B={}));class Q extends Z{constructor(){super(...arguments),this.type=D.Header}}class ee extends Z{constructor(){super(...arguments),this.type=D.Footer}}class te extends g{constructor(e,t,r){super(e,t),this._documentParser=r}parseXml(e){this.rootElement=this.createRootElement(),this.rootElement.children=this._documentParser.parseBodyElements(e)}}class re extends te{createRootElement(){return new Q}}class ae extends te{createRootElement(){return new ee}}function ne(e){if(void 0!==e)return parseInt(e)}class se extends g{parseXml(e){this.props=function(e,t){const r={};for(let a of t.elements(e))switch(a.localName){case"Template":r.template=a.textContent;break;case"Pages":r.pages=ne(a.textContent);break;case"Words":r.words=ne(a.textContent);break;case"Characters":r.characters=ne(a.textContent);break;case"Application":r.application=a.textContent;break;case"Lines":r.lines=ne(a.textContent);break;case"Paragraphs":r.paragraphs=ne(a.textContent);break;case"Company":r.company=a.textContent;break;case"AppVersion":r.appVersion=a.textContent}return r}(e,this._package.xmlParser)}}class ie extends g{parseXml(e){this.props=function(e,t){const r={};for(let a of t.elements(e))switch(a.localName){case"title":r.title=a.textContent;break;case"description":r.description=a.textContent;break;case"subject":r.subject=a.textContent;break;case"creator":r.creator=a.textContent;break;case"keywords":r.keywords=a.textContent;break;case"language":r.language=a.textContent;break;case"lastModifiedBy":r.lastModifiedBy=a.textContent;break;case"revision":a.textContent&&(r.revision=parseInt(a.textContent))}return r}(e,this._package.xmlParser)}}class le{}function oe(e,t){var r={name:t.attr(e,"name"),colors:{}};for(let s of t.elements(e)){var a=t.element(s,"srgbClr"),n=t.element(s,"sysClr");a?r.colors[s.localName]=t.attr(a,"val"):n&&(r.colors[s.localName]=t.attr(n,"lastClr"))}return r}function ce(e,t){var r={name:t.attr(e,"name")};for(let a of t.elements(e))switch(a.localName){case"majorFont":r.majorFont=pe(a,t);break;case"minorFont":r.minorFont=pe(a,t)}return r}function pe(e,t){return{latinTypeface:t.elementAttr(e,"latin","typeface"),eaTypeface:t.elementAttr(e,"ea","typeface"),csTypeface:t.elementAttr(e,"cs","typeface")}}class de extends g{constructor(e,t){super(e,t)}parseXml(e){this.theme=function(e,t){var r=new le,a=t.element(e,"themeElements");for(let e of t.elements(a))switch(e.localName){case"clrScheme":r.colorScheme=oe(e,t);break;case"fontScheme":r.fontScheme=ce(e,t)}return r}(e,this._package.xmlParser)}}class he{}class me extends he{constructor(){super(...arguments),this.type=D.Footnote}}class ue extends he{constructor(){super(...arguments),this.type=D.Endnote}}class fe extends g{constructor(e,t,r){super(e,t),this._documentParser=r}}class ge extends fe{constructor(e,t,r){super(e,t,r)}parseXml(e){this.notes=this._documentParser.parseNotes(e,"footnote",me)}}class be extends fe{constructor(e,t,r){super(e,t,r)}parseXml(e){this.notes=this._documentParser.parseNotes(e,"endnote",ue)}}function ye(e,t){var r={defaultNoteIds:[]};for(let a of t.elements(e))switch(a.localName){case"numFmt":r.nummeringFormat=t.attr(a,"val");break;case"footnote":case"endnote":r.defaultNoteIds.push(t.attr(a,"id"))}return r}class ve extends g{constructor(e,t){super(e,t)}parseXml(e){this.settings=function(e,t){var r={};for(let a of t.elements(e))switch(a.localName){case"defaultTabStop":r.defaultTabStop=t.lengthAttr(a,"val");break;case"footnotePr":r.footnoteProps=ye(a,t);break;case"endnotePr":r.endnoteProps=ye(a,t);break;case"autoHyphenation":r.autoHyphenation=t.boolAttr(a,"val")}return r}(e,this._package.xmlParser)}}class xe extends g{parseXml(e){this.props=function(e,t){return t.elements(e,"property").map((e=>{const r=e.firstChild;return{formatId:t.attr(e,"fmtid"),name:t.attr(e,"name"),type:r.nodeName,value:r.textContent}}))}(e,this._package.xmlParser)}}class ke extends g{constructor(e,t,r){super(e,t),this._documentParser=r}parseXml(e){this.comments=this._documentParser.parseComments(e),this.commentMap=P(this.comments,(e=>e.id))}}const we=[{type:o.OfficeDocument,target:"word/document.xml"},{type:o.ExtendedProperties,target:"docProps/app.xml"},{type:o.CoreProperties,target:"docProps/core.xml"},{type:o.CustomProperties,target:"docProps/custom.xml"}];class Se{constructor(){this.parts=[],this.partsMap={}}static load(e,t,a){return r(this,void 0,void 0,(function*(){var r=new Se;return r._options=a,r._parser=t,r._package=yield E.load(e,a),r.rels=yield r._package.loadRelationships(),yield Promise.all(we.map((e=>{var t;const a=null!==(t=r.rels.find((t=>t.type===e.type)))&&void 0!==t?t:e;return r.loadRelationshipPart(a.target,a.type)}))),r}))}save(e="blob"){return this._package.save(e)}loadRelationshipPart(e,t){var a;return r(this,void 0,void 0,(function*(){if(this.partsMap[e])return this.partsMap[e];if(!this._package.get(e))return null;let r=null;switch(t){case o.OfficeDocument:this.documentPart=r=new R(this._package,e,this._parser);break;case o.FontTable:this.fontTablePart=r=new x(this._package,e);break;case o.Numbering:this.numberingPart=r=new K(this._package,e,this._parser);break;case o.Styles:this.stylesPart=r=new Y(this._package,e,this._parser);break;case o.Theme:this.themePart=r=new de(this._package,e);break;case o.Footnotes:this.footnotesPart=r=new ge(this._package,e,this._parser);break;case o.Endnotes:this.endnotesPart=r=new be(this._package,e,this._parser);break;case o.Footer:r=new ae(this._package,e,this._parser);break;case o.Header:r=new re(this._package,e,this._parser);break;case o.CoreProperties:this.corePropsPart=r=new ie(this._package,e);break;case o.ExtendedProperties:this.extendedPropsPart=r=new se(this._package,e);break;case o.CustomProperties:r=new xe(this._package,e);break;case o.Settings:this.settingsPart=r=new ve(this._package,e);break;case o.Comments:this.commentsPart=r=new ke(this._package,e,this._parser)}if(null==r)return Promise.resolve(null);if(this.partsMap[e]=r,this.parts.push(r),yield r.load(),(null===(a=r.rels)||void 0===a?void 0:a.length)>0){const[e]=w(r.path);yield Promise.all(r.rels.map((t=>this.loadRelationshipPart(S(t.target,e),t.type))))}return r}))}loadDocumentImage(e,t){return r(this,void 0,void 0,(function*(){const r=yield this.loadResource(null!=t?t:this.documentPart,e,"blob");return this.blobToURL(r)}))}loadNumberingImage(e){return r(this,void 0,void 0,(function*(){const t=yield this.loadResource(this.numberingPart,e,"blob");return this.blobToURL(t)}))}loadFont(e,t){return r(this,void 0,void 0,(function*(){const r=yield this.loadResource(this.fontTablePart,e,"uint8array");return r?this.blobToURL(new Blob([Pe(r,t)])):r}))}blobToURL(e){return e?this._options.useBase64URL?function(e){return new Promise(((t,r)=>{const a=new FileReader;a.onloadend=()=>t(a.result),a.onerror=()=>r(),a.readAsDataURL(e)}))}(e):URL.createObjectURL(e):null}findPartByRelId(e,t=null){var r,a=(null!==(r=t.rels)&&void 0!==r?r:this.rels).find((t=>t.id==e));const n=t?w(t.path)[0]:"";return a?this.partsMap[S(a.target,n)]:null}getPathById(e,t){const r=e.rels.find((e=>e.id==t)),[a]=w(e.path);return r?S(r.target,a):null}loadResource(e,t,a){return r(this,void 0,void 0,(function*(){const r=this.getPathById(e,t);let n=c.getType(r);if(r){let e=yield this._package.load(r,a);return new Blob([e],{type:n})}return Promise.resolve(null)}))}}function Pe(e,t){const r=t.replace(/{|}|-/g,""),a=new Array(16);for(let e=0;e<16;e++)a[16-e-1]=parseInt(r.substr(2*e,2),16);for(let t=0;t<32;t++)e[t]=e[t]^a[t%16];return e}function Ce(e,t){return{type:D.BookmarkEnd,id:t.attr(e,"id")}}class Me extends Z{constructor(){super(...arguments),this.type=D.VmlElement,this.attrs={}}}function Ne(e,t){var r=new Me;switch(e.localName){case"rect":r.tagName="rect",Object.assign(r.attrs,{width:"100%",height:"100%"});break;case"oval":r.tagName="ellipse",Object.assign(r.attrs,{cx:"50%",cy:"50%",rx:"50%",ry:"50%"});break;case"line":r.tagName="line";break;case"shape":r.tagName="g";break;case"textbox":r.tagName="foreignObject",Object.assign(r.attrs,{width:"100%",height:"100%"});break;default:return null}for(const t of f.attrs(e))switch(t.localName){case"style":r.cssStyleText=t.value;break;case"fillcolor":r.attrs.fill=t.value;break;case"from":const[e,a]=Ae(t.value);Object.assign(r.attrs,{x1:e,y1:a});break;case"to":const[n,s]=Ae(t.value);Object.assign(r.attrs,{x2:n,y2:s})}for(const a of f.elements(e))switch(a.localName){case"stroke":Object.assign(r.attrs,Te(a));break;case"fill":Object.assign(r.attrs,{});break;case"imagedata":r.tagName="image",Object.assign(r.attrs,{width:"100%",height:"100%"}),r.imageHref={id:f.attr(a,"id"),title:f.attr(a,"title")};break;case"txbxContent":r.children.push(...t.parseBodyElements(a));break;default:const e=Ne(a,t);e&&r.children.push(e)}return r}function Te(e){var t;return{stroke:f.attr(e,"color"),"stroke-width":null!==(t=f.lengthAttr(e,"weight",d.Emu))&&void 0!==t?t:"1px"}}function Ae(e){return e.split(",")}class Ee extends Z{constructor(){super(...arguments),this.type=D.Comment}}class Re extends Z{constructor(e){super(),this.id=e,this.type=D.CommentReference}}class $e extends Z{constructor(e){super(),this.id=e,this.type=D.CommentRangeStart}}class je extends Z{constructor(e){super(),this.id=e,this.type=D.CommentRangeEnd}}var Fe="inherit",De="black",Be="black",Ie="transparent";const Le=[],Oe={oMath:D.MmlMath,oMathPara:D.MmlMathParagraph,f:D.MmlFraction,func:D.MmlFunction,fName:D.MmlFunctionName,num:D.MmlNumerator,den:D.MmlDenominator,rad:D.MmlRadical,deg:D.MmlDegree,e:D.MmlBase,sSup:D.MmlSuperscript,sSub:D.MmlSubscript,sPre:D.MmlPreSubSuper,sup:D.MmlSuperArgument,sub:D.MmlSubArgument,d:D.MmlDelimiter,nary:D.MmlNary,eqArr:D.MmlEquationArray,lim:D.MmlLimit,limLow:D.MmlLimitLower,m:D.MmlMatrix,mr:D.MmlMatrixRow,box:D.MmlBox,bar:D.MmlBar,groupChr:D.MmlGroupChar},_e={ignoreWidth:!1,debug:!1,ignoreTableWrap:!0,ignoreImageWrap:!0};class He{constructor(e){this.options=Object.assign(Object.assign({},_e),e)}parseNotes(e,t,r){let a=[];for(let n of f.elements(e,t)){const e=new r;e.id=f.attr(n,"id"),e.noteType=f.attr(n,"type"),e.children=this.parseBodyElements(n),a.push(e)}return a}parseComments(e){let t=[];for(let r of f.elements(e,"comment")){const e=new Ee;e.id=f.attr(r,"id"),e.author=f.attr(r,"author"),e.initials=f.attr(r,"initials"),e.date=f.attr(r,"date"),e.children=this.parseBodyElements(r),t.push(e)}return t}parseDocumentFile(e){let t=f.element(e,"body"),r=f.element(e,"background"),a=f.element(t,"sectPr"),n={};return a&&(n=I(a,f)),n.sectionId=A(),{type:D.Document,children:this.parseBodyElements(t),pages:[],props:n,cssStyle:r?this.parseBackground(r):{}}}parseBackground(e){let t={},r=ze.colorAttr(e,"color");return r&&(t["background-color"]=r),t}parseBodyElements(e){let t=[];for(let r of f.elements(e))switch(r.localName){case"p":t.push(this.parseParagraph(r));break;case"tbl":t.push(this.parseTable(r));break;case"sdt":t.push(...this.parseSdt(r,(e=>this.parseBodyElements(e))))}return t}parseStylesFile(e){let t=[];return ze.foreach(e,(e=>{switch(e.localName){case"style":t.push(this.parseStyle(e));break;case"docDefaults":t.push(this.parseDefaultStyles(e))}})),t}parseDefaultStyles(e){let t={id:null,name:null,target:null,basedOn:null,styles:[]};return ze.foreach(e,(e=>{switch(e.localName){case"rPrDefault":let r=f.element(e,"rPr");r&&t.styles.push({target:"span",values:this.parseDefaultProperties(r,{})});break;case"pPrDefault":let a=f.element(e,"pPr");a&&t.styles.push({target:"p",values:this.parseDefaultProperties(a,{})})}})),t}parseStyle(e){let t={id:f.attr(e,"styleId"),isDefault:f.boolAttr(e,"default"),name:null,target:null,basedOn:null,styles:[],linked:null};switch(f.attr(e,"type")){case"paragraph":t.target="p";break;case"table":t.target="table";break;case"character":t.target="span"}return ze.foreach(e,(e=>{switch(e.localName){case"basedOn":t.basedOn=f.attr(e,"val");break;case"name":t.name=f.attr(e,"val");break;case"link":t.linked=f.attr(e,"val");break;case"next":t.next=f.attr(e,"val");break;case"aliases":t.aliases=f.attr(e,"val").split(",");break;case"pPr":t.styles.push({target:"p",values:this.parseDefaultProperties(e,{})}),t.paragraphProps=z(e,f);break;case"rPr":t.styles.push({target:"span",values:this.parseDefaultProperties(e,{})}),t.runProps=H(e,f);break;case"tblPr":case"tcPr":t.styles.push({target:"td",values:this.parseDefaultProperties(e,{})});break;case"tblStylePr":for(let r of this.parseTableStyle(e))t.styles.push(r);break;case"rsid":case"qFormat":case"hidden":case"semiHidden":case"unhideWhenUsed":case"autoRedefine":case"uiPriority":break;default:this.options.debug&&console.warn(`DOCX: Unknown style element: ${e.localName}`)}})),t}parseTableStyle(e){let t=[],r=f.attr(e,"type"),a="",n="";switch(r){case"firstRow":n=".first-row",a="tr.first-row td";break;case"lastRow":n=".last-row",a="tr.last-row td";break;case"firstCol":n=".first-col",a="td.first-col";break;case"lastCol":n=".last-col",a="td.last-col";break;case"band1Vert":n=":not(.no-vband)",a="td.odd-col";break;case"band2Vert":n=":not(.no-vband)",a="td.even-col";break;case"band1Horz":n=":not(.no-hband)",a="tr.odd-row";break;case"band2Horz":n=":not(.no-hband)",a="tr.even-row";break;default:return[]}return ze.foreach(e,(e=>{switch(e.localName){case"pPr":t.push({target:`${a} p`,mod:n,values:this.parseDefaultProperties(e,{})});break;case"rPr":t.push({target:`${a} span`,mod:n,values:this.parseDefaultProperties(e,{})});break;case"tblPr":case"tcPr":t.push({target:a,mod:n,values:this.parseDefaultProperties(e,{})})}})),t}parseNumberingFile(e){let t=[];const r={};let a=[];return ze.foreach(e,(e=>{switch(e.localName){case"abstractNum":this.parseAbstractNumbering(e,a).forEach((e=>t.push(e)));break;case"numPicBullet":a.push(this.parseNumberingPicBullet(e));break;case"num":let n=f.attr(e,"numId"),s=f.elementAttr(e,"abstractNumId","val");r[s]=n}})),t.forEach((e=>e.id=r[e.id])),t}parseNumberingPicBullet(e){let t=f.element(e,"pict"),r=t&&f.element(t,"shape"),a=r&&f.element(r,"imagedata");return a?{id:f.intAttr(e,"numPicBulletId"),src:f.attr(a,"id"),style:f.attr(r,"style")}:null}parseAbstractNumbering(e,t){let r=[],a=f.attr(e,"abstractNumId");return ze.foreach(e,(e=>{if("lvl"===e.localName)r.push(this.parseNumberingLevel(a,e,t))})),r}parseNumberingLevel(e,t,r){let a={id:e,level:f.intAttr(t,"ilvl"),start:1,pStyleName:void 0,pStyle:{},rStyle:{},suff:"tab"};return ze.foreach(t,(e=>{switch(e.localName){case"start":a.start=f.intAttr(e,"val");break;case"pPr":this.parseDefaultProperties(e,a.pStyle);break;case"rPr":this.parseDefaultProperties(e,a.rStyle);break;case"lvlPicBulletId":let t=f.intAttr(e,"val");a.bullet=r.find((e=>e.id==t));break;case"lvlText":a.levelText=f.attr(e,"val");break;case"pStyle":a.pStyleName=f.attr(e,"val");break;case"numFmt":a.format=f.attr(e,"val");break;case"suff":a.suff=f.attr(e,"val")}})),a}parseSdt(e,t){const r=f.element(e,"sdtContent");return r?t(r):[]}parseInserted(e,t){var r,a;return{type:D.Inserted,children:null!==(a=null===(r=t(e))||void 0===r?void 0:r.children)&&void 0!==a?a:[]}}parseDeleted(e,t){var r,a;return{type:D.Deleted,children:null!==(a=null===(r=t(e))||void 0===r?void 0:r.children)&&void 0!==a?a:[]}}parseParagraph(e){let t={type:D.Paragraph,children:[]};for(let n of f.elements(e))switch(n.localName){case"pPr":this.parseParagraphProperties(n,t);break;case"r":t.children.push(this.parseRun(n,t));break;case"hyperlink":t.children.push(this.parseHyperlink(n,t));break;case"bookmarkStart":t.children.push((r=n,a=f,{type:D.BookmarkStart,id:a.attr(r,"id"),name:a.attr(r,"name"),colFirst:a.intAttr(r,"colFirst"),colLast:a.intAttr(r,"colLast")}));break;case"bookmarkEnd":t.children.push(Ce(n,f));break;case"commentRangeStart":t.children.push(new $e(f.attr(n,"id")));break;case"commentRangeEnd":t.children.push(new je(f.attr(n,"id")));break;case"oMath":case"oMathPara":t.children.push(this.parseMathElement(n));break;case"sdt":t.children.push(...this.parseSdt(n,(e=>this.parseParagraph(e).children)));break;case"ins":t.children.push(this.parseInserted(n,(e=>this.parseParagraph(e))));break;case"del":t.children.push(this.parseDeleted(n,(e=>this.parseParagraph(e))))}var r,a;if(0===t.children.length){let e={type:D.Break,break:"textWrapping"},r={type:D.Run,children:[e]};t.children=[r]}return t}parseParagraphProperties(e,t){this.parseDefaultProperties(e,t.cssStyle={},null,(e=>{if(W(e,t,f))return!0;switch(e.localName){case"pStyle":t.styleName=f.attr(e,"val");break;case"cnfStyle":t.className=We.classNameOfCnfStyle(e);break;case"framePr":this.parseFrame(e,t);break;case"rPr":break;default:return!1}return!0}))}parseFrame(e,t){"drop"==f.attr(e,"dropCap")&&(t.cssStyle.float="left")}parseHyperlink(e,t){let r={type:D.Hyperlink,parent:t,children:[]},a=f.attr(e,"anchor"),n=f.attr(e,"id");return a&&(r.href="#"+a),n&&(r.id=n),ze.foreach(e,(e=>{if("r"===e.localName)r.children.push(this.parseRun(e,r))})),r}parseRun(e,t){let r={type:D.Run,parent:t,children:[]};return ze.foreach(e,(e=>{switch((e=this.checkAlternateContent(e)).localName){case"t":let t=e.textContent;"preserve"===f.attr(e,"xml:space")&&(t=t.split(/\s/).join(" ")),r.children.push({type:D.Text,text:t});break;case"delText":r.children.push({type:D.DeletedText,text:e.textContent});break;case"commentReference":r.children.push(new Re(f.attr(e,"id")));break;case"fldSimple":r.children.push({type:D.SimpleField,instruction:f.attr(e,"instr"),lock:f.boolAttr(e,"lock",!1),dirty:f.boolAttr(e,"dirty",!1)});break;case"instrText":r.fieldRun=!0,r.children.push({type:D.Instruction,text:e.textContent});break;case"fldChar":r.fieldRun=!0,r.children.push({type:D.ComplexField,charType:f.attr(e,"fldCharType"),lock:f.boolAttr(e,"lock",!1),dirty:f.boolAttr(e,"dirty",!1)});break;case"noBreakHyphen":r.children.push({type:D.NoBreakHyphen});break;case"br":r.children.push({type:D.Break,break:f.attr(e,"type")||"textWrapping",props:{clear:f.attr(e,"clear")}});break;case"lastRenderedPageBreak":r.children.push({type:D.Break,break:"lastRenderedPageBreak"});break;case"sym":r.children.push({type:D.Symbol,font:f.attr(e,"font"),char:f.attr(e,"char")});break;case"tab":r.children.push({type:D.Tab});break;case"footnoteReference":r.children.push({type:D.FootnoteReference,id:f.attr(e,"id")});break;case"endnoteReference":r.children.push({type:D.EndnoteReference,id:f.attr(e,"id")});break;case"drawing":let a=this.parseDrawing(e);a&&(r.children=[a]);break;case"pict":r.children.push(this.parseVmlPicture(e));break;case"rPr":this.parseRunProperties(e,r)}})),r}parseMathElement(e){const t=`${e.localName}Pr`,r={type:Oe[e.localName],children:[]};for(const a of f.elements(e)){if(Oe[a.localName])r.children.push(this.parseMathElement(a));else if("r"==a.localName){let e=this.parseRun(a);e.type=D.MmlRun,r.children.push(e)}else a.localName==t&&(r.props=this.parseMathProperies(a))}return r}parseMathProperies(e){const t={};for(const r of f.elements(e))switch(r.localName){case"chr":t.char=f.attr(r,"val");break;case"vertJc":t.verticalJustification=f.attr(r,"val");break;case"pos":t.position=f.attr(r,"val");break;case"degHide":t.hideDegree=f.boolAttr(r,"val");break;case"begChr":t.beginChar=f.attr(r,"val");break;case"endChr":t.endChar=f.attr(r,"val")}return t}parseRunProperties(e,t){this.parseDefaultProperties(e,t.cssStyle={},null,(e=>{switch(e.localName){case"rStyle":t.styleName=f.attr(e,"val");break;case"vertAlign":t.verticalAlign=We.valueOfVertAlign(e,!0);break;default:return!1}return!0}))}parseVmlPicture(e){const t={type:D.VmlPicture,children:[]};for(const r of f.elements(e)){const e=Ne(r,this);e&&t.children.push(e)}return t}checkAlternateContent(e){var t;if("AlternateContent"!=e.localName)return e;let r=f.element(e,"Choice");if(r){let t=f.attr(r,"Requires"),a=e.lookupNamespaceURI(t);if(Le.includes(a))return r.firstElementChild}return null===(t=f.element(e,"Fallback"))||void 0===t?void 0:t.firstElementChild}parseDrawing(e){for(let t of f.elements(e))switch(t.localName){case"inline":case"anchor":return this.parseDrawingWrapper(t)}}parseDrawingWrapper(e){var t,r;let a=f.boolAttr(e,"layoutInCell"),n=f.boolAttr(e,"locked"),s=f.boolAttr(e,"behindDoc"),i=f.boolAttr(e,"allowOverlap"),l=f.boolAttr(e,"simplePos"),o=f.intAttr(e,"relativeHeight",1),c={left:f.lengthAttr(e,"distL",d.Emu),right:f.lengthAttr(e,"distR",d.Emu),top:f.lengthAttr(e,"distT",d.Emu),bottom:f.lengthAttr(e,"distB",d.Emu),distL:f.intAttr(e,"distL",0),distR:f.intAttr(e,"distR",0),distT:f.intAttr(e,"distT",0),distB:f.intAttr(e,"distB",0)},p={type:D.Drawing,children:[],cssStyle:{},props:{localName:e.localName,wrapType:null,layoutInCell:a,locked:n,behindDoc:s,allowOverlap:i,simplePos:l,relativeHeight:o,distance:c,extent:{}}},m={relative:"page",align:"left",offset:"0pt",origin:0},u={relative:"page",align:"top",offset:"0pt",origin:0};for(let a of f.elements(e))switch(a.localName){case"simplePos":l&&(m.offset=f.lengthAttr(a,"x",d.Emu),u.offset=f.lengthAttr(a,"y",d.Emu),m.origin=f.intAttr(a,"x",0),u.origin=f.intAttr(a,"y",0));break;case"positionH":if(!l){let e=f.element(a,"align"),r=f.element(a,"posOffset");m.relative=null!==(t=f.attr(a,"relativeFrom"))&&void 0!==t?t:m.relative,e&&(m.align=e.textContent),r&&(m.offset=ze.sizeValue(r,d.Emu),m.origin=ze.parseTextContent(r)),p.props.posX=m}break;case"positionV":if(!l){let e=f.element(a,"align"),t=f.element(a,"posOffset");u.relative=null!==(r=f.attr(a,"relativeFrom"))&&void 0!==r?r:u.relative,e&&(u.align=e.textContent),t&&(u.offset=ze.sizeValue(t,d.Emu),u.origin=ze.parseTextContent(t)),p.props.posY=u}break;case"extent":p.props.extent={width:f.lengthAttr(a,"cx",d.Emu),height:f.lengthAttr(a,"cy",d.Emu),origin_width:f.intAttr(a,"cx",0),origin_height:f.intAttr(a,"cy",0)};break;case"effectExtent":p.props.effectExtent={top:f.lengthAttr(a,"t",d.Emu),bottom:f.lengthAttr(a,"b",d.Emu),left:f.lengthAttr(a,"l",d.Emu),right:f.lengthAttr(a,"r",d.Emu),origin_top:f.intAttr(a,"t",0),origin_bottom:f.intAttr(a,"b",0),origin_left:f.intAttr(a,"l",0),origin_right:f.intAttr(a,"r",0)};break;case"graphic":let e=this.parseGraphic(a);e&&p.children.push(e);break;case"wrapTopAndBottom":p.props.wrapType=B.TopAndBottom;break;case"wrapNone":p.props.wrapType=B.None;break;case"wrapSquare":p.props.wrapType=B.Square,p.props.wrapText=f.attr(a,"wrapText");break;case"wrapThrough":case"wrapTight":p.props.wrapType=B.Tight,p.props.wrapText=f.attr(a,"wrapText");let n=f.element(a,"wrapPolygon");this.parsePolygon(n,p)}let{extent:g,effectExtent:b}=p.props,y=g.origin_width+b.origin_left+b.origin_right,v=g.origin_height+b.origin_top+b.origin_bottom;if(p.cssStyle.width=h(y,d.Emu),p.cssStyle.height=h(v,d.Emu),"inline"===e.localName&&(p.props.wrapType=B.Inline),"anchor"===e.localName){p.cssStyle.position="relative",p.cssStyle["z-index"]=s?-1:o,this.options.ignoreImageWrap&&(p.props.wrapType=B.TopAndBottom);let{wrapText:e,wrapType:t,extent:r}=p.props;switch(t){case B.TopAndBottom:p.cssStyle.float="left",p.cssStyle.width="100%",p.cssStyle["text-align"]=m.align,p.cssStyle.transform=`translate(${m.offset},0)`,p.cssStyle["margin-top"]=`calc(${u.offset} - ${c.top})`,p.cssStyle["shape-outside"]=`inset(calc(${u.offset} - ${c.top}) 0 0 0)`,p.cssStyle["box-sizing"]="content-box",p.cssStyle["padding-top"]=c.top,p.cssStyle["padding-bottom"]=c.bottom;break;case B.None:switch(p.cssStyle.position="absolute",m.align){case"left":case"right":p.cssStyle[m.align]=m.offset;break;case"center":p.cssStyle.left="50%",p.cssStyle.transform="translateX(-50%)"}p.cssStyle.top=u.offset;break;case B.Square:switch(p.cssStyle.float="left"===e?"right":"left",p.cssStyle["margin-top"]=`calc(${u.offset} - ${c.top})`,p.cssStyle["shape-outside"]=`inset(calc(${u.offset} - ${c.top}) 0 0 0)`,e){case"left":switch(m.align){case"left":p.cssStyle["margin-right"]=`calc(100% - ${r.width} - ${m.offset} - ${c.right})`;break;case"right":p.cssStyle["margin-right"]=`calc(${m.offset} - ${c.right})`;break;case"center":p.cssStyle["margin-right"]=`calc( 50% - (${r.width} - ${m.offset}) / 2 - ${c.right} )`}break;case"right":switch(m.align){case"left":p.cssStyle["margin-left"]=`calc(${m.offset} - ${c.left})`;break;case"right":p.cssStyle["margin-left"]=`calc(100% - ${r.width} - ${m.offset} - ${c.left})`,p.cssStyle["margin-right"]=`calc(${m.offset} - ${c.right})`;break;case"center":p.cssStyle["margin-left"]=`calc( 50% - (${r.width} - ${m.offset} ) / 2 - ${c.left} )`}break;default:console.warn(`text wrap picture on ${e} is not supported！`)}p.cssStyle["box-sizing"]="content-box",p.cssStyle["padding-top"]=c.top,p.cssStyle["padding-bottom"]=c.bottom,p.cssStyle["padding-left"]=c.left,p.cssStyle["padding-right"]=c.right;break;case B.Through:case B.Tight:p.cssStyle.float="left"===e?"right":"left";let{polygonData:t}=p.props;switch(p.cssStyle["shape-outside"]=`polygon(${t})`,p.cssStyle["margin-top"]=u.offset,e){case"left":switch(m.align){case"left":p.cssStyle["margin-right"]=`calc(100% - ${r.width} - ${m.offset})`;break;case"right":p.cssStyle["margin-right"]=m.offset;break;case"center":p.cssStyle["margin-right"]=`calc( 50% - (${r.width} - ${m.offset}) / 2 )`}break;case"right":switch(m.align){case"left":p.cssStyle["margin-left"]=m.offset;break;case"right":p.cssStyle["margin-left"]=`calc(100% - ${r.width} - ${m.offset})`;break;case"center":p.cssStyle["margin-left"]=`calc( 50% - (${r.width} - ${m.offset} ) / 2 )`}break;default:console.warn(`text wrap picture on ${e} is not supported！`)}}}return p}parsePolygon(e,t){let r=[],{wrapText:a,distance:n,extent:s,posX:i,posY:l}=t.props;ze.foreach(e,(e=>{var t,o,c,p,m,u,g,b,y,v,x,k;let w,S,P,C,M,N,T=f.intAttr(e,"x",0),A=f.intAttr(e,"y",0);switch(a){case"left":switch(i.align){case"left":w=T*s.origin_width/21600-n.distL,S=A*s.origin_height/21600+l.origin,M=null!==(t=h(w,d.Emu))&&void 0!==t?t:"0pt",N=null!==(o=h(S,d.Emu))&&void 0!==o?o:"0pt";break;case"right":w=T*s.origin_width/21600+i.origin-n.distL,S=A*s.origin_height/21600+l.origin,M=null!==(c=h(w,d.Emu))&&void 0!==c?c:"0pt",N=null!==(p=h(S,d.Emu))&&void 0!==p?p:"0pt";break;case"center":w=T*s.origin_width/21600+i.origin-n.distL,S=A*s.origin_height/21600+l.origin,M=null!==(m=h(w,d.Emu))&&void 0!==m?m:"0pt",N=null!==(u=h(S,d.Emu))&&void 0!==u?u:"0pt"}break;case"right":switch(i.align){case"left":w=T*s.origin_width/21600+i.origin+n.distR,S=A*s.origin_height/21600+l.origin,M=null!==(g=h(w,d.Emu))&&void 0!==g?g:"0pt",N=null!==(b=h(S,d.Emu))&&void 0!==b?b:"0pt";break;case"right":w=T*s.origin_width/21600+i.origin+n.distR,S=A*s.origin_height/21600+l.origin,P=null!==(y=h(w,d.Emu))&&void 0!==y?y:"0pt",C=null!==(v=h(S,d.Emu))&&void 0!==v?v:"0pt",M=`calc(100% + ${P} - ${s.width})`,N=C;break;case"center":w=T*s.origin_width/21600+i.origin+n.distR,S=A*s.origin_height/21600+l.origin,P=null!==(x=h(w,d.Emu))&&void 0!==x?x:"0pt",C=null!==(k=h(S,d.Emu))&&void 0!==k?k:"0pt",M=`calc(50% + ${P})`,N=C}break;default:console.warn(`text wrap picture on ${a} is not supported！`)}let E=`${M} ${N}`;r.push(E)})),t.props.polygonData=r.join(",")}parseGraphic(e){let t=f.element(e,"graphicData");for(let e of f.elements(t))switch(e.localName){case"wsp":return this.parseShape(e);case"pic":return this.parsePicture(e)}return null}parseShape(e){let t={type:D.Shape,cssStyle:{}};for(let r of f.elements(e))switch(r.localName){case"cNvPr":case"cNvSpPr":case"cNvCnPr":case"spPr":return this.parseShapeProperties(r,t)}return null}parseShapeProperties(e,t){for(let r of f.elements(e))if("xfrm"===r.localName){f.boolAttr(r,"flipH")&&(t.props.is_transform=!0,t.props.transform.scaleX=-1),f.boolAttr(r,"flipV")&&(t.props.is_transform=!0,t.props.transform.scaleY=-1);let e=f.numberAttr(r,"rot",d.degree,0);e&&(t.props.is_transform=!0,t.props.transform.rotate=e),this.parseTransform2D(r,t)}return null}parsePicture(e){let t={type:D.Image,src:"",cssStyle:{},props:{is_clip:!1,clip:{},is_transform:!1,transform:{}}};for(let r of f.elements(e))switch(r.localName){case"nvPicPr":break;case"blipFill":this.parseBlipFill(r,t);break;case"spPr":this.parseShapeProperties(r,t)}return t}parseTransform2D(e,t){for(let r of f.elements(e))switch(r.localName){case"ext":let e,a,{transform:n}=t.props,s=f.intAttr(r,"cx",0),i=f.intAttr(r,"cy",0);if(null==n?void 0:n.rotate){let t=Math.PI*n.rotate/180;e=Math.abs(s*Math.cos(t)+i*Math.sin(t)),a=Math.abs(s*Math.sin(t)+i*Math.cos(t))}else e=s,a=i;t.props.width=h(e,d.Px,!1),t.props.height=h(a,d.Px,!1),t.cssStyle.width=h(e,d.Emu,!0),t.cssStyle.height=h(a,d.Emu,!0);break;case"off":t.cssStyle.left=f.lengthAttr(r,"x",d.Emu),t.cssStyle.top=f.lengthAttr(r,"y",d.Emu)}}parseBlipFill(e,t){for(let r of f.elements(e))switch(r.localName){case"blip":t.src=f.attr(r,"embed"),this.parseBlip(r,t);break;case"srcRect":let e=f.numberAttr(r,"l",d.RelativeRect,0),a=f.numberAttr(r,"r",d.RelativeRect,0),n=f.numberAttr(r,"t",d.RelativeRect,0),s=f.numberAttr(r,"b",d.RelativeRect,0);t.props.is_clip=[e,a,n,s].some((e=>0!==e)),t.props.clip.type="inset",t.props.clip.path={top:n,right:a,bottom:s,left:e}}}parseBlip(e,t){for(let r of f.elements(e))switch(r.localName){case"alphaBiLevel":case"alphaCeiling":case"alphaFloor":case"alphaInv":case"alphaMod":break;case"alphaModFix":let e=f.lengthAttr(r,"amt",d.Opacity);t.cssStyle.opacity=e;break;default:this.options.debug&&console.warn(`DOCX: Unknown document element: ${r.localName}`)}}parseTable(e){let t={type:D.Table,children:[]};return ze.foreach(e,(e=>{switch(e.localName){case"tblPr":this.parseTableProperties(e,t);break;case"tblGrid":t.columns=this.parseTableColumns(e);break;case"tr":t.children.push(this.parseTableRow(e))}})),t}parseTableColumns(e){let t=[];return ze.foreach(e,(e=>{if("gridCol"===e.localName)t.push({width:f.lengthAttr(e,"w")})})),t}parseTableProperties(e,t){switch(t.cssStyle={},t.cellStyle={},this.parseDefaultProperties(e,t.cssStyle,t.cellStyle,(e=>{switch(e.localName){case"tblStyle":t.styleName=f.attr(e,"val");break;case"tblLook":t.className=We.classNameOftblLook(e);break;case"tblpPr":this.parseTablePosition(e,t);break;case"tblStyleColBandSize":t.colBandSize=f.intAttr(e,"val");break;case"tblStyleRowBandSize":t.rowBandSize=f.intAttr(e,"val");break;default:return!1}return!0})),t.cssStyle["text-align"]){case"center":delete t.cssStyle["text-align"],t.cssStyle["margin-left"]="auto",t.cssStyle["margin-right"]="auto";break;case"right":delete t.cssStyle["text-align"],t.cssStyle["margin-left"]="auto"}}parseTablePosition(e,t){if(this.options.ignoreTableWrap)return!1;let r=f.lengthAttr(e,"topFromText"),a=f.lengthAttr(e,"bottomFromText"),n=f.lengthAttr(e,"rightFromText"),s=f.lengthAttr(e,"leftFromText");t.cssStyle.float="left",t.cssStyle["margin-bottom"]=We.addSize(t.cssStyle["margin-bottom"],a),t.cssStyle["margin-left"]=We.addSize(t.cssStyle["margin-left"],s),t.cssStyle["margin-right"]=We.addSize(t.cssStyle["margin-right"],n),t.cssStyle["margin-top"]=We.addSize(t.cssStyle["margin-top"],r)}parseTableRow(e){let t={type:D.Row,children:[]};return ze.foreach(e,(e=>{switch(e.localName){case"tc":t.children.push(this.parseTableCell(e));break;case"trPr":this.parseTableRowProperties(e,t)}})),t}parseTableRowProperties(e,t){t.cssStyle=this.parseDefaultProperties(e,{},null,(e=>{switch(e.localName){case"cnfStyle":t.className=We.classNameOfCnfStyle(e);break;case"tblHeader":t.isHeader=f.boolAttr(e,"val",!0);break;default:return!1}return!0}))}parseTableCell(e){let t={type:D.Cell,children:[]};return ze.foreach(e,(e=>{switch(e.localName){case"tbl":t.children.push(this.parseTable(e));break;case"p":t.children.push(this.parseParagraph(e));break;case"tcPr":this.parseTableCellProperties(e,t)}})),t}parseTableCellProperties(e,t){t.cssStyle=this.parseDefaultProperties(e,{},null,(e=>{var r;switch(e.localName){case"gridSpan":t.span=f.intAttr(e,"val",null);break;case"vMerge":t.verticalMerge=null!==(r=f.attr(e,"val"))&&void 0!==r?r:"continue";break;case"cnfStyle":t.className=We.classNameOfCnfStyle(e);break;default:return!1}return!0}))}parseDefaultProperties(e,t=null,r=null,a=null){return t=t||{},ze.foreach(e,(n=>{if(!(null==a?void 0:a(n)))switch(n.localName){case"b":t["font-weight"]=f.boolAttr(n,"val",!0)?"bold":"normal";break;case"bCs":case"bdr":t.border=We.valueOfBorder(n);break;case"caps":t["text-transform"]=f.boolAttr(n,"val",!0)?"uppercase":"none";break;case"color":t.color=ze.colorAttr(n,"val",null,De);break;case"cs":case"dstrike":case"eastAsianLayout":case"effect":case"em":case"emboss":case"fitText":case"highlight":t["background-color"]=ze.colorAttr(n,"val",null,Ie);break;case"i":t["font-style"]=f.boolAttr(n,"val",!0)?"italic":"normal";break;case"iCs":case"imprint":case"kern":case"vertAlign":case"noWrap":break;case"lang":t.$lang=f.attr(n,"val");break;case"noProof":case"outline":case"position":t.verticalAlign=f.lengthAttr(n,"val",d.FontSize);break;case"rFonts":this.parseFont(n,t);break;case"rPrChange":case"rtl":case"shadow":case"shd":t["background-color"]=ze.colorAttr(n,"fill",null,Fe);break;case"smallCaps":t["font-variant"]=f.boolAttr(n,"val",!0)?"small-caps":"none";break;case"snapToGrid":case"spacing":"pPr"==e.localName&&this.parseSpacing(n,t);break;case"specVanish":case"strike":t["text-decoration"]=f.boolAttr(n,"val",!0)?"line-through":"none";break;case"sz":t["font-size"]=t["min-height"]=f.lengthAttr(n,"val",d.FontSize);break;case"szCs":case"u":this.parseUnderline(n,t);break;case"vanish":f.boolAttr(n,"val",!0)&&(t.display="none");break;case"w":case"webHidden":case"jc":t["text-align"]=We.valueOfJc(n);break;case"textAlignment":case"vAlign":t["vertical-align"]=We.valueOfTextAlignment(n);break;case"tcW":this.options.ignoreWidth;break;case"tblW":t.width=We.valueOfSize(n,"w");break;case"trHeight":this.parseTrHeight(n,t);break;case"ind":case"tblInd":this.parseIndentation(n,t);break;case"tblBorders":this.parseBorderProperties(n,r||t);break;case"tblCellSpacing":t["border-spacing"]=We.valueOfMargin(n),t["border-collapse"]="separate";break;case"pBdr":case"tcBorders":this.parseBorderProperties(n,t);break;case"tblCellMar":case"tcMar":this.parseMarginProperties(n,r||t);break;case"tblLayout":t["table-layout"]=We.valueOfTblLayout(n);break;case"wordWrap":f.boolAttr(n,"val")&&(t["overflow-wrap"]="break-word");break;case"suppressAutoHyphens":t.hyphens=f.boolAttr(n,"val",!0)?"none":"auto";break;default:this.options.debug&&console.warn(`DOCX: Unknown document element: ${e.localName}.${n.localName}`)}})),t}parseUnderline(e,t){let r=f.attr(e,"val");if(null==r)return;switch(r){case"dash":case"dashDotDotHeavy":case"dashDotHeavy":case"dashedHeavy":case"dashLong":case"dashLongHeavy":case"dotDash":case"dotDotDash":t["text-decoration"]="underline dashed";break;case"dotted":case"dottedHeavy":t["text-decoration"]="underline dotted";break;case"double":t["text-decoration"]="underline double";break;case"single":case"thick":case"words":t["text-decoration"]="underline";break;case"wave":case"wavyDouble":case"wavyHeavy":t["text-decoration"]="underline wavy";break;case"none":t["text-decoration"]="none"}let a=ze.colorAttr(e,"color");a&&(t["text-decoration-color"]=a)}parseFont(e,t){let r=[],a=f.attr(e,"ascii"),n=We.themeValue(e,"asciiTheme");r.push(a,n);let s=f.attr(e,"eastAsia"),i=We.themeValue(e,"eastAsiaTheme");r.push(s,i);let l=f.attr(e,"cs"),o=We.themeValue(e,"cstheme");r.push(l,o);let c=f.attr(e,"hAnsi"),p=We.themeValue(e,"hAnsiTheme");r.push(c,p);let d=[...new Set(r)].filter((e=>e)).join(", ");r.length>0&&(t["font-family"]=d),t._hint=f.attr(e,"hint")}parseIndentation(e,t){let r=f.lengthAttr(e,"firstLine"),a=f.lengthAttr(e,"hanging"),n=f.lengthAttr(e,"left"),s=f.lengthAttr(e,"start"),i=f.lengthAttr(e,"right"),l=f.lengthAttr(e,"end");r&&(t["text-indent"]=r),a&&(t["text-indent"]=`-${a}`),(n||s)&&(t["padding-left"]=n||s),(i||l)&&(t["padding-right"]=i||l)}parseSpacing(e,t){let r=f.lengthAttr(e,"before"),a=f.lengthAttr(e,"after"),n=f.intAttr(e,"line",null),s=f.attr(e,"lineRule");if(r&&(t["margin-top"]=r),a&&(t["margin-bottom"]=a),null!==n)switch(s){case"auto":t["line-height"]=`${(n/240).toFixed(2)}`;break;case"atLeast":t["line-height"]=`calc(100% + ${n/20}pt)`;break;case"Exact":t["line-height"]=n/20+"pt";break;default:t["line-height"]=t["min-height"]=n/20+"pt"}}parseMarginProperties(e,t){ze.foreach(e,(e=>{switch(e.localName){case"left":t["padding-left"]=We.valueOfMargin(e);break;case"right":t["padding-right"]=We.valueOfMargin(e);break;case"top":t["padding-top"]=We.valueOfMargin(e);break;case"bottom":t["padding-bottom"]=We.valueOfMargin(e)}}))}parseTrHeight(e,t){f.attr(e,"hRule"),t.height=f.lengthAttr(e,"val")}parseBorderProperties(e,t){ze.foreach(e,(e=>{switch(e.localName){case"start":case"left":t["border-left"]=We.valueOfBorder(e);break;case"end":case"right":t["border-right"]=We.valueOfBorder(e);break;case"top":t["border-top"]=We.valueOfBorder(e);break;case"bottom":t["border-bottom"]=We.valueOfBorder(e)}}))}}const Ve=["black","blue","cyan","darkBlue","darkCyan","darkGray","darkGreen","darkMagenta","darkRed","darkYellow","green","lightGray","magenta","none","red","white","yellow"];class ze{static foreach(e,t){for(let r=0;r<e.childNodes.length;r++){let a=e.childNodes[r];a.nodeType==Node.ELEMENT_NODE&&t(a)}}static colorAttr(e,t,r=null,a="black"){let n=f.attr(e,t);if(n)return"auto"==n?a:Ve.includes(n)?n:`#${n}`;let s=f.attr(e,"themeColor");return s?`var(--docx-${s}-color)`:r}static sizeValue(e,t=d.Dxa){return h(e.textContent,t)}static parseTextContent(e,t=0){let r=e.textContent;return r?parseInt(r):t}}class We{static themeValue(e,t){let r=f.attr(e,t);return r?`var(--docx-${r}-font)`:null}static valueOfSize(e,t){let r=d.Dxa;switch(f.attr(e,"type")){case"dxa":break;case"pct":r=d.TablePercent;break;case"auto":return"auto"}return f.lengthAttr(e,t,r)}static valueOfMargin(e){return f.lengthAttr(e,"w")}static valueOfBorder(e){if("nil"==f.attr(e,"val"))return"none";let t=ze.colorAttr(e,"color");return`${f.lengthAttr(e,"sz",d.Border)} solid ${"auto"==t?Be:t}`}static valueOfTblLayout(e){return"fixed"==f.attr(e,"type")?"fixed":"auto"}static classNameOfCnfStyle(e){const t=f.attr(e,"val");return["first-row","last-row","first-col","last-col","odd-col","even-col","odd-row","even-row","ne-cell","nw-cell","se-cell","sw-cell"].filter(((e,r)=>"1"==t[r])).join(" ")}static valueOfJc(e){let t=f.attr(e,"val");switch(t){case"start":case"left":return"left";case"center":return"center";case"end":case"right":return"right";case"both":return"justify"}return t}static valueOfVertAlign(e,t=!1){let r=f.attr(e,"val");switch(r){case"subscript":return"sub";case"superscript":return t?"sup":"super"}return t?null:r}static valueOfTextAlignment(e){let t=f.attr(e,"val");switch(t){case"auto":case"baseline":return"baseline";case"top":return"top";case"center":return"middle";case"bottom":return"bottom"}return t}static addSize(e,t){return null==e?t:null==t?e:`calc(${e} + ${t})`}static classNameOftblLook(e){const t=f.hexAttr(e,"val",0);let r="";return(f.boolAttr(e,"firstRow")||32&t)&&(r+=" first-row"),(f.boolAttr(e,"lastRow")||64&t)&&(r+=" last-row"),(f.boolAttr(e,"firstColumn")||128&t)&&(r+=" first-col"),(f.boolAttr(e,"lastColumn")||256&t)&&(r+=" last-col"),(f.boolAttr(e,"noHBand")||512&t)&&(r+=" no-hband"),(f.boolAttr(e,"noVBand")||1024&t)&&(r+=" no-vband"),r.trim()}}const Ue={pos:0,leader:"none",style:"left"};function qe(e=document.body){const t=document.createElement("div");t.style.width="100pt",e.appendChild(t);const r=100/t.offsetWidth;return e.removeChild(t),r}function Xe(e,t,r,a=.75){const n=e.closest("p"),s=e.getBoundingClientRect(),i=n.getBoundingClientRect(),l=getComputedStyle(n),o=(null==t?void 0:t.length)>0?t.map((e=>({pos:Ge(e.position),leader:e.leader,style:e.style}))).sort(((e,t)=>e.pos-t.pos)):[Ue],c=o[o.length-1],p=i.width*a,d=Ge(r);let h=c.pos+d;if(h<p)for(;h<p&&o.length<50;h+=d)o.push(Object.assign(Object.assign({},Ue),{pos:h}));const m=parseFloat(l.marginLeft),u=i.left+m,f=(s.left-u)*a,g=o.find((e=>"clear"!=e.style&&e.pos>f));if(null==g)return;let b=1;if("right"==g.style||"center"==g.style){const t=Array.from(n.querySelectorAll(`.${e.className}`)),r=t.indexOf(e)+1,s=document.createRange();s.setStart(e,1),r<t.length?s.setEndBefore(t[r]):s.setEndAfter(n);const l="center"==g.style?.5:1,o=s.getBoundingClientRect(),c=o.left+l*o.width-(i.left-m);b=g.pos-c*a}else b=g.pos-f;switch(e.innerHTML="&nbsp;",e.style.textDecoration="inherit",e.style.wordSpacing=`${b.toFixed(0)}pt`,g.leader){case"dot":case"middleDot":e.style.textDecoration="underline",e.style.textDecorationStyle="dotted";break;case"hyphen":case"heavy":case"underscore":e.style.textDecoration="underline"}}function Ge(e){return parseFloat(e)}class Je{constructor({sectProps:e,elements:t=[],isSplit:r=!1,isFirstPage:a=!1,isLastPage:n=!1,breakIndex:s=0,contentElement:i,checkingOverflow:l=!1}){this.pageId=A(),this.sectProps=e,this.elements=t,this.isSplit=r,this.isFirstPage=a,this.isLastPage=n,this.breakIndex=s,this.contentElement=i,this.checkingOverflow=l}}const Ke="http://www.w3.org/2000/svg",Ye="http://www.w3.org/1998/Math/MathML";var Ze;!function(e){e.TRUE="true",e.FALSE="false",e.UNKNOWN="undetected"}(Ze||(Ze={}));class Qe{constructor(){this.className="docx",this.styleMap={},this.currentPart=null,this.tableVerticalMerges=[],this.currentVerticalMerge=null,this.tableCellPositions=[],this.currentCellPosition=null,this.footnoteMap={},this.endnoteMap={},this.currentEndnoteIds=[],this.usedHederFooterParts=[],this.currentTabs=[],this.tabsTimeout=0}render(e,t,r=null,a){var n;this.document=e,this.options=a,this.className=a.className,this.rootSelector=a.inWrapper?`.${this.className}-wrapper`:":root",this.styleMap=null,this.wrapper=t,at(r=r||t),at(t),it(r,"docxjs library predefined styles"),r.appendChild(this.renderDefaultStyle()),e.themePart&&(it(r,"docxjs document theme values"),this.renderTheme(e.themePart,r)),null!=e.stylesPart&&(this.styleMap=this.processStyles(e.stylesPart.styles),it(r,"docxjs document styles"),r.appendChild(this.renderStyles(e.stylesPart.styles))),e.numberingPart&&(this.processNumberings(e.numberingPart.domNumberings),it(r,"docxjs document numbering styles"),r.appendChild(this.renderNumbering(e.numberingPart.domNumberings,r))),!a.ignoreFonts&&e.fontTablePart&&this.renderFontTable(e.fontTablePart,r),e.footnotesPart&&(this.footnoteMap=P(e.footnotesPart.notes,(e=>e.id))),e.endnotesPart&&(this.endnoteMap=P(e.endnotesPart.notes,(e=>e.id))),e.settingsPart&&(this.defaultTabSize=null===(n=e.settingsPart.settings)||void 0===n?void 0:n.defaultTabStop);let s=this.renderPages(e.documentPart.body);this.options.inWrapper?t.appendChild(this.renderWrapper(s)):nt(t,s),this.refreshTabStops()}renderDefaultStyle(){let e=this.className;return st(`\n\t\t\t.${e}-wrapper { background: gray; padding: 30px; padding-bottom: 0px; display: flex; flex-flow: column; align-items: center; } \n\t\t\t.${e}-wrapper>section.${e} { background: white; box-shadow: 0 0 10px rgba(0, 0, 0, 0.5); margin-bottom: 30px; }\n\t\t\t.${e} { color: black; hyphens: auto; text-underline-position: from-font; }\n\t\t\tsection.${e} { box-sizing: border-box; display: flex; flex-flow: column nowrap; position: relative; overflow: hidden; }\n            section.${e}>header { position: absolute; top: 0; z-index: 1; display: flex; align-items: flex-end; }\n\t\t\tsection.${e}>article { z-index: 1; }\n\t\t\tsection.${e}>footer { position: absolute; bottom: 0; z-index: 1; }\n\t\t\t.${e} table { border-collapse: collapse; }\n\t\t\t.${e} table td, .${e} table th { vertical-align: top; }\n\t\t\t.${e} p { margin: 0pt; min-height: 1em; }\n\t\t\t.${e} span { white-space: pre-wrap; overflow-wrap: break-word; }\n\t\t\t.${e} a { color: inherit; text-decoration: inherit; }\n\t\t\t.${e} img, ${e} svg { vertical-align: baseline; }\n\t\t\t.${e} .clearfix::after { content: ""; display: block; line-height: 0; clear: both; }\n\t\t`)}renderTheme(e,t){var r,a;const n={},s=null===(r=e.theme)||void 0===r?void 0:r.fontScheme;s&&(s.majorFont&&(n["--docx-majorHAnsi-font"]=s.majorFont.latinTypeface),s.minorFont&&(n["--docx-minorHAnsi-font"]=s.minorFont.latinTypeface));const i=null===(a=e.theme)||void 0===a?void 0:a.colorScheme;if(i)for(let[e,t]of Object.entries(i.colors))n[`--docx-${e}-color`]=`#${t}`;const l=this.styleToString(`.${this.className}`,n);t.appendChild(st(l))}processStyleName(e){return e?`${this.className}_${k(e)}`:this.className}processStyles(e){const t=P(e.filter((e=>null!=e.id)),(e=>e.id));for(const r of e.filter((e=>e.basedOn))){let e=t[r.basedOn];if(e){r.paragraphProps=N(r.paragraphProps,e.paragraphProps),r.runProps=N(r.runProps,e.runProps);for(const t of e.styles){const e=r.styles.find((e=>e.target==t.target));e?this.copyStyleProperties(t.values,e.values):r.styles.push(Object.assign(Object.assign({},t),{values:Object.assign({},t.values)}))}}else this.options.debug&&console.warn(`Can't find base style ${r.basedOn}`)}for(let t of e)t.cssName=this.processStyleName(t.id);return t}renderStyles(e){var t;let r="";const a=this.styleMap,n=P(e.filter((e=>e.isDefault)),(e=>e.target));for(const s of e){let e=s.styles;if(s.linked){let t=s.linked&&a[s.linked];t?e=e.concat(t.styles):this.options.debug&&console.warn(`Can't find linked style ${s.linked}`)}for(const a of e){let e=`${null!==(t=s.target)&&void 0!==t?t:""}.${s.cssName}`;s.target!=a.target&&(e+=` ${a.target}`),n[s.target]==s&&(e=`.${this.className} ${s.target}, `+e),r+=this.styleToString(e,a.values)}}return st(r)}processNumberings(e){var t;for(let r of e.filter((e=>e.pStyleName))){const e=this.findStyle(r.pStyleName);(null===(t=null==e?void 0:e.paragraphProps)||void 0===t?void 0:t.numbering)&&(e.paragraphProps.numbering.level=r.level)}}renderNumbering(e,t){let r="",a=[];for(let n of e){let e=`p.${this.numberingClass(n.id,n.level)}`,s="none";if(n.bullet){let a=`--${this.className}-${n.bullet.src}`.toLowerCase();r+=this.styleToString(`${e}:before`,{content:"' '",display:"inline-block",background:`var(${a})`},n.bullet.style),this.document.loadNumberingImage(n.bullet.src).then((e=>{let r=`${this.rootSelector} { ${a}: url(${e}) }`;t.appendChild(st(r))}))}else if(n.levelText){let t=this.numberingCounter(n.id,n.level);const s=t+" "+(n.start-1);n.level>0&&(r+=this.styleToString(`p.${this.numberingClass(n.id,n.level-1)}`,{"counter-reset":s})),a.push(s),r+=this.styleToString(`${e}:before`,Object.assign({content:this.levelTextToContent(n.levelText,n.suff,n.id,this.numFormatToCssValue(n.format)),"counter-increment":t},n.rStyle))}else s=this.numFormatToCssValue(n.format);r+=this.styleToString(e,Object.assign({display:"list-item","list-style-position":"inside","list-style-type":s},n.pStyle))}return a.length>0&&(r+=this.styleToString(this.rootSelector,{"counter-reset":a.join(" ")})),st(r)}numberingClass(e,t){return`${this.className}-num-${e}-${t}`}styleToString(e,t,r=null){let a=`${e} {\r\n`;for(const e in t)e.startsWith("$")||(a+=`  ${e}: ${t[e]};\r\n`);return r&&(a+=r),a+"}\r\n"}numberingCounter(e,t){return`${this.className}-num-${e}-${t}`}levelTextToContent(e,t,r,a){var n;return`"${e.replace(/%\d*/g,(e=>{let t=parseInt(e.substring(1),10)-1;return`"counter(${this.numberingCounter(r,t)}, ${a})"`}))}${null!==(n={tab:"\\9",space:"\\a0"}[t])&&void 0!==n?n:""}"`}numFormatToCssValue(e){var t;return null!==(t={none:"none",bullet:"disc",decimal:"decimal",lowerLetter:"lower-alpha",upperLetter:"upper-alpha",lowerRoman:"lower-roman",upperRoman:"upper-roman",decimalZero:"decimal-leading-zero",aiueo:"katakana",aiueoFullWidth:"katakana",chineseCounting:"simp-chinese-informal",chineseCountingThousand:"simp-chinese-informal",chineseLegalSimplified:"simp-chinese-formal",chosung:"hangul-consonant",ideographDigital:"cjk-ideographic",ideographTraditional:"cjk-heavenly-stem",ideographLegalTraditional:"trad-chinese-formal",ideographZodiac:"cjk-earthly-branch",iroha:"katakana-iroha",irohaFullWidth:"katakana-iroha",japaneseCounting:"japanese-informal",japaneseDigitalTenThousand:"cjk-decimal",japaneseLegal:"japanese-formal",thaiNumbers:"thai",koreanCounting:"korean-hangul-formal",koreanDigital:"korean-hangul-formal",koreanDigital2:"korean-hanja-informal",hebrew1:"hebrew",hebrew2:"hebrew",hindiNumbers:"devanagari",ganada:"hangul",taiwaneseCounting:"cjk-ideographic",taiwaneseCountingThousand:"cjk-ideographic",taiwaneseDigital:"cjk-decimal"}[e])&&void 0!==t?t:e}renderFontTable(e,t){for(let r of e.fonts)for(let e of r.embedFontRefs)this.document.loadFont(e.id,e.key).then((a=>{const n={"font-family":r.name,src:`url(${a})`};"bold"!=e.type&&"boldItalic"!=e.type||(n["font-weight"]="bold"),"italic"!=e.type&&"boldItalic"!=e.type||(n["font-style"]="italic"),it(t,`docxjs ${r.name} font`);const s=this.styleToString("@font-face",n);t.appendChild(st(s)),this.refreshTabStops()}))}renderWrapper(e){return et("div",{className:`${this.className}-wrapper`},e)}copyStyleProperties(e,t,r=null){if(!e)return t;null==t&&(t={}),null==r&&(r=Object.getOwnPropertyNames(e));for(let a of r)e.hasOwnProperty(a)&&!t.hasOwnProperty(a)&&(t[a]=e[a]);return t}processElement(e){if(e.children)for(let t of e.children)t.parent=e,t.type==D.Table?this.processTable(t):this.processElement(t)}processTable(e){for(let t of e.children)for(let r of t.children)r.cssStyle=this.copyStyleProperties(e.cellStyle,r.cssStyle,["border-left","border-right","border-top","border-bottom","padding-left","padding-right","padding-top","padding-bottom"]),this.processElement(r)}splitPage(e){var t;let r=new Je({});const a=[r];for(const n of e){if(n.level=1,r.elements.push(n),n.type==D.Paragraph){const e=n,s=e.sectionProps;s&&(s.sectionId=A());const i=this.findStyle(e.styleName);(null===(t=null==i?void 0:i.paragraphProps)||void 0===t?void 0:t.pageBreakBefore)&&(r.isSplit=!0,r.sectProps=s,r=new Je({}),a.push(r));let l=-1,o=-1;if(e.children&&(l=e.children.findIndex((e=>{var t;return o=null===(t=e.children)||void 0===t?void 0:t.findIndex((e=>e.type==D.Break&&("lastRenderedPageBreak"==e.break?r.elements.length>2||!this.options.ignoreLastRenderedPageBreak:"page"===e.break||void 0))),o=null!=o?o:-1,-1!=o}))),-1!=l){r.isSplit=!0;const e=r.elements.some((e=>e.type===D.Table));e&&(r.isSplit=!1);let t=r.elements.some((e=>e.children.some((e=>{var t;return e.type===D.Hyperlink&&(null===(t=null==e?void 0:e.href)||void 0===t?void 0:t.includes("Toc"))}))));t&&(r.isSplit=!1)}if((-1!=l||s&&s.type!=F.Continuous&&s.type!=F.NextColumn)&&(r.sectProps=s,r=new Je({}),a.push(r)),-1!=l){let t=e.children[l],a=o<t.children.length-1;if(l<e.children.length-1||a){let n=e.children;const s=Object.assign(Object.assign({},e),{children:n.slice(l)});if(e.children=n.slice(0,l),r.elements.push(s),a){const r=t.children,a=Object.assign(Object.assign({},t),{children:r.slice(0,o)});e.children.push(a),t.children=r.slice(o)}}}}n.type===D.Table&&(r.isSplit=!1)}let n=null;for(let e=a.length-1;e>=0;e--)null==a[e].sectProps?a[e].sectProps=n:n=a[e].sectProps;return a}renderPages(e){const t=[];let r;this.processElement(e),r=this.options.breakPages?this.splitPage(e.children):[new Je({sectProps:e.props,elements:e.children})],e.pages=r;let a=null;for(let n=0,s=r.length;n<s;n++){this.currentFootnoteIds=[];const i=r[n],{sectProps:l}=i;let o=null!=l?l:e.props,c=t.length,p=a!=o,d=n===s-1,h=this.renderPage(i,o,e.cssStyle,c,p,d);t.push(...h),a=l}return t}renderPage(e,t,r,a,n,s){const i=this.createPage(this.className,t);this.renderStyleValues(r,i),this.options.renderHeaders&&this.renderHeaderFooterRef(t.headerRefs,t,a,n,i);let l=et("article");return this.options.breakPages&&(l.style.minHeight=t.contentSize.height),this.renderElements(e.elements,l),i.appendChild(l),this.options.renderFootnotes&&this.renderNotes(this.currentFootnoteIds,this.footnoteMap,i),this.options.renderEndnotes&&s&&this.renderNotes(this.currentEndnoteIds,this.endnoteMap,i),this.options.renderFooters&&this.renderHeaderFooterRef(t.footerRefs,t,a,n,i),[i]}createPage(e,t){let r=et("section",{className:e});return t&&(t.pageMargins&&(r.style.paddingLeft=t.pageMargins.left,r.style.paddingRight=t.pageMargins.right,r.style.paddingTop=t.pageMargins.top,r.style.paddingBottom=t.pageMargins.bottom),t.pageSize&&(this.options.ignoreWidth||(r.style.width=t.pageSize.width),this.options.ignoreHeight||(r.style.minHeight=t.pageSize.height)),t.columns&&t.columns.count&&(r.style.columnCount=`${t.columns.count}`,r.style.columnGap=t.columns.space,t.columns.separator&&(r.style.columnRule="1px solid black"))),r}renderHeaderFooterRef(e,t,r,a,n){var s,i,l,o,c,p,d,h;if(!e)return;let m=null!==(i=null!==(s=t.titlePage&&a?e.find((e=>"first"==e.type)):null)&&void 0!==s?s:r%2==1?e.find((e=>"even"==e.type)):null)&&void 0!==i?i:e.find((e=>"default"==e.type)),u=m&&this.document.findPartByRelId(m.id,this.document.documentPart);if(u){switch(this.currentPart=u,this.usedHederFooterParts.includes(u.path)||(this.processElement(u.rootElement),this.usedHederFooterParts.push(u.path)),u.rootElement.type){case D.Header:u.rootElement.cssStyle={left:null===(l=t.pageMargins)||void 0===l?void 0:l.left,width:null===(o=t.contentSize)||void 0===o?void 0:o.width,height:null===(c=t.pageMargins)||void 0===c?void 0:c.top};break;case D.Footer:u.rootElement.cssStyle={left:null===(p=t.pageMargins)||void 0===p?void 0:p.left,width:null===(d=t.contentSize)||void 0===d?void 0:d.width,height:null===(h=t.pageMargins)||void 0===h?void 0:h.bottom};break;default:console.warn("set header/footer style error",u.rootElement.type)}this.renderElements([u.rootElement],n),this.currentPart=null}}renderNotes(e,t,r){let a=e.map((e=>t[e])).filter((e=>e));if(a.length>0){let e=et("ol",null,this.renderElements(a));r.appendChild(e)}}renderElements(e,t){if(null==e)return null;let r=[];for(let t=0;t<e.length;t++){let a=this.renderElement(e[t]);Array.isArray(a)?r.push(...a):a&&r.push(a)}return t&&nt(t,r),r}renderElement(e){switch(e.type){case D.Paragraph:return this.renderParagraph(e);case D.BookmarkStart:return this.renderBookmarkStart(e);case D.BookmarkEnd:return null;case D.Run:return this.renderRun(e);case D.Table:return this.renderTable(e);case D.Row:return this.renderTableRow(e);case D.Cell:return this.renderTableCell(e);case D.Hyperlink:return this.renderHyperlink(e);case D.Drawing:return this.renderDrawing(e);case D.Image:return this.renderImage(e);case D.Text:return this.renderText(e);case D.DeletedText:return this.renderDeletedText(e);case D.Tab:return this.renderTab(e);case D.Symbol:return this.renderSymbol(e);case D.Break:return this.renderBreak(e);case D.Footer:return this.renderHeaderFooter(e,"footer");case D.Header:return this.renderHeaderFooter(e,"header");case D.Footnote:case D.Endnote:return this.renderContainer(e,"li");case D.FootnoteReference:return this.renderFootnoteReference(e);case D.EndnoteReference:return this.renderEndnoteReference(e);case D.NoBreakHyphen:return et("wbr");case D.VmlPicture:return this.renderVmlPicture(e);case D.VmlElement:return this.renderVmlElement(e);case D.MmlMath:return this.renderContainerNS(e,Ye,"math",{xmlns:Ye});case D.MmlMathParagraph:return this.renderContainer(e,"span");case D.MmlFraction:return this.renderContainerNS(e,Ye,"mfrac");case D.MmlBase:return this.renderContainerNS(e,Ye,e.parent.type==D.MmlMatrixRow?"mtd":"mrow");case D.MmlNumerator:case D.MmlDenominator:case D.MmlFunction:case D.MmlLimit:case D.MmlBox:return this.renderContainerNS(e,Ye,"mrow");case D.MmlGroupChar:return this.renderMmlGroupChar(e);case D.MmlLimitLower:return this.renderContainerNS(e,Ye,"munder");case D.MmlMatrix:return this.renderContainerNS(e,Ye,"mtable");case D.MmlMatrixRow:return this.renderContainerNS(e,Ye,"mtr");case D.MmlRadical:return this.renderMmlRadical(e);case D.MmlSuperscript:return this.renderContainerNS(e,Ye,"msup");case D.MmlSubscript:return this.renderContainerNS(e,Ye,"msub");case D.MmlDegree:case D.MmlSuperArgument:case D.MmlSubArgument:return this.renderContainerNS(e,Ye,"mn");case D.MmlFunctionName:return this.renderContainerNS(e,Ye,"ms");case D.MmlDelimiter:return this.renderMmlDelimiter(e);case D.MmlRun:return this.renderMmlRun(e);case D.MmlNary:return this.renderMmlNary(e);case D.MmlPreSubSuper:return this.renderMmlPreSubSuper(e);case D.MmlBar:return this.renderMmlBar(e);case D.MmlEquationArray:return this.renderMllList(e);case D.Inserted:return this.renderInserted(e);case D.Deleted:return this.renderDeleted(e)}return null}isPageBreakElement(e){return e.type==D.Break&&("lastRenderedPageBreak"==e.break?!this.options.ignoreLastRenderedPageBreak:"page"===e.break||void 0)}renderChildren(e,t){return this.renderElements(e.children,t)}renderContainer(e,t,r){return et(t,r,this.renderChildren(e))}renderContainerNS(e,t,r,a){return rt(t,r,a,this.renderChildren(e))}renderParagraph(e){var t,r,a,n;let s=et("p");const i=this.findStyle(e.styleName);null!==(t=e.tabs)&&void 0!==t||(e.tabs=null===(r=null==i?void 0:i.paragraphProps)||void 0===r?void 0:r.tabs),this.renderClass(e,s),this.renderChildren(e,s),this.renderStyleValues(e.cssStyle,s),this.renderCommonProperties(s.style,e);const l=null!==(a=e.numbering)&&void 0!==a?a:null===(n=null==i?void 0:i.paragraphProps)||void 0===n?void 0:n.numbering;return l&&s.classList.add(this.numberingClass(l.id,l.level)),s}renderRun(e){if(e.fieldRun)return null;const t=et("span");if(e.id&&(t.id=e.id),this.renderClass(e,t),this.renderStyleValues(e.cssStyle,t),e.verticalAlign){const r=et(e.verticalAlign);this.renderChildren(e,r),t.appendChild(r)}else this.renderChildren(e,t);return t}renderText(e){return document.createTextNode(e.text)}renderHyperlink(e){let t=et("a");if(this.renderChildren(e,t),this.renderStyleValues(e.cssStyle,t),e.href)t.href=e.href;else if(e.id){const r=this.document.documentPart.rels.find((t=>t.id==e.id&&"External"===t.targetMode));t.href=null==r?void 0:r.target}return t}renderDrawing(e){let t=et("div");return t.style.display="inline-block",t.style.position="relative",t.style.textIndent="0px",this.renderChildren(e,t),this.renderStyleValues(e.cssStyle,t),t}renderImage(e){let t=et("img");return this.renderStyleValues(e.cssStyle,t),this.document&&this.document.loadDocumentImage(e.src,this.currentPart).then((e=>{t.src=e})),t}renderDeletedText(e){return this.options.renderEndnotes?document.createTextNode(e.text):null}renderBreak(e){return"textWrapping"==e.break?et("br"):null}renderInserted(e){return this.options.renderChanges?this.renderContainer(e,"ins"):this.renderChildren(e)}renderDeleted(e){return this.options.renderChanges?this.renderContainer(e,"del"):null}renderSymbol(e){let t=et("span");return t.style.fontFamily=e.font,t.innerHTML=`&#x${e.char};`,t}renderHeaderFooter(e,t){let r=et(t);return this.renderChildren(e,r),this.renderStyleValues(e.cssStyle,r),r}renderFootnoteReference(e){let t=et("sup");return this.currentFootnoteIds.push(e.id),t.textContent=`${this.currentFootnoteIds.length}`,t}renderEndnoteReference(e){let t=et("sup");return this.currentEndnoteIds.push(e.id),t.textContent=`${this.currentEndnoteIds.length}`,t}renderTab(e){var t;let r=et("span");if(r.innerHTML="&emsp;",this.options.experimental){r.className=this.tabStopClass();let a=null===(t=function(e,t){let r=e.parent;for(;null!=r&&r.type!=t;)r=r.parent;return r}(e,D.Paragraph))||void 0===t?void 0:t.tabs;this.currentTabs.push({stops:a,span:r})}return r}renderBookmarkStart(e){let t=et("span");return t.id=e.name,t}renderTable(e){let t=et("table");return this.tableCellPositions.push(this.currentCellPosition),this.tableVerticalMerges.push(this.currentVerticalMerge),this.currentVerticalMerge={},this.currentCellPosition={col:0,row:0},e.columns&&t.appendChild(this.renderTableColumns(e.columns)),this.renderClass(e,t),this.renderChildren(e,t),this.renderStyleValues(e.cssStyle,t),this.currentVerticalMerge=this.tableVerticalMerges.pop(),this.currentCellPosition=this.tableCellPositions.pop(),t}renderTableColumns(e){let t=et("colgroup");for(let r of e){let e=et("col");r.width&&(e.style.width=r.width),t.appendChild(e)}return t}renderTableRow(e){let t=et("tr");return this.currentCellPosition.col=0,this.renderClass(e,t),this.renderChildren(e,t),this.renderStyleValues(e.cssStyle,t),this.currentCellPosition.row++,t}renderTableCell(e){let t=et("td");const r=this.currentCellPosition.col;return e.verticalMerge?"restart"==e.verticalMerge?(this.currentVerticalMerge[r]=t,t.rowSpan=1):this.currentVerticalMerge[r]&&(this.currentVerticalMerge[r].rowSpan+=1,t.style.display="none"):this.currentVerticalMerge[r]=null,this.renderClass(e,t),this.renderChildren(e,t),this.renderStyleValues(e.cssStyle,t),e.span&&(t.colSpan=e.span),this.currentCellPosition.col+=t.colSpan,t}renderVmlPicture(e){let t=et("div");return this.renderChildren(e,t),t}renderVmlElement(e){var t,r;let a=tt("svg");a.setAttribute("style",e.cssStyleText);const n=this.renderVmlChildElement(e);return(null===(t=e.imageHref)||void 0===t?void 0:t.id)&&(null===(r=this.document)||void 0===r||r.loadDocumentImage(e.imageHref.id,this.currentPart).then((e=>n.setAttribute("href",e)))),a.appendChild(n),requestAnimationFrame((()=>{const e=a.firstElementChild.getBBox();a.setAttribute("width",`${Math.ceil(e.x+e.width)}`),a.setAttribute("height",`${Math.ceil(e.y+e.height)}`)})),a}renderVmlChildElement(e){const t=tt(e.tagName);Object.entries(e.attrs).forEach((([e,r])=>t.setAttribute(e,r)));for(let r of e.children)r.type==D.VmlElement?t.appendChild(this.renderVmlChildElement(r)):t.append(...T(this.renderElement(r)));return t}renderMmlRadical(e){var t;const r=e.children.find((e=>e.type==D.MmlBase));if(null===(t=e.props)||void 0===t?void 0:t.hideDegree)return rt(Ye,"msqrt",null,this.renderElements([r]));const a=e.children.find((e=>e.type==D.MmlDegree));return rt(Ye,"mroot",null,this.renderElements([r,a]))}renderMmlDelimiter(e){var t,r;const a=[];return a.push(rt(Ye,"mo",null,[null!==(t=e.props.beginChar)&&void 0!==t?t:"("])),a.push(...this.renderElements(e.children)),a.push(rt(Ye,"mo",null,[null!==(r=e.props.endChar)&&void 0!==r?r:")"])),rt(Ye,"mrow",null,a)}renderMmlNary(e){var t,r;const a=[],n=P(e.children,(e=>e.type)),s=n[D.MmlSuperArgument],i=n[D.MmlSubArgument],l=s?rt(Ye,"mo",null,T(this.renderElement(s))):null,o=i?rt(Ye,"mo",null,T(this.renderElement(i))):null,c=rt(Ye,"mo",null,[null!==(r=null===(t=e.props)||void 0===t?void 0:t.char)&&void 0!==r?r:"∫"]);return l||o?a.push(rt(Ye,"munderover",null,[c,o,l])):l?a.push(rt(Ye,"mover",null,[c,l])):o?a.push(rt(Ye,"munder",null,[c,o])):a.push(c),a.push(...this.renderElements(n[D.MmlBase].children)),rt(Ye,"mrow",null,a)}renderMmlPreSubSuper(e){const t=[],r=P(e.children,(e=>e.type)),a=r[D.MmlSuperArgument],n=r[D.MmlSubArgument],s=a?rt(Ye,"mo",null,T(this.renderElement(a))):null,i=n?rt(Ye,"mo",null,T(this.renderElement(n))):null,l=rt(Ye,"mo",null);return t.push(rt(Ye,"msubsup",null,[l,i,s])),t.push(...this.renderElements(r[D.MmlBase].children)),rt(Ye,"mrow",null,t)}renderMmlGroupChar(e){const t="bot"===e.props.verticalJustification?"mover":"munder",r=this.renderContainerNS(e,Ye,t);return e.props.char&&r.appendChild(rt(Ye,"mo",null,[e.props.char])),r}renderMmlBar(e){const t=this.renderContainerNS(e,Ye,"mrow");switch(e.props.position){case"top":t.style.textDecoration="overline";break;case"bottom":t.style.textDecoration="underline"}return t}renderMmlRun(e){const t=rt(Ye,"ms");return this.renderClass(e,t),this.renderStyleValues(e.cssStyle,t),this.renderChildren(e,t),t}renderMllList(e){const t=rt(Ye,"mtable");this.renderClass(e,t),this.renderStyleValues(e.cssStyle,t);const r=this.renderChildren(e);for(let e of r)t.appendChild(rt(Ye,"mtr",null,[rt(Ye,"mtd",null,[e])]));return t}renderStyleValues(e,t){for(let r in e)r.startsWith("$")?t.setAttribute(r.slice(1),e[r]):t.style[r]=e[r]}renderRunProperties(e,t){this.renderCommonProperties(e,t)}renderCommonProperties(e,t){null!=t&&(t.color&&(e.color=t.color),t.fontSize&&(e["font-size"]=t.fontSize))}renderClass(e,t){e.className&&(t.className=e.className),e.styleName&&t.classList.add(this.processStyleName(e.styleName))}findStyle(e){var t;return e&&(null===(t=this.styleMap)||void 0===t?void 0:t[e])}tabStopClass(){return`${this.className}-tab-stop`}refreshTabStops(){this.options.experimental&&(clearTimeout(this.tabsTimeout),this.tabsTimeout=setTimeout((()=>{const e=qe();for(let t of this.currentTabs)Xe(t.span,t.stops,this.defaultTabSize,e)}),500))}}function et(e,t,r){return rt(void 0,e,t,r)}function tt(e,t,r){return rt(Ke,e,t,r)}function rt(e,t,r,a){let n=e?document.createElementNS(e,t):document.createElement(t);return Object.assign(n,r),a&&nt(n,a),n}function at(e){e.innerHTML=""}function nt(e,t){t.forEach((t=>{e.appendChild(M(t)?document.createTextNode(t):t)}))}function st(e){return et("style",{innerHTML:e})}function it(e,t){e.appendChild(document.createComment(t))}const lt="http://www.w3.org/2000/svg",ot="http://www.w3.org/1998/Math/MathML";var ct;!function(e){e.TRUE="true",e.FALSE="false",e.UNKNOWN="undetected"}(ct||(ct={}));class pt{constructor(){this.className="docx",this.styleMap={},this.currentPart=null,this.tableVerticalMerges=[],this.currentVerticalMerge=null,this.tableCellPositions=[],this.currentCellPosition=null,this.footnoteMap={},this.endnoteMap={},this.currentEndnoteIds=[],this.usedHederFooterParts=[],this.currentTabs=[],this.tabsTimeout=0}render(e,t,a=null,n){var s;return r(this,void 0,void 0,(function*(){this.document=e,this.options=n,this.className=n.className,this.rootSelector=n.inWrapper?`.${this.className}-wrapper`:":root",this.styleMap=null,this.wrapper=t,ut(a=a||t),ut(t),bt(a,"docxjs library predefined styles"),a.appendChild(this.renderDefaultStyle()),e.themePart&&(bt(a,"docxjs document theme values"),this.renderTheme(e.themePart,a)),null!=e.stylesPart&&(this.styleMap=this.processStyles(e.stylesPart.styles),bt(a,"docxjs document styles"),a.appendChild(this.renderStyles(e.stylesPart.styles))),e.numberingPart&&(this.processNumberings(e.numberingPart.domNumberings),bt(a,"docxjs document numbering styles"),a.appendChild(this.renderNumbering(e.numberingPart.domNumberings,a))),!n.ignoreFonts&&e.fontTablePart&&this.renderFontTable(e.fontTablePart,a),e.footnotesPart&&(this.footnoteMap=P(e.footnotesPart.notes,(e=>e.id))),e.endnotesPart&&(this.endnoteMap=P(e.endnotesPart.notes,(e=>e.id))),e.settingsPart&&(this.defaultTabSize=null===(s=e.settingsPart.settings)||void 0===s?void 0:s.defaultTabStop),this.options.inWrapper?(this.wrapper=this.renderWrapper(),t.appendChild(this.wrapper)):this.wrapper=t,this.renderKonva(),yield this.renderPages(e.documentPart.body),this.refreshTabStops()}))}renderDefaultStyle(){const e=this.className;return gt(`\n\t\t\t.${e}-wrapper { background: gray; padding: 30px; padding-bottom: 0px; display: flex; flex-flow: column; align-items: center; line-height:normal; font-weight:normal; } \n\t\t\t.${e}-wrapper>section.${e} { background: white; box-shadow: 0 0 10px rgba(0, 0, 0, 0.5); margin-bottom: 30px; }\n\t\t\t.${e} { color: black; hyphens: auto; text-underline-position: from-font; }\n\t\t\tsection.${e} { box-sizing: border-box; display: flex; flex-flow: column nowrap; position: relative; overflow: hidden; }\n            section.${e}>header { position: absolute; top: 0; z-index: 1; display: flex; align-items: flex-end; }\n\t\t\tsection.${e}>article { z-index: 1; }\n\t\t\tsection.${e}>footer { position: absolute; bottom: 0; z-index: 1; }\n\t\t\t.${e} table { border-collapse: collapse; }\n\t\t\t.${e} table td, .${e} table th { vertical-align: top; }\n\t\t\t.${e} p { margin: 0pt; min-height: 1em; }\n\t\t\t.${e} span { white-space: pre-wrap; overflow-wrap: break-word; }\n\t\t\t.${e} a { color: inherit; text-decoration: inherit; }\n\t\t\t.${e} img, ${e} svg { vertical-align: baseline; }\n\t\t\t.${e} .clearfix::after { content: ""; display: block; line-height: 0; clear: both; }\n\t\t`)}renderTheme(e,t){var r,a;const n={},s=null===(r=e.theme)||void 0===r?void 0:r.fontScheme;s&&(s.majorFont&&(n["--docx-majorHAnsi-font"]=s.majorFont.latinTypeface),s.minorFont&&(n["--docx-minorHAnsi-font"]=s.minorFont.latinTypeface));const i=null===(a=e.theme)||void 0===a?void 0:a.colorScheme;if(i)for(const[e,t]of Object.entries(i.colors))n[`--docx-${e}-color`]=`#${t}`;const l=this.styleToString(`.${this.className}`,n);t.appendChild(gt(l))}processStyleName(e){return e?`${this.className}_${k(e)}`:this.className}processStyles(e){let t=P(e.filter((e=>null!=e.id)),(e=>e.id));for(const r of e.filter((e=>e.basedOn))){const e=t[r.basedOn];if(e){r.paragraphProps=N(r.paragraphProps,e.paragraphProps),r.runProps=N(r.runProps,e.runProps);for(let t of e.styles){let e=r.styles.find((e=>e.target==t.target));e?this.copyStyleProperties(t.values,e.values):r.styles.push(Object.assign(Object.assign({},t),{values:Object.assign({},t.values)}))}}else this.options.debug&&console.warn(`Can't find base style ${r.basedOn}`)}for(const t of e)t.cssName=this.processStyleName(t.id);return t}renderStyles(e){var t;let r="",a=this.styleMap,n=P(e.filter((e=>e.isDefault)),(e=>e.target));for(const s of e){let e=s.styles;if(s.linked){const t=s.linked&&a[s.linked];t?e=e.concat(t.styles):this.options.debug&&console.warn(`Can't find linked style ${s.linked}`)}for(const a of e){let e=`${null!==(t=s.target)&&void 0!==t?t:""}.${s.cssName}`;s.target!=a.target&&(e+=` ${a.target}`),n[s.target]==s&&(e=`.${this.className} ${s.target}, `+e),r+=this.styleToString(e,a.values)}}return gt(r)}processNumberings(e){var t;for(const r of e.filter((e=>e.pStyleName))){const e=this.findStyle(r.pStyleName);(null===(t=null==e?void 0:e.paragraphProps)||void 0===t?void 0:t.numbering)&&(e.paragraphProps.numbering.level=r.level)}}renderNumbering(e,t){let r="";const a=[];for(const n of e){const e=`p.${this.numberingClass(n.id,n.level)}`;let s="none";if(n.bullet){const a=`--${this.className}-${n.bullet.src}`.toLowerCase();r+=this.styleToString(`${e}:before`,{content:"' '",display:"inline-block",background:`var(${a})`},n.bullet.style),this.document.loadNumberingImage(n.bullet.src).then((e=>{const r=`${this.rootSelector} { ${a}: url(${e}) }`;t.appendChild(gt(r))}))}else if(n.levelText){const t=this.numberingCounter(n.id,n.level),s=t+" "+(n.start-1);n.level>0&&(r+=this.styleToString(`p.${this.numberingClass(n.id,n.level-1)}`,{"counter-reset":s})),a.push(s),r+=this.styleToString(`${e}:before`,Object.assign({content:this.levelTextToContent(n.levelText,n.suff,n.id,this.numFormatToCssValue(n.format)),"counter-increment":t},n.rStyle))}else s=this.numFormatToCssValue(n.format);r+=this.styleToString(e,Object.assign({display:"list-item","list-style-position":"inside","list-style-type":s},n.pStyle))}return a.length>0&&(r+=this.styleToString(this.rootSelector,{"counter-reset":a.join(" ")})),gt(r)}numberingClass(e,t){return`${this.className}-num-${e}-${t}`}styleToString(e,t,r=null){let a=`${e} {\r\n`;for(const e in t)e.startsWith("$")||(a+=`  ${e}: ${t[e]};\r\n`);return r&&(a+=r),a+"}\r\n"}numberingCounter(e,t){return`${this.className}-num-${e}-${t}`}levelTextToContent(e,t,r,a){var n;return`"${e.replace(/%\d*/g,(e=>{const t=parseInt(e.substring(1),10)-1;return`"counter(${this.numberingCounter(r,t)}, ${a})"`}))}${null!==(n={tab:"\\9",space:"\\a0"}[t])&&void 0!==n?n:""}"`}numFormatToCssValue(e){var t;return null!==(t={none:"none",bullet:"disc",decimal:"decimal",lowerLetter:"lower-alpha",upperLetter:"upper-alpha",lowerRoman:"lower-roman",upperRoman:"upper-roman",decimalZero:"decimal-leading-zero",aiueo:"katakana",aiueoFullWidth:"katakana",chineseCounting:"simp-chinese-informal",chineseCountingThousand:"simp-chinese-informal",chineseLegalSimplified:"simp-chinese-formal",chosung:"hangul-consonant",ideographDigital:"cjk-ideographic",ideographTraditional:"cjk-heavenly-stem",ideographLegalTraditional:"trad-chinese-formal",ideographZodiac:"cjk-earthly-branch",iroha:"katakana-iroha",irohaFullWidth:"katakana-iroha",japaneseCounting:"japanese-informal",japaneseDigitalTenThousand:"cjk-decimal",japaneseLegal:"japanese-formal",thaiNumbers:"thai",koreanCounting:"korean-hangul-formal",koreanDigital:"korean-hangul-formal",koreanDigital2:"korean-hanja-informal",hebrew1:"hebrew",hebrew2:"hebrew",hindiNumbers:"devanagari",ganada:"hangul",taiwaneseCounting:"cjk-ideographic",taiwaneseCountingThousand:"cjk-ideographic",taiwaneseDigital:"cjk-decimal"}[e])&&void 0!==t?t:e}renderFontTable(e,t){for(const r of e.fonts)for(const e of r.embedFontRefs)this.document.loadFont(e.id,e.key).then((a=>{const n={"font-family":r.name,src:`url(${a})`};"bold"!=e.type&&"boldItalic"!=e.type||(n["font-weight"]="bold"),"italic"!=e.type&&"boldItalic"!=e.type||(n["font-style"]="italic"),bt(t,`docxjs ${r.name} font`);const s=this.styleToString("@font-face",n);t.appendChild(gt(s)),this.refreshTabStops()}))}renderWrapper(){return dt("div",{className:`${this.className}-wrapper`})}copyStyleProperties(e,t,r=null){if(!e)return t;null==t&&(t={}),null==r&&(r=Object.getOwnPropertyNames(e));for(const a of r)e.hasOwnProperty(a)&&!t.hasOwnProperty(a)&&(t[a]=e[a]);return t}processElement(e){if(e.children)for(const t of e.children)t.parent=e,t.type==D.Table?(this.processTable(t),this.processElement(t)):this.processElement(t)}processTable(e){for(const t of e.children)for(const r of t.children)r.cssStyle=this.copyStyleProperties(e.cellStyle,r.cssStyle,["border-left","border-right","border-top","border-bottom","padding-left","padding-right","padding-top","padding-bottom"])}splitPage(e){var t;let r=new Je({});const a=[r];for(const n of e){if(n.level=1,r.elements.push(n),n.type==D.Paragraph){const e=n,s=e.sectionProps;s&&(s.sectionId=A());const i=this.findStyle(e.styleName);(null===(t=null==i?void 0:i.paragraphProps)||void 0===t?void 0:t.pageBreakBefore)&&(r.isSplit=!0,r.sectProps=s,r=new Je({}),a.push(r));let l=-1,o=-1;if(e.children&&(l=e.children.findIndex((e=>{var t;return o=null===(t=e.children)||void 0===t?void 0:t.findIndex((e=>e.type==D.Break&&("lastRenderedPageBreak"==e.break?r.elements.length>2||!this.options.ignoreLastRenderedPageBreak:"page"===e.break||void 0))),o=null!=o?o:-1,-1!=o}))),-1!=l){r.isSplit=!0;const e=r.elements.some((e=>e.type===D.Table));e&&(r.isSplit=!1);let t=r.elements.some((e=>e.children.some((e=>{var t;return e.type===D.Hyperlink&&(null===(t=null==e?void 0:e.href)||void 0===t?void 0:t.includes("Toc"))}))));t&&(r.isSplit=!1)}if((-1!=l||s&&s.type!=F.Continuous&&s.type!=F.NextColumn)&&(r.sectProps=s,r=new Je({}),a.push(r)),-1!=l){const t=e.children[l],a=o<t.children.length-1;if(l<e.children.length-1||a){const n=e.children,s=Object.assign(Object.assign({},e),{children:n.slice(l)});if(e.children=n.slice(0,l),r.elements.push(s),a){const r=t.children,a=Object.assign(Object.assign({},t),{children:r.slice(0,o)});e.children.push(a),t.children=r.slice(o)}}}}n.type===D.Table&&(r.isSplit=!1)}let n=null;for(let e=a.length-1;e>=0;e--)null==a[e].sectProps?a[e].sectProps=n:n=a[e].sectProps;return a}renderPages(e){return r(this,void 0,void 0,(function*(){let t;this.processElement(e),t=this.options.breakPages?this.splitPage(e.children):[new Je({sectProps:e.props,elements:e.children})],e.pages=t;let r=null,a=structuredClone(t);for(let t=0;t<a.length;t++){this.currentFootnoteIds=[];const n=a[t],{sectProps:s}=n;n.sectProps=null!=s?s:e.props,n.isFirstPage=r!=n.sectProps,n.isLastPage=t===a.length-1,n.checkingOverflow=!1,this.currentPage=n,r=n.sectProps,yield this.renderPage()}}))}renderPage(){return r(this,void 0,void 0,(function*(){const{pageId:e,sectProps:t,elements:r,isFirstPage:a,isLastPage:n}=this.currentPage,s=this.createPage(this.className,t);this.renderStyleValues(this.document.documentPart.body.cssStyle,s);let i=this.document.documentPart.body.pages,l=i.findIndex((t=>t.pageId===e));this.options.renderHeaders&&(yield this.renderHeaderFooterRef(t.headerRefs,t,l,a,s)),this.options.renderFootnotes&&(yield this.renderNotes(this.currentFootnoteIds,this.footnoteMap,s)),this.options.renderEndnotes&&n&&(yield this.renderNotes(this.currentEndnoteIds,this.endnoteMap,s)),this.options.renderFooters&&(yield this.renderHeaderFooterRef(t.footerRefs,t,l,a,s));const o=this.createPageContent(t);this.options.breakPages?o.style.height=t.contentSize.height:o.style.minHeight=t.contentSize.height,this.currentPage.contentElement=o,s.appendChild(o),this.currentPage.checkingOverflow=!0,(yield this.renderElements(r,o))===ct.FALSE&&(this.currentPage.isSplit=!0,i[l]=this.currentPage),this.currentPage.checkingOverflow=!1}))}createPage(e,t){const r=dt("section",{className:e});return t&&(r.dataset.sectionId=t.sectionId,t.pageMargins&&(r.style.paddingLeft=t.pageMargins.left,r.style.paddingRight=t.pageMargins.right,r.style.paddingTop=t.pageMargins.top,r.style.paddingBottom=t.pageMargins.bottom),t.pageSize&&(this.options.ignoreWidth||(r.style.width=t.pageSize.width),this.options.ignoreHeight||(r.style.minHeight=t.pageSize.height))),this.wrapper.appendChild(r),r}createPageContent(e){const t=dt("article"),{count:r,space:a,separator:n}=null==e?void 0:e.columns;return r>1&&(t.style.columnCount=`${r}`,t.style.columnGap=a),n&&(t.style.columnRule="1px solid black"),t}renderHeaderFooterRef(e,t,a,n,s){var i,l,o,c,p,d;return r(this,void 0,void 0,(function*(){if(!e)return;let r;r=t.titlePage&&n?e.find((e=>"first"==e.type)):a%2==1?e.find((e=>"even"==e.type)):e.find((e=>"default"==e.type));let h=this.document.findPartByRelId(null==r?void 0:r.id,this.document.documentPart);if(h){switch(this.currentPart=h,this.usedHederFooterParts.includes(h.path)||(this.processElement(h.rootElement),this.usedHederFooterParts.push(h.path)),h.rootElement.type){case D.Header:h.rootElement.cssStyle={left:null===(i=t.pageMargins)||void 0===i?void 0:i.left,width:null===(l=t.contentSize)||void 0===l?void 0:l.width,height:null===(o=t.pageMargins)||void 0===o?void 0:o.top};break;case D.Footer:h.rootElement.cssStyle={left:null===(c=t.pageMargins)||void 0===c?void 0:c.left,width:null===(p=t.contentSize)||void 0===p?void 0:p.width,height:null===(d=t.pageMargins)||void 0===d?void 0:d.bottom};break;default:console.warn("set header/footer style error",h.rootElement.type)}yield this.renderElements([h.rootElement],s),this.currentPart=null}}))}renderNotes(e,t,a){return r(this,void 0,void 0,(function*(){const r=e.map((e=>t[e])).filter((e=>e));if(r.length>0){const e=dt("ol",null);yield this.renderElements(r,e),a.appendChild(e)}}))}renderElements(e,t){var a;return r(this,void 0,void 0,(function*(){let r=ct.FALSE;for(let n=0;n<e.length;n++){1===e[n].level&&(this.currentPage.breakIndex=n);const s=yield this.renderElement(e[n],t);if((null===(a=null==s?void 0:s.dataset)||void 0===a?void 0:a.overflow)===ct.TRUE){r=ct.TRUE;break}}return r}))}renderElement(e,t){return r(this,void 0,void 0,(function*(){let r;switch(e.type){case D.Paragraph:r=yield this.renderParagraph(e,t);break;case D.Run:r=yield this.renderRun(e,t);break;case D.Text:r=yield this.renderText(e,t);break;case D.Table:r=yield this.renderTable(e,t);break;case D.Row:r=yield this.renderTableRow(e,t);break;case D.Cell:r=yield this.renderTableCell(e),t&&ft(t,r);break;case D.Hyperlink:r=yield this.renderHyperlink(e,t);break;case D.Drawing:r=yield this.renderDrawing(e,t);break;case D.Image:r=yield this.renderImage(e,t);break;case D.BookmarkStart:r=this.renderBookmarkStart(e),t&&ft(t,r);break;case D.BookmarkEnd:r=null;break;case D.Tab:r=yield this.renderTab(e,t);break;case D.Symbol:r=yield this.renderSymbol(e,t);break;case D.Break:r=yield this.renderBreak(e,t);break;case D.Inserted:r=yield this.renderInserted(e),t&&(yield this.appendChildren(t,r));break;case D.Deleted:r=yield this.renderDeleted(e),t&&(yield this.appendChildren(t,r));break;case D.DeletedText:r=yield this.renderDeletedText(e,t);break;case D.NoBreakHyphen:r=dt("wbr"),t&&(yield this.appendChildren(t,r));break;case D.CommentRangeStart:r=this.renderCommentRangeStart(e),t&&ft(t,r);break;case D.CommentRangeEnd:r=this.renderCommentRangeEnd(e),t&&ft(t,r);break;case D.CommentReference:r=this.renderCommentReference(e),t&&ft(t,r);break;case D.Footer:r=yield this.renderHeaderFooter(e,"footer"),t&&ft(t,r);break;case D.Header:r=yield this.renderHeaderFooter(e,"header"),t&&ft(t,r);break;case D.Footnote:case D.Endnote:r=yield this.renderContainer(e,"li"),t&&ft(t,r);break;case D.FootnoteReference:r=this.renderFootnoteReference(e),t&&ft(t,r);break;case D.EndnoteReference:r=this.renderEndnoteReference(e),t&&ft(t,r);break;case D.VmlElement:r=yield this.renderVmlElement(e,t);break;case D.VmlPicture:r=yield this.renderVmlPicture(e),t&&ft(t,r);break;case D.MmlMath:r=yield this.renderContainerNS(e,ot,"math",{xmlns:ot}),t&&(r.dataset.overflow=yield this.appendChildren(t,r));break;case D.MmlMathParagraph:r=yield this.renderContainer(e,"span"),t&&ft(t,r);break;case D.MmlFraction:r=yield this.renderContainerNS(e,ot,"mfrac"),t&&ft(t,r);break;case D.MmlBase:r=yield this.renderContainerNS(e,ot,e.parent.type==D.MmlMatrixRow?"mtd":"mrow"),t&&ft(t,r);break;case D.MmlNumerator:case D.MmlDenominator:case D.MmlFunction:case D.MmlLimit:case D.MmlBox:r=yield this.renderContainerNS(e,ot,"mrow"),t&&ft(t,r);break;case D.MmlGroupChar:r=yield this.renderMmlGroupChar(e),t&&ft(t,r);break;case D.MmlLimitLower:r=yield this.renderContainerNS(e,ot,"munder"),t&&ft(t,r);break;case D.MmlMatrix:r=yield this.renderContainerNS(e,ot,"mtable"),t&&ft(t,r);break;case D.MmlMatrixRow:r=yield this.renderContainerNS(e,ot,"mtr"),t&&ft(t,r);break;case D.MmlRadical:r=yield this.renderMmlRadical(e),t&&ft(t,r);break;case D.MmlSuperscript:r=yield this.renderContainerNS(e,ot,"msup"),t&&ft(t,r);break;case D.MmlSubscript:r=yield this.renderContainerNS(e,ot,"msub"),t&&ft(t,r);break;case D.MmlDegree:case D.MmlSuperArgument:case D.MmlSubArgument:r=yield this.renderContainerNS(e,ot,"mn"),t&&ft(t,r);break;case D.MmlFunctionName:r=yield this.renderContainerNS(e,ot,"ms"),t&&ft(t,r);break;case D.MmlDelimiter:r=yield this.renderMmlDelimiter(e),t&&ft(t,r);break;case D.MmlRun:r=yield this.renderMmlRun(e),t&&ft(t,r);break;case D.MmlNary:r=yield this.renderMmlNary(e),t&&ft(t,r);break;case D.MmlPreSubSuper:r=yield this.renderMmlPreSubSuper(e),t&&ft(t,r);break;case D.MmlBar:r=yield this.renderMmlBar(e),t&&ft(t,r);break;case D.MmlEquationArray:r=yield this.renderMllList(e),t&&ft(t,r)}return r&&1===(null==r?void 0:r.nodeType)&&(r.dataset.tag=e.type),r}))}isPageBreakElement(e){return e.type==D.Break&&("lastRenderedPageBreak"==e.break?!this.options.ignoreLastRenderedPageBreak:"page"===e.break||void 0)}renderChildren(e,t){return r(this,void 0,void 0,(function*(){return yield this.renderElements(e.children,t)}))}appendChildren(e,t,a){return r(this,void 0,void 0,(function*(){ft(e,t);let r=!1,{pageId:n,sectProps:s,isSplit:i,contentElement:l,breakIndex:o,checkingOverflow:c,elements:p}=this.currentPage;if(i)return ct.UNKNOWN;if(c&&(r=function(e){const t=getComputedStyle(e).overflow;t&&"visible"!==t||(e.style.overflow="hidden");const r=e.clientHeight<e.scrollHeight;return e.style.overflow=t,r}(l),r)){if((null==a?void 0:a.type)===D.Row){const e=p[o],t=e.children.findIndex((e=>e===a)),r=e.children.filter((e=>e.isHeader));e.children.splice(0,t),e.children=[...r,...e.children]}let r=p.splice(o);!function(e,t){Array.isArray(e)?e.forEach((e=>{e instanceof Element?e.remove():t&&t.removeChild(e)})):e instanceof Element?e.remove():e&&t.removeChild(e)}(t,e);let i=this.document.documentPart.body.pages,l=i.findIndex((e=>e.pageId===n));this.currentPage.isSplit=!0,this.currentPage.checkingOverflow=!1;const c=new Je({sectProps:s,elements:r});i[l]=this.currentPage,i.splice(l+1,0,c),this.currentPage=c,yield this.renderPage()}return r?ct.TRUE:ct.FALSE}))}renderContainer(e,t,a){return r(this,void 0,void 0,(function*(){const r=dt(t,a);return yield this.renderChildren(e,r),r}))}renderContainerNS(e,t,a,n){return r(this,void 0,void 0,(function*(){const r=mt(t,a,n);return yield this.renderChildren(e,r),r}))}renderParagraph(e,t){var a,n,s,i;return r(this,void 0,void 0,(function*(){const r=dt("p");r.dataset.uuid=A(),this.renderClass(e,r),this.renderStyleValues(e.cssStyle,r),this.renderCommonProperties(r.style,e);const l=this.findStyle(e.styleName);null!==(a=e.tabs)&&void 0!==a||(e.tabs=null===(n=null==l?void 0:l.paragraphProps)||void 0===n?void 0:n.tabs);const o=null!==(s=e.numbering)&&void 0!==s?s:null===(i=null==l?void 0:l.paragraphProps)||void 0===i?void 0:i.numbering;o&&r.classList.add(this.numberingClass(o.id,o.level));const c=e.children.some((e=>{var t,r;const a=null===(t=null==e?void 0:e.children)||void 0===t?void 0:t.some((e=>e.type===D.Drawing&&e.props.wrapType===B.TopAndBottom)),n=null===(r=null==e?void 0:e.children)||void 0===r?void 0:r.some((e=>{var t;return e.type===D.Break&&(null===(t=null==e?void 0:e.props)||void 0===t?void 0:t.clear)}));return a||n}));if(c&&r.classList.add("clearfix"),r.style.position="relative",t){if((yield this.appendChildren(t,r))===ct.TRUE)return r.dataset.overflow=ct.TRUE,r}return r.dataset.overflow=yield this.renderChildren(e,r),r}))}renderRun(e,t){return r(this,void 0,void 0,(function*(){if(e.fieldRun)return null;const r=dt("span");if(e.id&&(r.id=e.id),this.renderClass(e,r),this.renderStyleValues(e.cssStyle,r),t){if((yield this.appendChildren(t,r))===ct.TRUE)return r.dataset.overflow=ct.TRUE,r}if(e.verticalAlign){const t=dt(e.verticalAlign);r.dataset.overflow=yield this.renderChildren(e,t),r.dataset.overflow=yield this.appendChildren(r,t)}else r.dataset.overflow=yield this.renderChildren(e,r);return r}))}renderText(e,t){return r(this,void 0,void 0,(function*(){const r=document.createTextNode(e.text);return t&&ft(t,r),r}))}renderTable(e,t){return r(this,void 0,void 0,(function*(){const r=dt("table");if(r.dataset.uuid=A(),this.tableCellPositions.push(this.currentCellPosition),this.tableVerticalMerges.push(this.currentVerticalMerge),this.currentVerticalMerge={},this.currentCellPosition={col:0,row:0},this.renderClass(e,r),this.renderStyleValues(e.cssStyle,r),t){if((yield this.appendChildren(t,r))===ct.TRUE)return r.dataset.overflow=ct.TRUE,r}return e.columns&&(yield this.renderTableColumns(e.columns,r)),r.dataset.overflow=yield this.renderChildren(e,r),this.currentVerticalMerge=this.tableVerticalMerges.pop(),this.currentCellPosition=this.tableCellPositions.pop(),r}))}renderTableColumns(e,t){return r(this,void 0,void 0,(function*(){const r=dt("colgroup");t&&ft(t,r);for(const t of e){const e=dt("col");t.width&&(e.style.width=t.width),ft(r,e)}return r}))}renderTableRow(e,t){return r(this,void 0,void 0,(function*(){const r=dt("tr");return this.currentCellPosition.col=0,this.renderClass(e,r),this.renderStyleValues(e.cssStyle,r),this.currentCellPosition.row++,yield this.renderChildren(e,r),t&&(r.dataset.overflow=yield this.appendChildren(t,r,e)),r}))}renderTableCell(e){return r(this,void 0,void 0,(function*(){const t=dt("td"),r=this.currentCellPosition.col;return e.verticalMerge?"restart"==e.verticalMerge?(this.currentVerticalMerge[r]=t,t.rowSpan=1):this.currentVerticalMerge[r]&&(this.currentVerticalMerge[r].rowSpan+=1,t.style.display="none"):this.currentVerticalMerge[r]=null,this.renderClass(e,t),this.renderStyleValues(e.cssStyle,t),e.span&&(t.colSpan=e.span),this.currentCellPosition.col+=t.colSpan,yield this.renderChildren(e,t),t}))}renderHyperlink(e,t){return r(this,void 0,void 0,(function*(){const r=dt("a");if(this.renderStyleValues(e.cssStyle,r),t){if((yield this.appendChildren(t,r))===ct.TRUE)return r.dataset.overflow=ct.TRUE,r}if(e.href)r.href=e.href;else if(e.id){const t=this.document.documentPart.rels.find((t=>t.id==e.id&&"External"===t.targetMode));r.href=null==t?void 0:t.target}return r.dataset.overflow=yield this.renderChildren(e,r),r}))}renderDrawing(e,t){return r(this,void 0,void 0,(function*(){const r=dt("span");if(r.style.textIndent="0px",r.dataset.wrap=null==e?void 0:e.props.wrapType,this.renderStyleValues(e.cssStyle,r),t){if((yield this.appendChildren(t,r))===ct.TRUE)return r.dataset.overflow=ct.TRUE,r}return r.dataset.overflow=yield this.renderChildren(e,r),r}))}renderImage(e,t){return r(this,void 0,void 0,(function*(){const{is_clip:r,is_transform:a}=e.props,n=new Image;this.renderStyleValues(e.cssStyle,n);const s=yield this.document.loadDocumentImage(e.src,this.currentPart);return n.src=r||a?yield this.transformImage(e,s):s,t&&(n.dataset.overflow=yield this.appendChildren(t,n)),n}))}renderKonva(){const e=dt("div");e.id="konva-container",document.body.appendChild(e),this.konva_stage=new t.Stage({container:"konva-container"}),this.konva_layer=new t.Layer({listening:!1}),this.konva_stage.add(this.konva_layer)}transformImage(e,a){return r(this,void 0,void 0,(function*(){const{width:r,height:n,is_clip:s,clip:i,is_transform:l,transform:o}=e.props,c=new Image;c.src=a,yield c.decode();const{naturalWidth:p,naturalHeight:d}=c;this.konva_stage.visible(!0),this.konva_stage.width(p),this.konva_stage.height(d),this.konva_layer.removeChildren();const h=new t.Group,m=new t.Image({image:c,x:p/2,y:d/2,width:p,height:d,offset:{x:p/2,y:d/2}});if(s){const{left:e,right:t,top:r,bottom:a}=i.path,n=p*e,s=d*r,l=p*(1-e-t),o=d*(1-r-a);m.crop({x:n,y:s,width:l,height:o}),m.size({width:l,height:o})}if(l)for(const e in o)switch(e){case"scaleX":m.scaleX(o[e]);break;case"scaleY":m.scaleY(o[e]);break;case"rotate":m.rotation(o[e])}let u;if(h.add(m),this.konva_layer.add(h),this.options.useBase64URL)u=h.toDataURL();else{const e=yield h.toBlob();u=URL.createObjectURL(e)}return this.konva_stage.visible(!1),u}))}renderBookmarkStart(e){const t=dt("span");return t.id=e.name,t}renderTab(e,t){var a;return r(this,void 0,void 0,(function*(){const r=dt("span");if(r.innerHTML="&emsp;",this.options.experimental){r.className=this.tabStopClass();const t=null===(a=function(e,t){let r=e.parent;for(;null!=r&&r.type!=t;)r=r.parent;return r}(e,D.Paragraph))||void 0===a?void 0:a.tabs;this.currentTabs.push({stops:t,span:r})}return t&&(yield this.appendChildren(t,r)),r}))}renderSymbol(e,t){return r(this,void 0,void 0,(function*(){const r=dt("span");return r.style.fontFamily=e.font,r.innerHTML=`&#x${e.char};`,t&&(yield this.appendChildren(t,r)),r}))}renderBreak(e,t){return r(this,void 0,void 0,(function*(){let r;switch(e.break){case"page":r=dt("br"),r.classList.add("break","page");break;case"textWrapping":r=dt("br"),r.classList.add("break","textWrap");break;case"column":r=dt("br"),r.classList.add("break","column");break;case"lastRenderedPageBreak":r=dt("wbr"),r.classList.add("break","lastRenderedPageBreak")}return t&&ft(t,r),r}))}renderInserted(e){return this.options.renderChanges?this.renderContainer(e,"ins"):this.renderContainer(e,"span")}renderDeleted(e){return r(this,void 0,void 0,(function*(){return this.options.renderChanges?yield this.renderContainer(e,"del"):null}))}renderDeletedText(e,t){return r(this,void 0,void 0,(function*(){let r;return this.options.renderEndnotes?(r=document.createTextNode(e.text),t&&(yield this.appendChildren(t,r))):r=null,r}))}renderCommentRangeStart(e){return this.options.experimental?document.createComment(`start of comment #${e.id}`):null}renderCommentRangeEnd(e){return this.options.experimental?document.createComment(`end of comment #${e.id}`):null}renderCommentReference(e){var t;if(!this.options.experimental)return null;const r=null===(t=this.document.commentsPart)||void 0===t?void 0:t.commentMap[e.id];return r?document.createComment(`comment #${r.id} by ${r.author} on ${r.date}`):null}renderHeaderFooter(e,t){return r(this,void 0,void 0,(function*(){const r=dt(t);return yield this.renderChildren(e,r),this.renderStyleValues(e.cssStyle,r),r}))}renderFootnoteReference(e){const t=dt("sup");return this.currentFootnoteIds.push(e.id),t.textContent=`${this.currentFootnoteIds.length}`,t}renderEndnoteReference(e){const t=dt("sup");return this.currentEndnoteIds.push(e.id),t.textContent=`${this.currentEndnoteIds.length}`,t}renderVmlElement(e,t){var a,n;return r(this,void 0,void 0,(function*(){const r=ht("svg");r.setAttribute("style",e.cssStyleText);const s=yield this.renderVmlChildElement(e);if(null===(a=e.imageHref)||void 0===a?void 0:a.id){const t=yield null===(n=this.document)||void 0===n?void 0:n.loadDocumentImage(e.imageHref.id,this.currentPart);s.setAttribute("href",t)}return ft(r,s),requestAnimationFrame((()=>{const e=r.firstElementChild.getBBox();r.setAttribute("width",`${Math.ceil(e.x+e.width)}`),r.setAttribute("height",`${Math.ceil(e.y+e.height)}`)})),t&&(r.dataset.overflow=yield this.appendChildren(t,r)),r}))}renderVmlPicture(e){return r(this,void 0,void 0,(function*(){const t=dt("span");return yield this.renderChildren(e,t),t}))}renderVmlChildElement(e){return r(this,void 0,void 0,(function*(){const t=ht(e.tagName);Object.entries(e.attrs).forEach((([e,r])=>t.setAttribute(e,r)));for(const r of e.children)if(r.type==D.VmlElement){const e=yield this.renderVmlChildElement(r);ft(t,e)}else yield this.renderElement(r,t);return t}))}renderMmlRadical(e){var t;return r(this,void 0,void 0,(function*(){const r=e.children.find((e=>e.type==D.MmlBase));let a;if(null===(t=e.props)||void 0===t?void 0:t.hideDegree)return a=mt(ot,"msqrt",null),yield this.renderElements([r],a),a;const n=e.children.find((e=>e.type==D.MmlDegree));return a=mt(ot,"mroot",null),yield this.renderElements([r,n],a),a}))}renderMmlDelimiter(e){var t,a;return r(this,void 0,void 0,(function*(){const r=mt(ot,"mrow",null);return ft(r,mt(ot,"mo",null,[null!==(t=e.props.beginChar)&&void 0!==t?t:"("])),yield this.renderElements(e.children,r),ft(r,mt(ot,"mo",null,[null!==(a=e.props.endChar)&&void 0!==a?a:")"])),r}))}renderMmlNary(e){var t,a;return r(this,void 0,void 0,(function*(){const r=[],n=P(e.children,(e=>e.type)),s=n[D.MmlSuperArgument],i=n[D.MmlSubArgument];let l=s?mt(ot,"mo",null,T(yield this.renderElement(s))):null,o=i?mt(ot,"mo",null,T(yield this.renderElement(i))):null,c=mt(ot,"mo",null,[null!==(a=null===(t=e.props)||void 0===t?void 0:t.char)&&void 0!==a?a:"∫"]);l||o?r.push(mt(ot,"munderover",null,[c,o,l])):l?r.push(mt(ot,"mover",null,[c,l])):o?r.push(mt(ot,"munder",null,[c,o])):r.push(c);const p=mt(ot,"mrow",null);return ft(p,r),yield this.renderElements(n[D.MmlBase].children,p),p}))}renderMmlPreSubSuper(e){return r(this,void 0,void 0,(function*(){const t=[],r=P(e.children,(e=>e.type)),a=r[D.MmlSuperArgument],n=r[D.MmlSubArgument];let s=a?mt(ot,"mo",null,T(yield this.renderElement(a))):null,i=n?mt(ot,"mo",null,T(yield this.renderElement(n))):null,l=mt(ot,"mo",null);t.push(mt(ot,"msubsup",null,[l,i,s]));const o=mt(ot,"mrow",null);return ft(o,t),yield this.renderElements(r[D.MmlBase].children,o),o}))}renderMmlGroupChar(e){return r(this,void 0,void 0,(function*(){let t="bot"===e.props.verticalJustification?"mover":"munder",r=yield this.renderContainerNS(e,ot,t);if(e.props.char){ft(r,mt(ot,"mo",null,[e.props.char]))}return r}))}renderMmlBar(e){return r(this,void 0,void 0,(function*(){let t=yield this.renderContainerNS(e,ot,"mrow");switch(e.props.position){case"top":t.style.textDecoration="overline";break;case"bottom":t.style.textDecoration="underline"}return t}))}renderMmlRun(e){return r(this,void 0,void 0,(function*(){const t=mt(ot,"ms");return this.renderClass(e,t),this.renderStyleValues(e.cssStyle,t),yield this.renderChildren(e,t),t}))}renderMllList(e){return r(this,void 0,void 0,(function*(){const t=mt(ot,"mtable");this.renderClass(e,t),this.renderStyleValues(e.cssStyle,t);for(const r of e.children){const e=yield this.renderElement(r),a=mt(ot,"mtd",null,[e]);ft(t,mt(ot,"mtr",null,[a]))}return t}))}renderStyleValues(e,t){for(const r in e)r.startsWith("$")?t.setAttribute(r.slice(1),e[r]):t.style[r]=e[r]}renderRunProperties(e,t){this.renderCommonProperties(e,t)}renderCommonProperties(e,t){null!=t&&(t.color&&(e.color=t.color),t.fontSize&&(e["font-size"]=t.fontSize))}renderClass(e,t){e.className&&(t.className=e.className),e.styleName&&t.classList.add(this.processStyleName(e.styleName))}findStyle(e){var t;return e&&(null===(t=this.styleMap)||void 0===t?void 0:t[e])}tabStopClass(){return`${this.className}-tab-stop`}refreshTabStops(){this.options.experimental&&(clearTimeout(this.tabsTimeout),this.tabsTimeout=setTimeout((()=>{const e=qe();for(const t of this.currentTabs)Xe(t.span,t.stops,this.defaultTabSize,e)}),500))}}function dt(e,t){return mt(null,e,t)}function ht(e,t){return mt(lt,e,t)}function mt(e,t,r,a){let n;switch(e){case"http://www.w3.org/1998/Math/MathML":case"http://www.w3.org/2000/svg":n=document.createElementNS(e,t);break;default:n=document.createElement(t)}return r&&Object.assign(n,r),a&&ft(n,a),n}function ut(e){e.innerHTML=""}function ft(e,t){Array.isArray(t)?e.append(...t):t&&(M(t)?e.append(t):e.appendChild(t))}function gt(e){return dt("style",{innerHTML:e})}function bt(e,t){e.appendChild(document.createComment(t))}const yt={className:"docx",inWrapper:!0,ignoreHeight:!1,ignoreWidth:!1,ignoreFonts:!1,ignoreTableWrap:!0,ignoreImageWrap:!1,ignoreLastRenderedPageBreak:!0,breakPages:!0,trimXmlDeclaration:!0,useBase64URL:!1,renderHeaders:!0,renderFooters:!0,renderFootnotes:!0,renderEndnotes:!0,renderChanges:!1,experimental:!1,debug:!1};function vt(e,t=null){const r=Object.assign(Object.assign({},yt),t);return Se.load(e,new He(r),r)}function xt(e,t,a=null,n=null){return r(this,void 0,void 0,(function*(){const r=Object.assign(Object.assign({},yt),n),s=new Qe,i=yield Se.load(e,new He(r),r);return yield s.render(i,t,a,r),i}))}function kt(e,t,a=null,n=null){return r(this,void 0,void 0,(function*(){const r=Object.assign(Object.assign({},yt),n),s=new pt,i=yield Se.load(e,new He(r),r);return yield s.render(i,t,a,r),i}))}export{yt as defaultOptions,vt as parseAsync,xt as renderAsync,kt as renderSync};
//# sourceMappingURL=docx-preview.esm.min.js.map
