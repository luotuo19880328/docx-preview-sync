!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("jszip")):"function"==typeof define&&define.amd?define(["exports","jszip"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).docx={},e.JSZip)}(this,(function(e,t){"use strict";var r;!function(e){e.OfficeDocument="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",e.FontTable="http://schemas.openxmlformats.org/officeDocument/2006/relationships/fontTable",e.Image="http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",e.Numbering="http://schemas.openxmlformats.org/officeDocument/2006/relationships/numbering",e.Styles="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",e.StylesWithEffects="http://schemas.microsoft.com/office/2007/relationships/stylesWithEffects",e.Theme="http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",e.Settings="http://schemas.openxmlformats.org/officeDocument/2006/relationships/settings",e.WebSettings="http://schemas.openxmlformats.org/officeDocument/2006/relationships/webSettings",e.Hyperlink="http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",e.Footnotes="http://schemas.openxmlformats.org/officeDocument/2006/relationships/footnotes",e.Endnotes="http://schemas.openxmlformats.org/officeDocument/2006/relationships/endnotes",e.Footer="http://schemas.openxmlformats.org/officeDocument/2006/relationships/footer",e.Header="http://schemas.openxmlformats.org/officeDocument/2006/relationships/header",e.ExtendedProperties="http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",e.CoreProperties="http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",e.CustomProperties="http://schemas.openxmlformats.org/package/2006/relationships/metadata/custom-properties",e.Comments="http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments"}(r||(r={}));const a={wordml:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",drawingml:"http://schemas.openxmlformats.org/drawingml/2006/main",picture:"http://schemas.openxmlformats.org/drawingml/2006/picture",compatibility:"http://schemas.openxmlformats.org/markup-compatibility/2006",math:"http://schemas.openxmlformats.org/officeDocument/2006/math"},s={Px:{mul:1/15,unit:"px"},Dxa:{mul:.05,unit:"pt"},Emu:{mul:1/12700,unit:"pt"},FontSize:{mul:.5,unit:"pt"},Border:{mul:.125,unit:"pt"},Point:{mul:1,unit:"pt"},Percent:{mul:.02,unit:"%"},LineHeight:{mul:1/240,unit:""},Opacity:{mul:1e-5,unit:""},VmlEmu:{mul:1/12700,unit:""},degree:{mul:1/6e4,unit:"deg"}};function n(e,t=s.Dxa){return e?"number"==typeof e?`${(e*t.mul).toFixed(2)}${t.unit}`:/.+(p[xt]|[%])$/.test(e)?e:`${(parseInt(e)*t.mul).toFixed(2)}${t.unit}`:null}function l(e,t,r){if(e.namespaceURI!=a.wordml)return!1;switch(e.localName){case"color":t.color=r.attr(e,"val");break;case"sz":t.fontSize=r.lengthAttr(e,"val",s.FontSize);break;default:return!1}return!0}class i{elements(e,t=null){const r=[];for(let a=0,s=e.childNodes.length;a<s;a++){let s=e.childNodes.item(a);1!=s.nodeType||null!=t&&s.localName!=t||r.push(s)}return r}element(e,t){for(let r=0,a=e.childNodes.length;r<a;r++){let a=e.childNodes.item(r);if(1==a.nodeType&&a.localName==t)return a}return null}elementAttr(e,t,r){var a=this.element(e,t);return a?this.attr(a,r):void 0}attrs(e){return Array.from(e.attributes)}attr(e,t){for(let r=0,a=e.attributes.length;r<a;r++){let a=e.attributes.item(r);if(a.localName==t)return a.value}return null}intAttr(e,t,r=null){var a=this.attr(e,t);return a?parseInt(a):r}hexAttr(e,t,r=null){var a=this.attr(e,t);return a?parseInt(a,16):r}floatAttr(e,t,r=null){var a=this.attr(e,t);return a?parseFloat(a):r}boolAttr(e,t,r=null){return function(e,t=!1){switch(e){case"1":case"on":case"true":return!0;case"0":case"off":case"false":return!1;default:return t}}(this.attr(e,t),r)}lengthAttr(e,t,r=s.Dxa){return n(this.attr(e,t),r)}}const o=new i;class c{constructor(e,t){this._package=e,this.path=t}async load(){this.rels=await this._package.loadRelationships(this.path);const e=await this._package.load(this.path),t=this._package.parseXmlDocument(e);this._package.options.keepOrigin&&(this._xmlDocument=t),this.parseXml(t.firstElementChild)}save(){var e;this._package.update(this.path,(e=this._xmlDocument,(new XMLSerializer).serializeToString(e)))}parseXml(e){}}const h={embedRegular:"regular",embedBold:"bold",embedItalic:"italic",embedBoldItalic:"boldItalic"};function d(e,t){return t.elements(e).map((e=>function(e,t){let r={name:t.attr(e,"name"),embedFontRefs:[]};for(let a of t.elements(e))switch(a.localName){case"family":r.family=t.attr(a,"val");break;case"altName":r.altName=t.attr(a,"val");break;case"embedRegular":case"embedBold":case"embedItalic":case"embedBoldItalic":r.embedFontRefs.push(p(a,t))}return r}(e,t)))}function p(e,t){return{id:t.attr(e,"id"),key:t.attr(e,"fontKey"),type:h[e.localName]}}class u extends c{parseXml(e){this.fonts=d(e,this._package.xmlParser)}}function m(e){return e?.replace(/[ .]+/g,"-").replace(/[&]+/g,"and").toLowerCase()}function f(e){let t=e.lastIndexOf("/")+1;return[0==t?"":e.substring(0,t),0==t?e:e.substring(t)]}function g(e,t){try{const r="http://docx/";return new URL(e,r+t).toString().substring(r.length)}catch{return`${t}${e}`}}function b(e,t){return e.reduce(((e,r)=>(e[t(r)]=r,e)),{})}function y(e){return e&&"object"==typeof e&&!Array.isArray(e)}function k(e){return"string"==typeof e||e instanceof String}function w(e,...t){if(!t.length)return e;const r=t.shift();if(y(e)&&y(r))for(const t in r)if(y(r[t])){w(e[t]??(e[t]={}),r[t])}else e[t]=r[t];return w(e,...t)}function S(e){return Array.isArray(e)?e:[e]}function x(){if("object"==typeof crypto){if("function"==typeof crypto.randomUUID)return crypto.randomUUID();if("function"==typeof crypto.getRandomValues&&"function"==typeof Uint8Array){return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,(e=>{const t=Number(e);return(t^crypto.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16)}))}}let e=(new Date).getTime(),t="undefined"!=typeof performance&&performance.now&&1e3*performance.now()||0;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(r=>{let a=16*Math.random();return e>0?(a=(e+a)%16|0,e=Math.floor(e/16)):(a=(t+a)%16|0,t=Math.floor(t/16)),("x"===r?a:3&a|8).toString(16)}))}class P{constructor(e,t){this._zip=e,this.options=t,this.xmlParser=new i}get(e){return this._zip.files[function(e){return e.startsWith("/")?e.substr(1):e}(e)]}update(e,t){this._zip.file(e,t)}static async load(e,r){const a=await t.loadAsync(e);return new P(a,r)}save(e="blob"){return this._zip.generateAsync({type:e})}load(e,t="string"){return this.get(e)?.async(t)??Promise.resolve(null)}async loadRelationships(e=null){let t="_rels/.rels";if(null!=e){const[r,a]=f(e);t=`${r}_rels/${a}.rels`}const r=await this.load(t);return r?(a=this.parseXmlDocument(r).firstElementChild,(s=this.xmlParser).elements(a).map((e=>({id:s.attr(e,"Id"),type:s.attr(e,"Type"),target:s.attr(e,"Target"),targetMode:s.attr(e,"TargetMode")})))):null;var a,s}parseXmlDocument(e){return function(e,t=!1){var r;t&&(e=e.replace(/<[?].*[?]>/,"")),e=65279===(r=e).charCodeAt(0)?r.substring(1):r;const a=(new DOMParser).parseFromString(e,"application/xml"),s=(n=a,n.getElementsByTagName("parsererror")[0]?.textContent);var n;if(s)throw new Error(s);return a}(e,this.options.trimXmlDeclaration)}}class C extends c{constructor(e,t,r){super(e,t),this._documentParser=r}parseXml(e){this.body=this._documentParser.parseDocumentFile(e)}}function v(e,t){return{type:t.attr(e,"val"),color:t.attr(e,"color"),size:t.lengthAttr(e,"sz",s.Border),offset:t.lengthAttr(e,"space",s.Point),frame:t.boolAttr(e,"frame"),shadow:t.boolAttr(e,"shadow")}}function N(e,t){var r={};for(let a of t.elements(e))switch(a.localName){case"left":r.left=v(a,t);break;case"top":r.top=v(a,t);break;case"right":r.right=v(a,t);break;case"bottom":r.bottom=v(a,t)}return r}var M,T,A;function E(e,t=o){var r={};let a={};for(let s of t.elements(e))switch(s.localName){case"pgSz":r.pageSize={width:t.lengthAttr(s,"w"),height:t.lengthAttr(s,"h"),orientation:t.attr(s,"orient")},a.pageSize={width:t.intAttr(s,"w"),height:t.intAttr(s,"h")};break;case"type":r.type=t.attr(s,"val");break;case"pgMar":r.pageMargins={left:t.lengthAttr(s,"left"),right:t.lengthAttr(s,"right"),top:t.lengthAttr(s,"top"),bottom:t.lengthAttr(s,"bottom"),header:t.lengthAttr(s,"header"),footer:t.lengthAttr(s,"footer"),gutter:t.lengthAttr(s,"gutter")},a.pageMargins={left:t.intAttr(s,"left"),right:t.intAttr(s,"right"),top:t.intAttr(s,"top"),bottom:t.intAttr(s,"bottom"),header:t.intAttr(s,"header"),footer:t.intAttr(s,"footer"),gutter:t.intAttr(s,"gutter")};break;case"cols":r.columns=R(s,t);break;case"headerReference":(r.headerRefs??(r.headerRefs=[])).push(B(s,t));break;case"footerReference":(r.footerRefs??(r.footerRefs=[])).push(B(s,t));break;case"titlePg":r.titlePage=t.boolAttr(s,"val",!0);break;case"pgBorders":r.pageBorders=N(s,t);break;case"pgNumType":r.pageNumber=$(s,t)}let{width:s,height:l}=a.pageSize,{left:i,right:c,top:h,bottom:d}=a.pageMargins;return r.contentSize={width:n(s-i-c),height:n(l-h-d)},r}function R(e,t){return{numberOfColumns:t.intAttr(e,"num"),space:t.lengthAttr(e,"space"),separator:t.boolAttr(e,"sep"),equalWidth:t.boolAttr(e,"equalWidth",!0),columns:t.elements(e,"col").map((e=>({width:t.lengthAttr(e,"w"),space:t.lengthAttr(e,"space")})))}}function $(e,t){return{chapSep:t.attr(e,"chapSep"),chapStyle:t.attr(e,"chapStyle"),format:t.attr(e,"fmt"),start:t.intAttr(e,"start")}}function B(e,t){return{id:t.attr(e,"id"),type:t.attr(e,"type")}}function D(e,t){let r={};for(let a of t.elements(e))F(a,r,t);return r}function F(e,t,r){return!!l(e,t,r)}function I(e,t){let r={};for(let a of t.elements(e))_(a,r,t);return r}function _(e,t,r){if(e.namespaceURI!=a.wordml)return!1;if(l(e,t,r))return!0;switch(e.localName){case"tabs":t.tabs=function(e,t){return t.elements(e,"tab").map((e=>({position:t.lengthAttr(e,"pos"),leader:t.attr(e,"leader"),style:t.attr(e,"val")})))}(e,r);break;case"sectPr":t.sectionProps=E(e,r);break;case"numPr":t.numbering=function(e,t){var r={};for(let a of t.elements(e))switch(a.localName){case"numId":r.id=t.attr(a,"val");break;case"ilvl":r.level=t.intAttr(a,"val")}return r}(e,r);break;case"spacing":return t.lineSpacing=function(e,t){return{before:t.lengthAttr(e,"before"),after:t.lengthAttr(e,"after"),line:t.intAttr(e,"line"),lineRule:t.attr(e,"lineRule")}}(e,r),!1;case"textAlignment":return t.textAlignment=r.attr(e,"val"),!1;case"keepLines":t.keepLines=r.boolAttr(e,"val",!0);break;case"keepNext":t.keepNext=r.boolAttr(e,"val",!0);break;case"pageBreakBefore":t.pageBreakBefore=r.boolAttr(e,"val",!0);break;case"outlineLvl":t.outlineLevel=r.intAttr(e,"val");break;case"pStyle":t.styleName=r.attr(e,"val");break;case"rPr":t.runProps=D(e,r);break;default:return!1}return!0}function L(e,t){let r={id:t.attr(e,"numId"),overrides:[]};for(let a of t.elements(e))switch(a.localName){case"abstractNumId":r.abstractId=t.attr(a,"val");break;case"lvlOverride":r.overrides.push(O(a,t))}return r}function H(e,t){let r={id:t.attr(e,"abstractNumId"),levels:[]};for(let a of t.elements(e))switch(a.localName){case"name":r.name=t.attr(a,"val");break;case"multiLevelType":r.multiLevelType=t.attr(a,"val");break;case"numStyleLink":r.numberingStyleLink=t.attr(a,"val");break;case"styleLink":r.styleLink=t.attr(a,"val");break;case"lvl":r.levels.push(V(a,t))}return r}function V(e,t){let r={level:t.intAttr(e,"ilvl")};for(let a of t.elements(e))switch(a.localName){case"start":r.start=t.attr(a,"val");break;case"lvlRestart":r.restart=t.intAttr(a,"val");break;case"numFmt":r.format=t.attr(a,"val");break;case"lvlText":r.text=t.attr(a,"val");break;case"lvlJc":r.justification=t.attr(a,"val");break;case"lvlPicBulletId":r.bulletPictureId=t.attr(a,"val");break;case"pStyle":r.paragraphStyle=t.attr(a,"val");break;case"pPr":r.paragraphProps=I(a,t);break;case"rPr":r.runProps=D(a,t)}return r}function O(e,t){let r={level:t.intAttr(e,"ilvl")};for(let a of t.elements(e))switch(a.localName){case"startOverride":r.start=t.intAttr(a,"val");break;case"lvl":r.numberingLevel=V(a,t)}return r}function j(e,t){var r=t.element(e,"pict"),a=r&&t.element(r,"shape"),s=a&&t.element(a,"imagedata");return s?{id:t.attr(e,"numPicBulletId"),referenceId:t.attr(s,"id"),style:t.attr(a,"style")}:null}!function(e){e.Continuous="continuous",e.NextPage="nextPage",e.NextColumn="nextColumn",e.EvenPage="evenPage",e.OddPage="oddPage"}(M||(M={}));class z extends c{constructor(e,t,r){super(e,t),this._documentParser=r}parseXml(e){Object.assign(this,function(e,t){let r={numberings:[],abstractNumberings:[],bulletPictures:[]};for(let a of t.elements(e))switch(a.localName){case"num":r.numberings.push(L(a,t));break;case"abstractNum":r.abstractNumberings.push(H(a,t));break;case"numPicBullet":r.bulletPictures.push(j(a,t))}return r}(e,this._package.xmlParser)),this.domNumberings=this._documentParser.parseNumberingFile(e)}}class W extends c{constructor(e,t,r){super(e,t),this._documentParser=r}parseXml(e){this.styles=this._documentParser.parseStylesFile(e)}}!function(e){e.Document="document",e.Paragraph="paragraph",e.Run="run",e.Break="break",e.NoBreakHyphen="noBreakHyphen",e.Table="table",e.Row="row",e.Cell="cell",e.Hyperlink="hyperlink",e.Drawing="drawing",e.Image="image",e.Text="text",e.Tab="tab",e.Symbol="symbol",e.BookmarkStart="bookmarkStart",e.BookmarkEnd="bookmarkEnd",e.Footer="footer",e.Header="header",e.FootnoteReference="footnoteReference",e.EndnoteReference="endnoteReference",e.Footnote="footnote",e.Endnote="endnote",e.SimpleField="simpleField",e.ComplexField="complexField",e.Instruction="instruction",e.VmlPicture="vmlPicture",e.Shape="shape",e.MmlMath="mmlMath",e.MmlMathParagraph="mmlMathParagraph",e.MmlFraction="mmlFraction",e.MmlFunction="mmlFunction",e.MmlFunctionName="mmlFunctionName",e.MmlNumerator="mmlNumerator",e.MmlDenominator="mmlDenominator",e.MmlRadical="mmlRadical",e.MmlBase="mmlBase",e.MmlDegree="mmlDegree",e.MmlSuperscript="mmlSuperscript",e.MmlSubscript="mmlSubscript",e.MmlPreSubSuper="mmlPreSubSuper",e.MmlSubArgument="mmlSubArgument",e.MmlSuperArgument="mmlSuperArgument",e.MmlNary="mmlNary",e.MmlDelimiter="mmlDelimiter",e.MmlRun="mmlRun",e.MmlEquationArray="mmlEquationArray",e.MmlLimit="mmlLimit",e.MmlLimitLower="mmlLimitLower",e.MmlMatrix="mmlMatrix",e.MmlMatrixRow="mmlMatrixRow",e.MmlBox="mmlBox",e.MmlBar="mmlBar",e.MmlGroupChar="mmlGroupChar",e.VmlElement="vmlElement",e.Inserted="inserted",e.Deleted="deleted",e.DeletedText="deletedText",e.Comment="comment",e.CommentReference="commentReference",e.CommentRangeStart="commentRangeStart",e.CommentRangeEnd="commentRangeEnd"}(T||(T={}));class U{constructor(){this.children=[],this.cssStyle={}}}!function(e){e.Inline="Inline",e.None="None",e.TopAndBottom="TopAndBottom",e.Tight="Tight",e.Through="Through",e.Square="Square",e.Polygon="Polygon"}(A||(A={}));class X extends U{constructor(){super(...arguments),this.type=T.Header}}class q extends U{constructor(){super(...arguments),this.type=T.Footer}}class G extends c{constructor(e,t,r){super(e,t),this._documentParser=r}parseXml(e){this.rootElement=this.createRootElement(),this.rootElement.children=this._documentParser.parseBodyElements(e)}}class J extends G{createRootElement(){return new X}}class Z extends G{createRootElement(){return new q}}function Y(e){if(void 0!==e)return parseInt(e)}class K extends c{parseXml(e){this.props=function(e,t){const r={};for(let a of t.elements(e))switch(a.localName){case"Template":r.template=a.textContent;break;case"Pages":r.pages=Y(a.textContent);break;case"Words":r.words=Y(a.textContent);break;case"Characters":r.characters=Y(a.textContent);break;case"Application":r.application=a.textContent;break;case"Lines":r.lines=Y(a.textContent);break;case"Paragraphs":r.paragraphs=Y(a.textContent);break;case"Company":r.company=a.textContent;break;case"AppVersion":r.appVersion=a.textContent}return r}(e,this._package.xmlParser)}}class Q extends c{parseXml(e){this.props=function(e,t){const r={};for(let a of t.elements(e))switch(a.localName){case"title":r.title=a.textContent;break;case"description":r.description=a.textContent;break;case"subject":r.subject=a.textContent;break;case"creator":r.creator=a.textContent;break;case"keywords":r.keywords=a.textContent;break;case"language":r.language=a.textContent;break;case"lastModifiedBy":r.lastModifiedBy=a.textContent;break;case"revision":a.textContent&&(r.revision=parseInt(a.textContent))}return r}(e,this._package.xmlParser)}}class ee{}function te(e,t){var r={name:t.attr(e,"name"),colors:{}};for(let n of t.elements(e)){var a=t.element(n,"srgbClr"),s=t.element(n,"sysClr");a?r.colors[n.localName]=t.attr(a,"val"):s&&(r.colors[n.localName]=t.attr(s,"lastClr"))}return r}function re(e,t){var r={name:t.attr(e,"name")};for(let a of t.elements(e))switch(a.localName){case"majorFont":r.majorFont=ae(a,t);break;case"minorFont":r.minorFont=ae(a,t)}return r}function ae(e,t){return{latinTypeface:t.elementAttr(e,"latin","typeface"),eaTypeface:t.elementAttr(e,"ea","typeface"),csTypeface:t.elementAttr(e,"cs","typeface")}}class se extends c{constructor(e,t){super(e,t)}parseXml(e){this.theme=function(e,t){var r=new ee,a=t.element(e,"themeElements");for(let e of t.elements(a))switch(e.localName){case"clrScheme":r.colorScheme=te(e,t);break;case"fontScheme":r.fontScheme=re(e,t)}return r}(e,this._package.xmlParser)}}class ne{}class le extends ne{constructor(){super(...arguments),this.type=T.Footnote}}class ie extends ne{constructor(){super(...arguments),this.type=T.Endnote}}class oe extends c{constructor(e,t,r){super(e,t),this._documentParser=r}}class ce extends oe{constructor(e,t,r){super(e,t,r)}parseXml(e){this.notes=this._documentParser.parseNotes(e,"footnote",le)}}class he extends oe{constructor(e,t,r){super(e,t,r)}parseXml(e){this.notes=this._documentParser.parseNotes(e,"endnote",ie)}}function de(e,t){var r={defaultNoteIds:[]};for(let a of t.elements(e))switch(a.localName){case"numFmt":r.nummeringFormat=t.attr(a,"val");break;case"footnote":case"endnote":r.defaultNoteIds.push(t.attr(a,"id"))}return r}class pe extends c{constructor(e,t){super(e,t)}parseXml(e){this.settings=function(e,t){var r={};for(let a of t.elements(e))switch(a.localName){case"defaultTabStop":r.defaultTabStop=t.lengthAttr(a,"val");break;case"footnotePr":r.footnoteProps=de(a,t);break;case"endnotePr":r.endnoteProps=de(a,t);break;case"autoHyphenation":r.autoHyphenation=t.boolAttr(a,"val")}return r}(e,this._package.xmlParser)}}class ue extends c{parseXml(e){this.props=function(e,t){return t.elements(e,"property").map((e=>{const r=e.firstChild;return{formatId:t.attr(e,"fmtid"),name:t.attr(e,"name"),type:r.nodeName,value:r.textContent}}))}(e,this._package.xmlParser)}}class me extends c{constructor(e,t,r){super(e,t),this._documentParser=r}parseXml(e){this.comments=this._documentParser.parseComments(e),this.commentMap=b(this.comments,(e=>e.id))}}const fe=[{type:r.OfficeDocument,target:"word/document.xml"},{type:r.ExtendedProperties,target:"docProps/app.xml"},{type:r.CoreProperties,target:"docProps/core.xml"},{type:r.CustomProperties,target:"docProps/custom.xml"}];class ge{constructor(){this.parts=[],this.partsMap={}}static async load(e,t,r){var a=new ge;return a._options=r,a._parser=t,a._package=await P.load(e,r),a.rels=await a._package.loadRelationships(),await Promise.all(fe.map((e=>{const t=a.rels.find((t=>t.type===e.type))??e;return a.loadRelationshipPart(t.target,t.type)}))),a}save(e="blob"){return this._package.save(e)}async loadRelationshipPart(e,t){if(this.partsMap[e])return this.partsMap[e];if(!this._package.get(e))return null;let a=null;switch(t){case r.OfficeDocument:this.documentPart=a=new C(this._package,e,this._parser);break;case r.FontTable:this.fontTablePart=a=new u(this._package,e);break;case r.Numbering:this.numberingPart=a=new z(this._package,e,this._parser);break;case r.Styles:this.stylesPart=a=new W(this._package,e,this._parser);break;case r.Theme:this.themePart=a=new se(this._package,e);break;case r.Footnotes:this.footnotesPart=a=new ce(this._package,e,this._parser);break;case r.Endnotes:this.endnotesPart=a=new he(this._package,e,this._parser);break;case r.Footer:a=new Z(this._package,e,this._parser);break;case r.Header:a=new J(this._package,e,this._parser);break;case r.CoreProperties:this.corePropsPart=a=new Q(this._package,e);break;case r.ExtendedProperties:this.extendedPropsPart=a=new K(this._package,e);break;case r.CustomProperties:a=new ue(this._package,e);break;case r.Settings:this.settingsPart=a=new pe(this._package,e);break;case r.Comments:this.commentsPart=a=new me(this._package,e,this._parser)}if(null==a)return Promise.resolve(null);if(this.partsMap[e]=a,this.parts.push(a),await a.load(),a.rels?.length>0){const[e]=f(a.path);await Promise.all(a.rels.map((t=>this.loadRelationshipPart(g(t.target,e),t.type))))}return a}async loadDocumentImage(e,t){const r=await this.loadResource(t??this.documentPart,e,"blob");return this.blobToURL(r)}async loadNumberingImage(e){const t=await this.loadResource(this.numberingPart,e,"blob");return this.blobToURL(t)}async loadFont(e,t){const r=await this.loadResource(this.fontTablePart,e,"uint8array");return r?this.blobToURL(new Blob([be(r,t)])):r}blobToURL(e){return e?this._options.useBase64URL?function(e){return new Promise(((t,r)=>{const a=new FileReader;a.onloadend=()=>t(a.result),a.onerror=()=>r(),a.readAsDataURL(e)}))}(e):URL.createObjectURL(e):null}findPartByRelId(e,t=null){var r=(t.rels??this.rels).find((t=>t.id==e));const a=t?f(t.path)[0]:"";return r?this.partsMap[g(r.target,a)]:null}getPathById(e,t){const r=e.rels.find((e=>e.id==t)),[a]=f(e.path);return r?g(r.target,a):null}loadResource(e,t,r){const a=this.getPathById(e,t);return a?this._package.load(a,r):Promise.resolve(null)}}function be(e,t){const r=t.replace(/{|}|-/g,""),a=new Array(16);for(let e=0;e<16;e++)a[16-e-1]=parseInt(r.substr(2*e,2),16);for(let t=0;t<32;t++)e[t]=e[t]^a[t%16];return e}function ye(e,t){return{type:T.BookmarkEnd,id:t.attr(e,"id")}}class ke extends U{constructor(){super(...arguments),this.type=T.VmlElement,this.attrs={}}}function we(e,t){var r=new ke;switch(e.localName){case"rect":r.tagName="rect",Object.assign(r.attrs,{width:"100%",height:"100%"});break;case"oval":r.tagName="ellipse",Object.assign(r.attrs,{cx:"50%",cy:"50%",rx:"50%",ry:"50%"});break;case"line":r.tagName="line";break;case"shape":r.tagName="g";break;case"textbox":r.tagName="foreignObject",Object.assign(r.attrs,{width:"100%",height:"100%"});break;default:return null}for(const t of o.attrs(e))switch(t.localName){case"style":r.cssStyleText=t.value;break;case"fillcolor":r.attrs.fill=t.value;break;case"from":const[e,a]=xe(t.value);Object.assign(r.attrs,{x1:e,y1:a});break;case"to":const[s,n]=xe(t.value);Object.assign(r.attrs,{x2:s,y2:n})}for(const a of o.elements(e))switch(a.localName){case"stroke":Object.assign(r.attrs,Se(a));break;case"fill":Object.assign(r.attrs,{});break;case"imagedata":r.tagName="image",Object.assign(r.attrs,{width:"100%",height:"100%"}),r.imageHref={id:o.attr(a,"id"),title:o.attr(a,"title")};break;case"txbxContent":r.children.push(...t.parseBodyElements(a));break;default:const e=we(a,t);e&&r.children.push(e)}return r}function Se(e){return{stroke:o.attr(e,"color"),"stroke-width":o.lengthAttr(e,"weight",s.Emu)??"1px"}}function xe(e){return e.split(",")}class Pe extends U{constructor(){super(...arguments),this.type=T.Comment}}class Ce extends U{constructor(e){super(),this.id=e,this.type=T.CommentReference}}class ve extends U{constructor(e){super(),this.id=e,this.type=T.CommentRangeStart}}class Ne extends U{constructor(e){super(),this.id=e,this.type=T.CommentRangeEnd}}var Me="inherit",Te="black",Ae="black",Ee="transparent";const Re=[],$e={oMath:T.MmlMath,oMathPara:T.MmlMathParagraph,f:T.MmlFraction,func:T.MmlFunction,fName:T.MmlFunctionName,num:T.MmlNumerator,den:T.MmlDenominator,rad:T.MmlRadical,deg:T.MmlDegree,e:T.MmlBase,sSup:T.MmlSuperscript,sSub:T.MmlSubscript,sPre:T.MmlPreSubSuper,sup:T.MmlSuperArgument,sub:T.MmlSubArgument,d:T.MmlDelimiter,nary:T.MmlNary,eqArr:T.MmlEquationArray,lim:T.MmlLimit,limLow:T.MmlLimitLower,m:T.MmlMatrix,mr:T.MmlMatrixRow,box:T.MmlBox,bar:T.MmlBar,groupChr:T.MmlGroupChar},Be={ignoreWidth:!1,debug:!1,ignoreTableWrap:!0,ignoreImageWrap:!0};class De{constructor(e){this.options={...Be,...e}}parseNotes(e,t,r){let a=[];for(let s of o.elements(e,t)){const e=new r;e.id=o.attr(s,"id"),e.noteType=o.attr(s,"type"),e.children=this.parseBodyElements(s),a.push(e)}return a}parseComments(e){let t=[];for(let r of o.elements(e,"comment")){const e=new Pe;e.id=o.attr(r,"id"),e.author=o.attr(r,"author"),e.initials=o.attr(r,"initials"),e.date=o.attr(r,"date"),e.children=this.parseBodyElements(r),t.push(e)}return t}parseDocumentFile(e){let t=o.element(e,"body"),r=o.element(e,"background"),a=o.element(t,"sectPr"),s={};return a&&(s=E(a,o)),s.uuid=x(),{type:T.Document,children:this.parseBodyElements(t),props:s,cssStyle:r?this.parseBackground(r):{}}}parseBackground(e){let t={},r=Ie.colorAttr(e,"color");return r&&(t["background-color"]=r),t}parseBodyElements(e){let t=[];for(let r of o.elements(e))switch(r.localName){case"p":t.push(this.parseParagraph(r));break;case"tbl":t.push(this.parseTable(r));break;case"sdt":t.push(...this.parseSdt(r,(e=>this.parseBodyElements(e))))}return t}parseStylesFile(e){let t=[];return Ie.foreach(e,(e=>{switch(e.localName){case"style":t.push(this.parseStyle(e));break;case"docDefaults":t.push(this.parseDefaultStyles(e))}})),t}parseDefaultStyles(e){let t={id:null,name:null,target:null,basedOn:null,styles:[]};return Ie.foreach(e,(e=>{switch(e.localName){case"rPrDefault":let r=o.element(e,"rPr");r&&t.styles.push({target:"span",values:this.parseDefaultProperties(r,{})});break;case"pPrDefault":let a=o.element(e,"pPr");a&&t.styles.push({target:"p",values:this.parseDefaultProperties(a,{})})}})),t}parseStyle(e){let t={id:o.attr(e,"styleId"),isDefault:o.boolAttr(e,"default"),name:null,target:null,basedOn:null,styles:[],linked:null};switch(o.attr(e,"type")){case"paragraph":t.target="p";break;case"table":t.target="table";break;case"character":t.target="span"}return Ie.foreach(e,(e=>{switch(e.localName){case"basedOn":t.basedOn=o.attr(e,"val");break;case"name":t.name=o.attr(e,"val");break;case"link":t.linked=o.attr(e,"val");break;case"next":t.next=o.attr(e,"val");break;case"aliases":t.aliases=o.attr(e,"val").split(",");break;case"pPr":t.styles.push({target:"p",values:this.parseDefaultProperties(e,{})}),t.paragraphProps=I(e,o);break;case"rPr":t.styles.push({target:"span",values:this.parseDefaultProperties(e,{})}),t.runProps=D(e,o);break;case"tblPr":case"tcPr":t.styles.push({target:"td",values:this.parseDefaultProperties(e,{})});break;case"tblStylePr":for(let r of this.parseTableStyle(e))t.styles.push(r);break;case"rsid":case"qFormat":case"hidden":case"semiHidden":case"unhideWhenUsed":case"autoRedefine":case"uiPriority":break;default:this.options.debug&&console.warn(`DOCX: Unknown style element: ${e.localName}`)}})),t}parseTableStyle(e){let t=[],r=o.attr(e,"type"),a="",s="";switch(r){case"firstRow":s=".first-row",a="tr.first-row td";break;case"lastRow":s=".last-row",a="tr.last-row td";break;case"firstCol":s=".first-col",a="td.first-col";break;case"lastCol":s=".last-col",a="td.last-col";break;case"band1Vert":s=":not(.no-vband)",a="td.odd-col";break;case"band2Vert":s=":not(.no-vband)",a="td.even-col";break;case"band1Horz":s=":not(.no-hband)",a="tr.odd-row";break;case"band2Horz":s=":not(.no-hband)",a="tr.even-row";break;default:return[]}return Ie.foreach(e,(e=>{switch(e.localName){case"pPr":t.push({target:`${a} p`,mod:s,values:this.parseDefaultProperties(e,{})});break;case"rPr":t.push({target:`${a} span`,mod:s,values:this.parseDefaultProperties(e,{})});break;case"tblPr":case"tcPr":t.push({target:a,mod:s,values:this.parseDefaultProperties(e,{})})}})),t}parseNumberingFile(e){let t=[];const r={};let a=[];return Ie.foreach(e,(e=>{switch(e.localName){case"abstractNum":this.parseAbstractNumbering(e,a).forEach((e=>t.push(e)));break;case"numPicBullet":a.push(this.parseNumberingPicBullet(e));break;case"num":let s=o.attr(e,"numId"),n=o.elementAttr(e,"abstractNumId","val");r[n]=s}})),t.forEach((e=>e.id=r[e.id])),t}parseNumberingPicBullet(e){let t=o.element(e,"pict"),r=t&&o.element(t,"shape"),a=r&&o.element(r,"imagedata");return a?{id:o.intAttr(e,"numPicBulletId"),src:o.attr(a,"id"),style:o.attr(r,"style")}:null}parseAbstractNumbering(e,t){let r=[],a=o.attr(e,"abstractNumId");return Ie.foreach(e,(e=>{if("lvl"===e.localName)r.push(this.parseNumberingLevel(a,e,t))})),r}parseNumberingLevel(e,t,r){let a={id:e,level:o.intAttr(t,"ilvl"),start:1,pStyleName:void 0,pStyle:{},rStyle:{},suff:"tab"};return Ie.foreach(t,(e=>{switch(e.localName){case"start":a.start=o.intAttr(e,"val");break;case"pPr":this.parseDefaultProperties(e,a.pStyle);break;case"rPr":this.parseDefaultProperties(e,a.rStyle);break;case"lvlPicBulletId":let t=o.intAttr(e,"val");a.bullet=r.find((e=>e.id==t));break;case"lvlText":a.levelText=o.attr(e,"val");break;case"pStyle":a.pStyleName=o.attr(e,"val");break;case"numFmt":a.format=o.attr(e,"val");break;case"suff":a.suff=o.attr(e,"val")}})),a}parseSdt(e,t){const r=o.element(e,"sdtContent");return r?t(r):[]}parseInserted(e,t){return{type:T.Inserted,children:t(e)?.children??[]}}parseDeleted(e,t){return{type:T.Deleted,children:t(e)?.children??[]}}parseParagraph(e){let t={type:T.Paragraph,children:[]};for(let s of o.elements(e))switch(s.localName){case"pPr":this.parseParagraphProperties(s,t);break;case"r":t.children.push(this.parseRun(s,t));break;case"hyperlink":t.children.push(this.parseHyperlink(s,t));break;case"bookmarkStart":t.children.push((r=s,a=o,{type:T.BookmarkStart,id:a.attr(r,"id"),name:a.attr(r,"name"),colFirst:a.intAttr(r,"colFirst"),colLast:a.intAttr(r,"colLast")}));break;case"bookmarkEnd":t.children.push(ye(s,o));break;case"commentRangeStart":t.children.push(new ve(o.attr(s,"id")));break;case"commentRangeEnd":t.children.push(new Ne(o.attr(s,"id")));break;case"oMath":case"oMathPara":t.children.push(this.parseMathElement(s));break;case"sdt":t.children.push(...this.parseSdt(s,(e=>this.parseParagraph(e).children)));break;case"ins":t.children.push(this.parseInserted(s,(e=>this.parseParagraph(e))));break;case"del":t.children.push(this.parseDeleted(s,(e=>this.parseParagraph(e))))}var r,a;if(0===t.children.length){let e={type:T.Break,break:"textWrapping"},r={type:T.Run,children:[e]};t.children=[r]}return t}parseParagraphProperties(e,t){this.parseDefaultProperties(e,t.cssStyle={},null,(e=>{if(_(e,t,o))return!0;switch(e.localName){case"pStyle":t.styleName=o.attr(e,"val");break;case"cnfStyle":t.className=_e.classNameOfCnfStyle(e);break;case"framePr":this.parseFrame(e,t);break;case"rPr":break;default:return!1}return!0}))}parseFrame(e,t){"drop"==o.attr(e,"dropCap")&&(t.cssStyle.float="left")}parseHyperlink(e,t){let r={type:T.Hyperlink,parent:t,children:[]},a=o.attr(e,"anchor"),s=o.attr(e,"id");return a&&(r.href="#"+a),s&&(r.id=s),Ie.foreach(e,(e=>{if("r"===e.localName)r.children.push(this.parseRun(e,r))})),r}parseRun(e,t){let r={type:T.Run,parent:t,children:[]};return Ie.foreach(e,(e=>{switch((e=this.checkAlternateContent(e)).localName){case"t":let t=e.textContent;"preserve"===o.attr(e,"xml:space")&&(t=t.split(/\s/).join(" ")),r.children.push({type:T.Text,text:t});break;case"delText":r.children.push({type:T.DeletedText,text:e.textContent});break;case"commentReference":r.children.push(new Ce(o.attr(e,"id")));break;case"fldSimple":r.children.push({type:T.SimpleField,instruction:o.attr(e,"instr"),lock:o.boolAttr(e,"lock",!1),dirty:o.boolAttr(e,"dirty",!1)});break;case"instrText":r.fieldRun=!0,r.children.push({type:T.Instruction,text:e.textContent});break;case"fldChar":r.fieldRun=!0,r.children.push({type:T.ComplexField,charType:o.attr(e,"fldCharType"),lock:o.boolAttr(e,"lock",!1),dirty:o.boolAttr(e,"dirty",!1)});break;case"noBreakHyphen":r.children.push({type:T.NoBreakHyphen});break;case"br":r.children.push({type:T.Break,break:o.attr(e,"type")||"textWrapping",props:{clear:o.attr(e,"clear")}});break;case"lastRenderedPageBreak":r.children.push({type:T.Break,break:"lastRenderedPageBreak"});break;case"sym":r.children.push({type:T.Symbol,font:o.attr(e,"font"),char:o.attr(e,"char")});break;case"tab":r.children.push({type:T.Tab});break;case"footnoteReference":r.children.push({type:T.FootnoteReference,id:o.attr(e,"id")});break;case"endnoteReference":r.children.push({type:T.EndnoteReference,id:o.attr(e,"id")});break;case"drawing":let a=this.parseDrawing(e);a&&(r.children=[a]);break;case"pict":r.children.push(this.parseVmlPicture(e));break;case"rPr":this.parseRunProperties(e,r)}})),r}parseMathElement(e){const t=`${e.localName}Pr`,r={type:$e[e.localName],children:[]};for(const a of o.elements(e)){if($e[a.localName])r.children.push(this.parseMathElement(a));else if("r"==a.localName){let e=this.parseRun(a);e.type=T.MmlRun,r.children.push(e)}else a.localName==t&&(r.props=this.parseMathProperies(a))}return r}parseMathProperies(e){const t={};for(const r of o.elements(e))switch(r.localName){case"chr":t.char=o.attr(r,"val");break;case"vertJc":t.verticalJustification=o.attr(r,"val");break;case"pos":t.position=o.attr(r,"val");break;case"degHide":t.hideDegree=o.boolAttr(r,"val");break;case"begChr":t.beginChar=o.attr(r,"val");break;case"endChr":t.endChar=o.attr(r,"val")}return t}parseRunProperties(e,t){this.parseDefaultProperties(e,t.cssStyle={},null,(e=>{switch(e.localName){case"rStyle":t.styleName=o.attr(e,"val");break;case"vertAlign":t.verticalAlign=_e.valueOfVertAlign(e,!0);break;default:return!1}return!0}))}parseVmlPicture(e){const t={type:T.VmlPicture,children:[]};for(const r of o.elements(e)){const e=we(r,this);e&&t.children.push(e)}return t}checkAlternateContent(e){if("AlternateContent"!=e.localName)return e;let t=o.element(e,"Choice");if(t){let r=o.attr(t,"Requires"),a=e.lookupNamespaceURI(r);if(Re.includes(a))return t.firstElementChild}return o.element(e,"Fallback")?.firstElementChild}parseDrawing(e){for(let t of o.elements(e))switch(t.localName){case"inline":case"anchor":return this.parseDrawingWrapper(t)}}parseDrawingWrapper(e){let t=o.boolAttr(e,"layoutInCell"),r=o.boolAttr(e,"locked"),a=o.boolAttr(e,"behindDoc"),n=o.boolAttr(e,"allowOverlap"),l=o.boolAttr(e,"simplePos"),i=o.intAttr(e,"relativeHeight",1),c={left:o.lengthAttr(e,"distL",s.Emu),right:o.lengthAttr(e,"distR",s.Emu),top:o.lengthAttr(e,"distT",s.Emu),bottom:o.lengthAttr(e,"distB",s.Emu),distL:o.intAttr(e,"distL",0),distR:o.intAttr(e,"distR",0),distT:o.intAttr(e,"distT",0),distB:o.intAttr(e,"distB",0)},h={type:T.Drawing,children:[],cssStyle:{},props:{localName:e.localName,wrapType:null,layoutInCell:t,locked:r,behindDoc:a,allowOverlap:n,simplePos:l,relativeHeight:i,distance:c,extent:{}}},d={relative:"page",align:"left",offset:"0pt",origin:0},p={relative:"page",align:"top",offset:"0pt",origin:0};for(let t of o.elements(e))switch(t.localName){case"simplePos":l&&(d.offset=o.lengthAttr(t,"x",s.Emu),p.offset=o.lengthAttr(t,"y",s.Emu),d.origin=o.intAttr(t,"x",0),p.origin=o.intAttr(t,"y",0));break;case"positionH":if(!l){let e=o.element(t,"align"),r=o.element(t,"posOffset");d.relative=o.attr(t,"relativeFrom")??d.relative,e&&(d.align=e.textContent),r&&(d.offset=Ie.sizeValue(r,s.Emu),d.origin=Ie.text_to_int(r,0)),h.props.posX=d}break;case"positionV":if(!l){let e=o.element(t,"align"),r=o.element(t,"posOffset");p.relative=o.attr(t,"relativeFrom")??p.relative,e&&(p.align=e.textContent),r&&(p.offset=Ie.sizeValue(r,s.Emu),p.origin=Ie.text_to_int(r,0)),h.props.posY=p}break;case"extent":let e=o.intAttr(t,"cx",0),r=o.intAttr(t,"cy",0),a=o.lengthAttr(t,"cx",s.Emu),n=o.lengthAttr(t,"cy",s.Emu);h.cssStyle.width=a,h.cssStyle.height=n,h.props.extent={width:a,height:n,origin_width:e,origin_height:r};break;case"effectExtent":break;case"graphic":let i=this.parseGraphic(t);i&&h.children.push(i);break;case"wrapTopAndBottom":h.props.wrapType=A.TopAndBottom;break;case"wrapNone":h.props.wrapType=A.None;break;case"wrapSquare":h.props.wrapType=A.Square,h.props.wrapText=o.attr(t,"wrapText");break;case"wrapThrough":case"wrapTight":h.props.wrapType=A.Tight,h.props.wrapText=o.attr(t,"wrapText");let c=o.element(t,"wrapPolygon");this.parsePolygon(c,h)}if("inline"===e.localName&&(h.props.wrapType=A.Inline),"anchor"===e.localName){h.cssStyle.position="relative",h.cssStyle["z-index"]=a?-1:i,this.options.ignoreImageWrap&&(h.props.wrapType=A.TopAndBottom);let{wrapText:e,wrapType:t,extent:r}=h.props;switch(t){case A.TopAndBottom:h.cssStyle.float="left",h.cssStyle.width="100%",h.cssStyle["text-align"]=d.align,h.cssStyle.transform=`translate(${d.offset},0)`,h.cssStyle["margin-top"]=`calc(${p.offset} - ${c.top})`,h.cssStyle["shape-outside"]=`inset(calc(${p.offset} - ${c.top}) 0 0 0)`,h.cssStyle["box-sizing"]="content-box",h.cssStyle["padding-top"]=c.top,h.cssStyle["padding-bottom"]=c.bottom;break;case A.None:switch(h.cssStyle.position="absolute",d.align){case"left":case"right":h.cssStyle[d.align]=d.offset;break;case"center":h.cssStyle.left="50%",h.cssStyle.transform="translateX(-50%)"}h.cssStyle.top=p.offset;break;case A.Square:switch(h.cssStyle.float="left"===e?"right":"left",h.cssStyle["margin-top"]=`calc(${p.offset} - ${c.top})`,h.cssStyle["shape-outside"]=`inset(calc(${p.offset} - ${c.top}) 0 0 0)`,e){case"left":switch(d.align){case"left":h.cssStyle["margin-right"]=`calc(100% - ${r.width} - ${d.offset} - ${c.right})`;break;case"right":h.cssStyle["margin-right"]=`calc(${d.offset} - ${c.right})`;break;case"center":h.cssStyle["margin-right"]=`calc( 50% - (${r.width} - ${d.offset}) / 2 - ${c.right} )`}break;case"right":switch(d.align){case"left":h.cssStyle["margin-left"]=`calc(${d.offset} - ${c.left})`;break;case"right":h.cssStyle["margin-left"]=`calc(100% - ${r.width} - ${d.offset} - ${c.left})`,h.cssStyle["margin-right"]=`calc(${d.offset} - ${c.right})`;break;case"center":h.cssStyle["margin-left"]=`calc( 50% - (${r.width} - ${d.offset} ) / 2 - ${c.left} )`}break;default:console.warn(`text wrap picture on ${e} is not supported！`)}h.cssStyle["box-sizing"]="content-box",h.cssStyle["padding-top"]=c.top,h.cssStyle["padding-bottom"]=c.bottom,h.cssStyle["padding-left"]=c.left,h.cssStyle["padding-right"]=c.right;break;case A.Through:case A.Tight:h.cssStyle.float="left"===e?"right":"left";let{polygonData:t}=h.props;switch(h.cssStyle["shape-outside"]=`polygon(${t})`,h.cssStyle["margin-top"]=p.offset,e){case"left":switch(d.align){case"left":h.cssStyle["margin-right"]=`calc(100% - ${r.width} - ${d.offset})`;break;case"right":h.cssStyle["margin-right"]=d.offset;break;case"center":h.cssStyle["margin-right"]=`calc( 50% - (${r.width} - ${d.offset}) / 2 )`}break;case"right":switch(d.align){case"left":h.cssStyle["margin-left"]=d.offset;break;case"right":h.cssStyle["margin-left"]=`calc(100% - ${r.width} - ${d.offset})`;break;case"center":h.cssStyle["margin-left"]=`calc( 50% - (${r.width} - ${d.offset} ) / 2 )`}break;default:console.warn(`text wrap picture on ${e} is not supported！`)}}}return h}parsePolygon(e,t){let r=[],{wrapText:a,distance:l,extent:i,posX:c,posY:h}=t.props;Ie.foreach(e,(e=>{let t,d,p,u,m,f,g=o.intAttr(e,"x",0),b=o.intAttr(e,"y",0);switch(a){case"left":switch(c.align){case"left":t=g*i.origin_width/21600-l.distL,d=b*i.origin_height/21600+h.origin,m=n(t,s.Emu)??"0pt",f=n(d,s.Emu)??"0pt";break;case"right":case"center":t=g*i.origin_width/21600+c.origin-l.distL,d=b*i.origin_height/21600+h.origin,m=n(t,s.Emu)??"0pt",f=n(d,s.Emu)??"0pt"}break;case"right":switch(c.align){case"left":t=g*i.origin_width/21600+c.origin+l.distR,d=b*i.origin_height/21600+h.origin,m=n(t,s.Emu)??"0pt",f=n(d,s.Emu)??"0pt";break;case"right":t=g*i.origin_width/21600+c.origin+l.distR,d=b*i.origin_height/21600+h.origin,p=n(t,s.Emu)??"0pt",u=n(d,s.Emu)??"0pt",m=`calc(100% + ${p} - ${i.width})`,f=u;break;case"center":t=g*i.origin_width/21600+c.origin+l.distR,d=b*i.origin_height/21600+h.origin,p=n(t,s.Emu)??"0pt",u=n(d,s.Emu)??"0pt",m=`calc(50% + ${p})`,f=u}break;default:console.warn(`text wrap picture on ${a} is not supported！`)}let y=`${m} ${f}`;r.push(y)})),t.props.polygonData=r.join(",")}parseGraphic(e){let t=o.element(e,"graphicData");for(let e of o.elements(t))switch(e.localName){case"wsp":return this.parseShape(e);case"pic":return this.parsePicture(e)}return null}parseShape(e){let t={type:T.Shape,cssStyle:{}};for(let r of o.elements(e))switch(r.localName){case"cNvPr":case"cNvSpPr":case"cNvCnPr":case"spPr":return this.parseShapeProperties(r,t)}return null}parseShapeProperties(e,t){for(let r of o.elements(e))if("xfrm"===r.localName){o.boolAttr(r,"flipH")&&(t.cssStyle.transform="scaleX(-1)"),o.boolAttr(r,"flipV")&&(t.cssStyle.transform="scaleY(-1)");let e=o.lengthAttr(r,"rot",s.degree);e&&(t.cssStyle.transform=`rotate(${e})`),this.parseTransform2D(r,t)}return null}parsePicture(e){let t={type:T.Image,src:"",cssStyle:{}};for(let r of o.elements(e))switch(r.localName){case"nvPicPr":break;case"blipFill":this.parseBlipFill(r,t);break;case"spPr":this.parseShapeProperties(r,t)}return t.cssStyle.position="relative",t}parseTransform2D(e,t){for(let r of o.elements(e))switch(r.localName){case"ext":t.cssStyle.width=o.lengthAttr(r,"cx",s.Emu),t.cssStyle.height=o.lengthAttr(r,"cy",s.Emu);break;case"off":t.cssStyle.left=o.lengthAttr(r,"x",s.Emu),t.cssStyle.top=o.lengthAttr(r,"y",s.Emu)}}parseBlipFill(e,t){for(let r of o.elements(e))if("blip"===r.localName)t.src=o.attr(r,"embed"),this.parseBlip(r,t)}parseBlip(e,t){for(let r of o.elements(e))switch(r.localName){case"alphaBiLevel":case"alphaCeiling":case"alphaFloor":case"alphaInv":case"alphaMod":break;case"alphaModFix":let e=o.lengthAttr(r,"amt",s.Opacity);t.cssStyle.opacity=e;break;default:this.options.debug&&console.warn(`DOCX: Unknown document element: ${r.localName}`)}}parseTable(e){let t={type:T.Table,children:[]};return Ie.foreach(e,(e=>{switch(e.localName){case"tr":t.children.push(this.parseTableRow(e));break;case"tblGrid":t.columns=this.parseTableColumns(e);break;case"tblPr":this.parseTableProperties(e,t)}})),t}parseTableColumns(e){let t=[];return Ie.foreach(e,(e=>{if("gridCol"===e.localName)t.push({width:o.lengthAttr(e,"w")})})),t}parseTableProperties(e,t){switch(t.cssStyle={},t.cellStyle={},this.parseDefaultProperties(e,t.cssStyle,t.cellStyle,(e=>{switch(e.localName){case"tblStyle":t.styleName=o.attr(e,"val");break;case"tblLook":t.className=_e.classNameOftblLook(e);break;case"tblpPr":this.parseTablePosition(e,t);break;case"tblStyleColBandSize":t.colBandSize=o.intAttr(e,"val");break;case"tblStyleRowBandSize":t.rowBandSize=o.intAttr(e,"val");break;default:return!1}return!0})),t.cssStyle["text-align"]){case"center":delete t.cssStyle["text-align"],t.cssStyle["margin-left"]="auto",t.cssStyle["margin-right"]="auto";break;case"right":delete t.cssStyle["text-align"],t.cssStyle["margin-left"]="auto"}}parseTablePosition(e,t){if(this.options.ignoreTableWrap)return!1;let r=o.lengthAttr(e,"topFromText"),a=o.lengthAttr(e,"bottomFromText"),s=o.lengthAttr(e,"rightFromText"),n=o.lengthAttr(e,"leftFromText");t.cssStyle.float="left",t.cssStyle["margin-bottom"]=_e.addSize(t.cssStyle["margin-bottom"],a),t.cssStyle["margin-left"]=_e.addSize(t.cssStyle["margin-left"],n),t.cssStyle["margin-right"]=_e.addSize(t.cssStyle["margin-right"],s),t.cssStyle["margin-top"]=_e.addSize(t.cssStyle["margin-top"],r)}parseTableRow(e){let t={type:T.Row,children:[]};return Ie.foreach(e,(e=>{switch(e.localName){case"tc":t.children.push(this.parseTableCell(e));break;case"trPr":this.parseTableRowProperties(e,t)}})),t}parseTableRowProperties(e,t){t.cssStyle=this.parseDefaultProperties(e,{},null,(e=>{switch(e.localName){case"cnfStyle":t.className=_e.classNameOfCnfStyle(e);break;case"tblHeader":t.isHeader=o.boolAttr(e,"val",!0);break;default:return!1}return!0}))}parseTableCell(e){let t={type:T.Cell,children:[]};return Ie.foreach(e,(e=>{switch(e.localName){case"tbl":t.children.push(this.parseTable(e));break;case"p":t.children.push(this.parseParagraph(e));break;case"tcPr":this.parseTableCellProperties(e,t)}})),t}parseTableCellProperties(e,t){t.cssStyle=this.parseDefaultProperties(e,{},null,(e=>{switch(e.localName){case"gridSpan":t.span=o.intAttr(e,"val",null);break;case"vMerge":t.verticalMerge=o.attr(e,"val")??"continue";break;case"cnfStyle":t.className=_e.classNameOfCnfStyle(e);break;default:return!1}return!0}))}parseDefaultProperties(e,t=null,r=null,a=null){return t=t||{},Ie.foreach(e,(n=>{if(!a?.(n))switch(n.localName){case"jc":t["text-align"]=_e.valueOfJc(n);break;case"textAlignment":case"vAlign":t["vertical-align"]=_e.valueOfTextAlignment(n);break;case"color":t.color=Ie.colorAttr(n,"val",null,Te);break;case"sz":t["font-size"]=t["min-height"]=o.lengthAttr(n,"val",s.FontSize);break;case"shd":t["background-color"]=Ie.colorAttr(n,"fill",null,Me);break;case"highlight":t["background-color"]=Ie.colorAttr(n,"val",null,Ee);break;case"vertAlign":case"kern":case"noWrap":case"bCs":case"iCs":case"szCs":case"tabs":case"outlineLvl":case"contextualSpacing":case"tblStyleColBandSize":case"tblStyleRowBandSize":case"webHidden":case"pageBreakBefore":case"suppressLineNumbers":case"keepLines":case"keepNext":case"widowControl":case"bidi":case"rtl":case"noProof":break;case"position":t.verticalAlign=o.lengthAttr(n,"val",s.FontSize);break;case"tcW":this.options.ignoreWidth;break;case"tblW":t.width=_e.valueOfSize(n,"w");break;case"trHeight":this.parseTrHeight(n,t);break;case"strike":t["text-decoration"]=o.boolAttr(n,"val",!0)?"line-through":"none";break;case"b":t["font-weight"]=o.boolAttr(n,"val",!0)?"bold":"normal";break;case"i":t["font-style"]=o.boolAttr(n,"val",!0)?"italic":"normal";break;case"caps":t["text-transform"]=o.boolAttr(n,"val",!0)?"uppercase":"none";break;case"smallCaps":t["font-variant"]=o.boolAttr(n,"val",!0)?"small-caps":"none";break;case"u":this.parseUnderline(n,t);break;case"ind":case"tblInd":this.parseIndentation(n,t);break;case"rFonts":this.parseFont(n,t);break;case"tblBorders":this.parseBorderProperties(n,r||t);break;case"tblCellSpacing":t["border-spacing"]=_e.valueOfMargin(n),t["border-collapse"]="separate";break;case"pBdr":case"tcBorders":this.parseBorderProperties(n,t);break;case"bdr":t.border=_e.valueOfBorder(n);break;case"vanish":o.boolAttr(n,"val",!0)&&(t.display="none");break;case"tblCellMar":case"tcMar":this.parseMarginProperties(n,r||t);break;case"tblLayout":t["table-layout"]=_e.valueOfTblLayout(n);break;case"spacing":"pPr"==e.localName&&this.parseSpacing(n,t);break;case"wordWrap":o.boolAttr(n,"val")&&(t["overflow-wrap"]="break-word");break;case"suppressAutoHyphens":t.hyphens=o.boolAttr(n,"val",!0)?"none":"auto";break;case"lang":t.$lang=o.attr(n,"val");break;default:this.options.debug&&console.warn(`DOCX: Unknown document element: ${e.localName}.${n.localName}`)}})),t}parseUnderline(e,t){let r=o.attr(e,"val");if(null==r)return;switch(r){case"dash":case"dashDotDotHeavy":case"dashDotHeavy":case"dashedHeavy":case"dashLong":case"dashLongHeavy":case"dotDash":case"dotDotDash":t["text-decoration"]="underline dashed";break;case"dotted":case"dottedHeavy":t["text-decoration"]="underline dotted";break;case"double":t["text-decoration"]="underline double";break;case"single":case"thick":case"words":t["text-decoration"]="underline";break;case"wave":case"wavyDouble":case"wavyHeavy":t["text-decoration"]="underline wavy";break;case"none":t["text-decoration"]="none"}let a=Ie.colorAttr(e,"color");a&&(t["text-decoration-color"]=a)}parseFont(e,t){let r=[],a=o.attr(e,"ascii"),s=_e.themeValue(e,"asciiTheme");r.push(a,s);let n=o.attr(e,"eastAsia"),l=_e.themeValue(e,"eastAsiaTheme");r.push(n,l);let i=o.attr(e,"cs"),c=_e.themeValue(e,"cstheme");r.push(i,c);let h=o.attr(e,"hAnsi"),d=_e.themeValue(e,"hAnsiTheme");r.push(h,d);let p=[...new Set(r)].filter((e=>e)).join(", ");r.length>0&&(t["font-family"]=p),t._hint=o.attr(e,"hint")}parseIndentation(e,t){let r=o.lengthAttr(e,"firstLine"),a=o.lengthAttr(e,"hanging"),s=o.lengthAttr(e,"left"),n=o.lengthAttr(e,"start"),l=o.lengthAttr(e,"right"),i=o.lengthAttr(e,"end");r&&(t["text-indent"]=r),a&&(t["text-indent"]=`-${a}`),(s||n)&&(t["padding-left"]=s||n),(l||i)&&(t["padding-right"]=l||i)}parseSpacing(e,t){let r=o.lengthAttr(e,"before"),a=o.lengthAttr(e,"after"),s=o.intAttr(e,"line",null),n=o.attr(e,"lineRule");if(r&&(t["margin-top"]=r),a&&(t["margin-bottom"]=a),null!==s)switch(n){case"auto":t["line-height"]=`${(s/240).toFixed(2)}`;break;case"atLeast":t["line-height"]=`calc(100% + ${s/20}pt)`;break;case"Exact":t["line-height"]=s/20+"pt";break;default:t["line-height"]=t["min-height"]=s/20+"pt"}}parseMarginProperties(e,t){Ie.foreach(e,(e=>{switch(e.localName){case"left":t["padding-left"]=_e.valueOfMargin(e);break;case"right":t["padding-right"]=_e.valueOfMargin(e);break;case"top":t["padding-top"]=_e.valueOfMargin(e);break;case"bottom":t["padding-bottom"]=_e.valueOfMargin(e)}}))}parseTrHeight(e,t){o.attr(e,"hRule"),t.height=o.lengthAttr(e,"val")}parseBorderProperties(e,t){Ie.foreach(e,(e=>{switch(e.localName){case"start":case"left":t["border-left"]=_e.valueOfBorder(e);break;case"end":case"right":t["border-right"]=_e.valueOfBorder(e);break;case"top":t["border-top"]=_e.valueOfBorder(e);break;case"bottom":t["border-bottom"]=_e.valueOfBorder(e)}}))}}const Fe=["black","blue","cyan","darkBlue","darkCyan","darkGray","darkGreen","darkMagenta","darkRed","darkYellow","green","lightGray","magenta","none","red","white","yellow"];class Ie{static foreach(e,t){for(let r=0;r<e.childNodes.length;r++){let a=e.childNodes[r];a.nodeType==Node.ELEMENT_NODE&&t(a)}}static colorAttr(e,t,r=null,a="black"){let s=o.attr(e,t);if(s)return"auto"==s?a:Fe.includes(s)?s:`#${s}`;let n=o.attr(e,"themeColor");return n?`var(--docx-${n}-color)`:r}static sizeValue(e,t=s.Dxa){return n(e.textContent,t)}static text_to_int(e,t=0){let r=e.textContent;return r?parseInt(r):t}}class _e{static themeValue(e,t){let r=o.attr(e,t);return r?`var(--docx-${r}-font)`:null}static valueOfSize(e,t){let r=s.Dxa;switch(o.attr(e,"type")){case"dxa":break;case"pct":r=s.Percent;break;case"auto":return"auto"}return o.lengthAttr(e,t,r)}static valueOfMargin(e){return o.lengthAttr(e,"w")}static valueOfBorder(e){if("nil"==o.attr(e,"val"))return"none";let t=Ie.colorAttr(e,"color");return`${o.lengthAttr(e,"sz",s.Border)} solid ${"auto"==t?Ae:t}`}static valueOfTblLayout(e){return"fixed"==o.attr(e,"val")?"fixed":"auto"}static classNameOfCnfStyle(e){const t=o.attr(e,"val");return["first-row","last-row","first-col","last-col","odd-col","even-col","odd-row","even-row","ne-cell","nw-cell","se-cell","sw-cell"].filter(((e,r)=>"1"==t[r])).join(" ")}static valueOfJc(e){let t=o.attr(e,"val");switch(t){case"start":case"left":return"left";case"center":return"center";case"end":case"right":return"right";case"both":return"justify"}return t}static valueOfVertAlign(e,t=!1){let r=o.attr(e,"val");switch(r){case"subscript":return"sub";case"superscript":return t?"sup":"super"}return t?null:r}static valueOfTextAlignment(e){let t=o.attr(e,"val");switch(t){case"auto":case"baseline":return"baseline";case"top":return"top";case"center":return"middle";case"bottom":return"bottom"}return t}static addSize(e,t){return null==e?t:null==t?e:`calc(${e} + ${t})`}static classNameOftblLook(e){const t=o.hexAttr(e,"val",0);let r="";return(o.boolAttr(e,"firstRow")||32&t)&&(r+=" first-row"),(o.boolAttr(e,"lastRow")||64&t)&&(r+=" last-row"),(o.boolAttr(e,"firstColumn")||128&t)&&(r+=" first-col"),(o.boolAttr(e,"lastColumn")||256&t)&&(r+=" last-col"),(o.boolAttr(e,"noHBand")||512&t)&&(r+=" no-hband"),(o.boolAttr(e,"noVBand")||1024&t)&&(r+=" no-vband"),r.trim()}}const Le={pos:0,leader:"none",style:"left"};function He(e=document.body){const t=document.createElement("div");t.style.width="100pt",e.appendChild(t);const r=100/t.offsetWidth;return e.removeChild(t),r}function Ve(e,t,r,a=.75){const s=e.closest("p"),n=e.getBoundingClientRect(),l=s.getBoundingClientRect(),i=getComputedStyle(s),o=t?.length>0?t.map((e=>({pos:Oe(e.position),leader:e.leader,style:e.style}))).sort(((e,t)=>e.pos-t.pos)):[Le],c=o[o.length-1],h=l.width*a,d=Oe(r);let p=c.pos+d;if(p<h)for(;p<h&&o.length<50;p+=d)o.push({...Le,pos:p});const u=parseFloat(i.marginLeft),m=l.left+u,f=(n.left-m)*a,g=o.find((e=>"clear"!=e.style&&e.pos>f));if(null==g)return;let b=1;if("right"==g.style||"center"==g.style){const t=Array.from(s.querySelectorAll(`.${e.className}`)),r=t.indexOf(e)+1,n=document.createRange();n.setStart(e,1),r<t.length?n.setEndBefore(t[r]):n.setEndAfter(s);const i="center"==g.style?.5:1,o=n.getBoundingClientRect(),c=o.left+i*o.width-(l.left-u);b=g.pos-c*a}else b=g.pos-f;switch(e.innerHTML="&nbsp;",e.style.textDecoration="inherit",e.style.wordSpacing=`${b.toFixed(0)}pt`,g.leader){case"dot":case"middleDot":e.style.textDecoration="underline",e.style.textDecorationStyle="dotted";break;case"hyphen":case"heavy":case"underscore":e.style.textDecoration="underline"}}function Oe(e){return parseFloat(e)}const je="http://www.w3.org/2000/svg",ze="http://www.w3.org/1998/Math/MathML";class We{constructor(){this.className="docx",this.styleMap={},this.currentPart=null,this.tableVerticalMerges=[],this.currentVerticalMerge=null,this.tableCellPositions=[],this.currentCellPosition=null,this.footnoteMap={},this.endnoteMap={},this.currentEndnoteIds=[],this.usedHederFooterParts=[],this.currentTabs=[],this.tabsTimeout=0}render(e,t,r=null,a){this.document=e,this.options=a,this.className=a.className,this.rootSelector=a.inWrapper?`.${this.className}-wrapper`:":root",this.styleMap=null,Ge(r=r||t),Ge(t),Ye(r,"docxjs library predefined styles"),r.appendChild(this.renderDefaultStyle()),e.themePart&&(Ye(r,"docxjs document theme values"),this.renderTheme(e.themePart,r)),null!=e.stylesPart&&(this.styleMap=this.processStyles(e.stylesPart.styles),Ye(r,"docxjs document styles"),r.appendChild(this.renderStyles(e.stylesPart.styles))),e.numberingPart&&(this.processNumberings(e.numberingPart.domNumberings),Ye(r,"docxjs document numbering styles"),r.appendChild(this.renderNumbering(e.numberingPart.domNumberings,r))),!a.ignoreFonts&&e.fontTablePart&&this.renderFontTable(e.fontTablePart,r),e.footnotesPart&&(this.footnoteMap=b(e.footnotesPart.notes,(e=>e.id))),e.endnotesPart&&(this.endnoteMap=b(e.endnotesPart.notes,(e=>e.id))),e.settingsPart&&(this.defaultTabSize=e.settingsPart.settings?.defaultTabStop);let s=this.renderSections(e.documentPart.body);this.options.inWrapper?t.appendChild(this.renderWrapper(s)):Je(t,s),this.refreshTabStops()}renderDefaultStyle(){let e=this.className;return Ze(`\n\t\t\t.${e}-wrapper { background: gray; padding: 30px; padding-bottom: 0px; display: flex; flex-flow: column; align-items: center; } \n\t\t\t.${e}-wrapper>section.${e} { background: white; box-shadow: 0 0 10px rgba(0, 0, 0, 0.5); margin-bottom: 30px; }\n\t\t\t.${e} { color: black; hyphens: auto; }\n\t\t\tsection.${e} { box-sizing: border-box; display: flex; flex-flow: column nowrap; position: relative; overflow: hidden; }\n            section.${e}>header { position: absolute; top: 0; z-index: 1; display: flex; align-items: flex-end; }\n\t\t\tsection.${e}>article { z-index: 1; }\n\t\t\tsection.${e}>footer { position: absolute; bottom: 0; z-index: 1; }\n\t\t\t.${e} table { border-collapse: collapse; }\n\t\t\t.${e} table td, .${e} table th { vertical-align: top; }\n\t\t\t.${e} p { margin: 0pt; min-height: 1em; }\n\t\t\t.${e} span { white-space: pre-wrap; overflow-wrap: break-word; }\n\t\t\t.${e} a { color: inherit; text-decoration: inherit; }\n\t\t`)}renderTheme(e,t){const r={},a=e.theme?.fontScheme;a&&(a.majorFont&&(r["--docx-majorHAnsi-font"]=a.majorFont.latinTypeface),a.minorFont&&(r["--docx-minorHAnsi-font"]=a.minorFont.latinTypeface));const s=e.theme?.colorScheme;if(s)for(let[e,t]of Object.entries(s.colors))r[`--docx-${e}-color`]=`#${t}`;const n=this.styleToString(`.${this.className}`,r);t.appendChild(Ze(n))}processStyleName(e){return e?`${this.className}_${m(e)}`:this.className}processStyles(e){const t=b(e.filter((e=>null!=e.id)),(e=>e.id));for(const r of e.filter((e=>e.basedOn))){let e=t[r.basedOn];if(e){r.paragraphProps=w(r.paragraphProps,e.paragraphProps),r.runProps=w(r.runProps,e.runProps);for(const t of e.styles){const e=r.styles.find((e=>e.target==t.target));e?this.copyStyleProperties(t.values,e.values):r.styles.push({...t,values:{...t.values}})}}else this.options.debug&&console.warn(`Can't find base style ${r.basedOn}`)}for(let t of e)t.cssName=this.processStyleName(t.id);return t}renderStyles(e){let t="";const r=this.styleMap,a=b(e.filter((e=>e.isDefault)),(e=>e.target));for(const s of e){let e=s.styles;if(s.linked){let t=s.linked&&r[s.linked];t?e=e.concat(t.styles):this.options.debug&&console.warn(`Can't find linked style ${s.linked}`)}for(const r of e){let e=`${s.target??""}.${s.cssName}`;s.target!=r.target&&(e+=` ${r.target}`),a[s.target]==s&&(e=`.${this.className} ${s.target}, `+e),t+=this.styleToString(e,r.values)}}return Ze(t)}processNumberings(e){for(let t of e.filter((e=>e.pStyleName))){const e=this.findStyle(t.pStyleName);e?.paragraphProps?.numbering&&(e.paragraphProps.numbering.level=t.level)}}renderNumbering(e,t){let r="",a=[];for(let s of e){let e=`p.${this.numberingClass(s.id,s.level)}`,n="none";if(s.bullet){let a=`--${this.className}-${s.bullet.src}`.toLowerCase();r+=this.styleToString(`${e}:before`,{content:"' '",display:"inline-block",background:`var(${a})`},s.bullet.style),this.document.loadNumberingImage(s.bullet.src).then((e=>{let r=`${this.rootSelector} { ${a}: url(${e}) }`;t.appendChild(Ze(r))}))}else if(s.levelText){let t=this.numberingCounter(s.id,s.level);const n=t+" "+(s.start-1);s.level>0&&(r+=this.styleToString(`p.${this.numberingClass(s.id,s.level-1)}`,{"counter-reset":n})),a.push(n),r+=this.styleToString(`${e}:before`,{content:this.levelTextToContent(s.levelText,s.suff,s.id,this.numFormatToCssValue(s.format)),"counter-increment":t,...s.rStyle})}else n=this.numFormatToCssValue(s.format);r+=this.styleToString(e,{display:"list-item","list-style-position":"inside","list-style-type":n,...s.pStyle})}return a.length>0&&(r+=this.styleToString(this.rootSelector,{"counter-reset":a.join(" ")})),Ze(r)}numberingClass(e,t){return`${this.className}-num-${e}-${t}`}styleToString(e,t,r=null){let a=`${e} {\r\n`;for(const e in t)e.startsWith("$")||(a+=`  ${e}: ${t[e]};\r\n`);return r&&(a+=r),a+"}\r\n"}numberingCounter(e,t){return`${this.className}-num-${e}-${t}`}levelTextToContent(e,t,r,a){return`"${e.replace(/%\d*/g,(e=>{let t=parseInt(e.substring(1),10)-1;return`"counter(${this.numberingCounter(r,t)}, ${a})"`}))}${{tab:"\\9",space:"\\a0"}[t]??""}"`}numFormatToCssValue(e){return{none:"none",bullet:"disc",decimal:"decimal",lowerLetter:"lower-alpha",upperLetter:"upper-alpha",lowerRoman:"lower-roman",upperRoman:"upper-roman",decimalZero:"decimal-leading-zero",aiueo:"katakana",aiueoFullWidth:"katakana",chineseCounting:"simp-chinese-informal",chineseCountingThousand:"simp-chinese-informal",chineseLegalSimplified:"simp-chinese-formal",chosung:"hangul-consonant",ideographDigital:"cjk-ideographic",ideographTraditional:"cjk-heavenly-stem",ideographLegalTraditional:"trad-chinese-formal",ideographZodiac:"cjk-earthly-branch",iroha:"katakana-iroha",irohaFullWidth:"katakana-iroha",japaneseCounting:"japanese-informal",japaneseDigitalTenThousand:"cjk-decimal",japaneseLegal:"japanese-formal",thaiNumbers:"thai",koreanCounting:"korean-hangul-formal",koreanDigital:"korean-hangul-formal",koreanDigital2:"korean-hanja-informal",hebrew1:"hebrew",hebrew2:"hebrew",hindiNumbers:"devanagari",ganada:"hangul",taiwaneseCounting:"cjk-ideographic",taiwaneseCountingThousand:"cjk-ideographic",taiwaneseDigital:"cjk-decimal"}[e]??e}renderFontTable(e,t){for(let r of e.fonts)for(let e of r.embedFontRefs)this.document.loadFont(e.id,e.key).then((a=>{const s={"font-family":r.name,src:`url(${a})`};"bold"!=e.type&&"boldItalic"!=e.type||(s["font-weight"]="bold"),"italic"!=e.type&&"boldItalic"!=e.type||(s["font-style"]="italic"),Ye(t,`docxjs ${r.name} font`);const n=this.styleToString("@font-face",s);t.appendChild(Ze(n)),this.refreshTabStops()}))}renderWrapper(e){return Ue("div",{className:`${this.className}-wrapper`},e)}copyStyleProperties(e,t,r=null){if(!e)return t;null==t&&(t={}),null==r&&(r=Object.getOwnPropertyNames(e));for(let a of r)e.hasOwnProperty(a)&&!t.hasOwnProperty(a)&&(t[a]=e[a]);return t}processElement(e){if(e.children)for(let t of e.children)t.parent=e,t.type==T.Table?this.processTable(t):this.processElement(t)}processTable(e){for(let t of e.children)for(let r of t.children)r.cssStyle=this.copyStyleProperties(e.cellStyle,r.cssStyle,["border-left","border-right","border-top","border-bottom","padding-left","padding-right","padding-top","padding-bottom"]),this.processElement(r)}splitBySection(e){let t={sectProps:null,elements:[],is_split:!1},r=[t];for(let a of e){if(t.elements.push(a),a.type==T.Paragraph){const e=a;let s=e.sectionProps;const n=this.findStyle(e.styleName);n?.paragraphProps?.pageBreakBefore&&(t.is_split=!0,t.sectProps=s,t={sectProps:null,elements:[],is_split:!1},r.push(t));let l=-1,i=-1;if(e.children&&(l=e.children.findIndex((e=>(i=e.children?.findIndex((e=>e.type==T.Break&&("lastRenderedPageBreak"==e.break?t.elements.length>1||!this.options.ignoreLastRenderedPageBreak:"page"===e.break||void 0))),i=i??-1,-1!=i)))),(s||-1!=l)&&(t.is_split=!0,t.sectProps=s,t={sectProps:null,elements:[],is_split:!1},r.push(t)),-1!=l){let r=e.children[l],a=i<r.children.length-1;if(l<e.children.length-1||a){let s=e.children,n={...e,children:s.slice(l)};if(e.children=s.slice(0,l),t.elements.push(n),a){let t=r.children,a={...r,children:t.slice(0,i)};e.children.push(a),r.children=t.slice(i)}}}}a.type,T.Table}let a=null;for(let e=r.length-1;e>=0;e--)null==r[e].sectProps?r[e].sectProps=a:a=r[e].sectProps;return r}renderSections(e){const t=[];let r;this.processElement(e),r=this.options.breakPages?this.splitBySection(e.children):[{sectProps:e.props,elements:e.children,is_split:!1}];let a=null;for(let s=0,n=r.length;s<n;s++){this.currentFootnoteIds=[];const l=r[s],i=l.sectProps||e.props;let o=t.length,c=a!=i,h=s===n-1,d=this.renderSection(l,i,e.cssStyle,o,c,h);t.push(...d),a=i}return t}renderSection(e,t,r,a,s,n){const l=this.createSection(this.className,t);this.renderStyleValues(r,l),this.options.renderHeaders&&this.renderHeaderFooterRef(t.headerRefs,t,a,s,l);let i=Ue("article");return this.options.breakPages&&(i.style.minHeight=t.contentSize.height),this.renderElements(e.elements,i),l.appendChild(i),this.options.renderFootnotes&&this.renderNotes(this.currentFootnoteIds,this.footnoteMap,l),this.options.renderEndnotes&&n&&this.renderNotes(this.currentEndnoteIds,this.endnoteMap,l),this.options.renderFooters&&this.renderHeaderFooterRef(t.footerRefs,t,a,s,l),[l]}createSection(e,t){let r=Ue("section",{className:e});return t&&(t.pageMargins&&(r.style.paddingLeft=t.pageMargins.left,r.style.paddingRight=t.pageMargins.right,r.style.paddingTop=t.pageMargins.top,r.style.paddingBottom=t.pageMargins.bottom),t.pageSize&&(this.options.ignoreWidth||(r.style.width=t.pageSize.width),this.options.ignoreHeight||(r.style.minHeight=t.pageSize.height)),t.columns&&t.columns.numberOfColumns&&(r.style.columnCount=`${t.columns.numberOfColumns}`,r.style.columnGap=t.columns.space,t.columns.separator&&(r.style.columnRule="1px solid black"))),r}renderHeaderFooterRef(e,t,r,a,s){if(!e)return;let n=(t.titlePage&&a?e.find((e=>"first"==e.type)):null)??(r%2==1?e.find((e=>"even"==e.type)):null)??e.find((e=>"default"==e.type)),l=n&&this.document.findPartByRelId(n.id,this.document.documentPart);if(l){switch(this.currentPart=l,this.usedHederFooterParts.includes(l.path)||(this.processElement(l.rootElement),this.usedHederFooterParts.push(l.path)),l.rootElement.type){case T.Header:l.rootElement.cssStyle={left:t.pageMargins?.left,width:t.contentSize?.width,height:t.pageMargins?.top};break;case T.Footer:l.rootElement.cssStyle={left:t.pageMargins?.left,width:t.contentSize?.width,height:t.pageMargins?.bottom};break;default:console.warn("set header/footer style error",l.rootElement.type)}this.renderElements([l.rootElement],s),this.currentPart=null}}renderNotes(e,t,r){let a=e.map((e=>t[e])).filter((e=>e));if(a.length>0){let e=Ue("ol",null,this.renderElements(a));r.appendChild(e)}}renderElements(e,t){if(null==e)return null;let r=[];for(let t=0;t<e.length;t++){let a=this.renderElement(e[t]);Array.isArray(a)?r.push(...a):a&&r.push(a)}return t&&Je(t,r),r}renderElement(e){switch(e.type){case T.Paragraph:return this.renderParagraph(e);case T.BookmarkStart:return this.renderBookmarkStart(e);case T.BookmarkEnd:return null;case T.Run:return this.renderRun(e);case T.Table:return this.renderTable(e);case T.Row:return this.renderTableRow(e);case T.Cell:return this.renderTableCell(e);case T.Hyperlink:return this.renderHyperlink(e);case T.Drawing:return this.renderDrawing(e);case T.Image:return this.renderImage(e);case T.Text:return this.renderText(e);case T.DeletedText:return this.renderDeletedText(e);case T.Tab:return this.renderTab(e);case T.Symbol:return this.renderSymbol(e);case T.Break:return this.renderBreak(e);case T.Footer:return this.renderHeaderFooter(e,"footer");case T.Header:return this.renderHeaderFooter(e,"header");case T.Footnote:case T.Endnote:return this.renderContainer(e,"li");case T.FootnoteReference:return this.renderFootnoteReference(e);case T.EndnoteReference:return this.renderEndnoteReference(e);case T.NoBreakHyphen:return Ue("wbr");case T.VmlPicture:return this.renderVmlPicture(e);case T.VmlElement:return this.renderVmlElement(e);case T.MmlMath:return this.renderContainerNS(e,ze,"math",{xmlns:ze});case T.MmlMathParagraph:return this.renderContainer(e,"span");case T.MmlFraction:return this.renderContainerNS(e,ze,"mfrac");case T.MmlBase:return this.renderContainerNS(e,ze,e.parent.type==T.MmlMatrixRow?"mtd":"mrow");case T.MmlNumerator:case T.MmlDenominator:case T.MmlFunction:case T.MmlLimit:case T.MmlBox:return this.renderContainerNS(e,ze,"mrow");case T.MmlGroupChar:return this.renderMmlGroupChar(e);case T.MmlLimitLower:return this.renderContainerNS(e,ze,"munder");case T.MmlMatrix:return this.renderContainerNS(e,ze,"mtable");case T.MmlMatrixRow:return this.renderContainerNS(e,ze,"mtr");case T.MmlRadical:return this.renderMmlRadical(e);case T.MmlSuperscript:return this.renderContainerNS(e,ze,"msup");case T.MmlSubscript:return this.renderContainerNS(e,ze,"msub");case T.MmlDegree:case T.MmlSuperArgument:case T.MmlSubArgument:return this.renderContainerNS(e,ze,"mn");case T.MmlFunctionName:return this.renderContainerNS(e,ze,"ms");case T.MmlDelimiter:return this.renderMmlDelimiter(e);case T.MmlRun:return this.renderMmlRun(e);case T.MmlNary:return this.renderMmlNary(e);case T.MmlPreSubSuper:return this.renderMmlPreSubSuper(e);case T.MmlBar:return this.renderMmlBar(e);case T.MmlEquationArray:return this.renderMllList(e);case T.Inserted:return this.renderInserted(e);case T.Deleted:return this.renderDeleted(e)}return null}isPageBreakElement(e){return e.type==T.Break&&("lastRenderedPageBreak"==e.break?!this.options.ignoreLastRenderedPageBreak:"page"===e.break||void 0)}renderChildren(e,t){return this.renderElements(e.children,t)}renderContainer(e,t,r){return Ue(t,r,this.renderChildren(e))}renderContainerNS(e,t,r,a){return qe(t,r,a,this.renderChildren(e))}renderParagraph(e){let t=Ue("p");const r=this.findStyle(e.styleName);e.tabs??(e.tabs=r?.paragraphProps?.tabs),this.renderClass(e,t),this.renderChildren(e,t),this.renderStyleValues(e.cssStyle,t),this.renderCommonProperties(t.style,e);const a=e.numbering??r?.paragraphProps?.numbering;return a&&t.classList.add(this.numberingClass(a.id,a.level)),t}renderRun(e){if(e.fieldRun)return null;const t=Ue("span");if(e.id&&(t.id=e.id),this.renderClass(e,t),this.renderStyleValues(e.cssStyle,t),e.verticalAlign){const r=Ue(e.verticalAlign);this.renderChildren(e,r),t.appendChild(r)}else this.renderChildren(e,t);return t}renderText(e){return document.createTextNode(e.text)}renderHyperlink(e){let t=Ue("a");if(this.renderChildren(e,t),this.renderStyleValues(e.cssStyle,t),e.href)t.href=e.href;else if(e.id){const r=this.document.documentPart.rels.find((t=>t.id==e.id&&"External"===t.targetMode));t.href=r?.target}return t}renderDrawing(e){let t=Ue("div");return t.style.display="inline-block",t.style.position="relative",t.style.textIndent="0px",this.renderChildren(e,t),this.renderStyleValues(e.cssStyle,t),t}renderImage(e){let t=Ue("img");return this.renderStyleValues(e.cssStyle,t),this.document&&this.document.loadDocumentImage(e.src,this.currentPart).then((e=>{t.src=e})),t}renderDeletedText(e){return this.options.renderEndnotes?document.createTextNode(e.text):null}renderBreak(e){return"textWrapping"==e.break?Ue("br"):null}renderInserted(e){return this.options.renderChanges?this.renderContainer(e,"ins"):this.renderChildren(e)}renderDeleted(e){return this.options.renderChanges?this.renderContainer(e,"del"):null}renderSymbol(e){let t=Ue("span");return t.style.fontFamily=e.font,t.innerHTML=`&#x${e.char};`,t}renderHeaderFooter(e,t){let r=Ue(t);return this.renderChildren(e,r),this.renderStyleValues(e.cssStyle,r),r}renderFootnoteReference(e){let t=Ue("sup");return this.currentFootnoteIds.push(e.id),t.textContent=`${this.currentFootnoteIds.length}`,t}renderEndnoteReference(e){let t=Ue("sup");return this.currentEndnoteIds.push(e.id),t.textContent=`${this.currentEndnoteIds.length}`,t}renderTab(e){let t=Ue("span");if(t.innerHTML="&emsp;",this.options.experimental){t.className=this.tabStopClass();let r=function(e,t){let r=e.parent;for(;null!=r&&r.type!=t;)r=r.parent;return r}(e,T.Paragraph)?.tabs;this.currentTabs.push({stops:r,span:t})}return t}renderBookmarkStart(e){let t=Ue("span");return t.id=e.name,t}renderTable(e){let t=Ue("table");return this.tableCellPositions.push(this.currentCellPosition),this.tableVerticalMerges.push(this.currentVerticalMerge),this.currentVerticalMerge={},this.currentCellPosition={col:0,row:0},e.columns&&t.appendChild(this.renderTableColumns(e.columns)),this.renderClass(e,t),this.renderChildren(e,t),this.renderStyleValues(e.cssStyle,t),this.currentVerticalMerge=this.tableVerticalMerges.pop(),this.currentCellPosition=this.tableCellPositions.pop(),t}renderTableColumns(e){let t=Ue("colgroup");for(let r of e){let e=Ue("col");r.width&&(e.style.width=r.width),t.appendChild(e)}return t}renderTableRow(e){let t=Ue("tr");return this.currentCellPosition.col=0,this.renderClass(e,t),this.renderChildren(e,t),this.renderStyleValues(e.cssStyle,t),this.currentCellPosition.row++,t}renderTableCell(e){let t=Ue("td");const r=this.currentCellPosition.col;return e.verticalMerge?"restart"==e.verticalMerge?(this.currentVerticalMerge[r]=t,t.rowSpan=1):this.currentVerticalMerge[r]&&(this.currentVerticalMerge[r].rowSpan+=1,t.style.display="none"):this.currentVerticalMerge[r]=null,this.renderClass(e,t),this.renderChildren(e,t),this.renderStyleValues(e.cssStyle,t),e.span&&(t.colSpan=e.span),this.currentCellPosition.col+=t.colSpan,t}renderVmlPicture(e){let t=Ue("div");return this.renderChildren(e,t),t}renderVmlElement(e){let t=Xe("svg");t.setAttribute("style",e.cssStyleText);const r=this.renderVmlChildElement(e);return e.imageHref?.id&&this.document?.loadDocumentImage(e.imageHref.id,this.currentPart).then((e=>r.setAttribute("href",e))),t.appendChild(r),requestAnimationFrame((()=>{const e=t.firstElementChild.getBBox();t.setAttribute("width",`${Math.ceil(e.x+e.width)}`),t.setAttribute("height",`${Math.ceil(e.y+e.height)}`)})),t}renderVmlChildElement(e){const t=Xe(e.tagName);Object.entries(e.attrs).forEach((([e,r])=>t.setAttribute(e,r)));for(let r of e.children)r.type==T.VmlElement?t.appendChild(this.renderVmlChildElement(r)):t.append(...S(this.renderElement(r)));return t}renderMmlRadical(e){const t=e.children.find((e=>e.type==T.MmlBase));if(e.props?.hideDegree)return qe(ze,"msqrt",null,this.renderElements([t]));const r=e.children.find((e=>e.type==T.MmlDegree));return qe(ze,"mroot",null,this.renderElements([t,r]))}renderMmlDelimiter(e){const t=[];return t.push(qe(ze,"mo",null,[e.props.beginChar??"("])),t.push(...this.renderElements(e.children)),t.push(qe(ze,"mo",null,[e.props.endChar??")"])),qe(ze,"mrow",null,t)}renderMmlNary(e){const t=[],r=b(e.children,(e=>e.type)),a=r[T.MmlSuperArgument],s=r[T.MmlSubArgument],n=a?qe(ze,"mo",null,S(this.renderElement(a))):null,l=s?qe(ze,"mo",null,S(this.renderElement(s))):null,i=qe(ze,"mo",null,[e.props?.char??"∫"]);return n||l?t.push(qe(ze,"munderover",null,[i,l,n])):n?t.push(qe(ze,"mover",null,[i,n])):l?t.push(qe(ze,"munder",null,[i,l])):t.push(i),t.push(...this.renderElements(r[T.MmlBase].children)),qe(ze,"mrow",null,t)}renderMmlPreSubSuper(e){const t=[],r=b(e.children,(e=>e.type)),a=r[T.MmlSuperArgument],s=r[T.MmlSubArgument],n=a?qe(ze,"mo",null,S(this.renderElement(a))):null,l=s?qe(ze,"mo",null,S(this.renderElement(s))):null,i=qe(ze,"mo",null);return t.push(qe(ze,"msubsup",null,[i,l,n])),t.push(...this.renderElements(r[T.MmlBase].children)),qe(ze,"mrow",null,t)}renderMmlGroupChar(e){const t="bot"===e.props.verticalJustification?"mover":"munder",r=this.renderContainerNS(e,ze,t);return e.props.char&&r.appendChild(qe(ze,"mo",null,[e.props.char])),r}renderMmlBar(e){const t=this.renderContainerNS(e,ze,"mrow");switch(e.props.position){case"top":t.style.textDecoration="overline";break;case"bottom":t.style.textDecoration="underline"}return t}renderMmlRun(e){const t=qe(ze,"ms");return this.renderClass(e,t),this.renderStyleValues(e.cssStyle,t),this.renderChildren(e,t),t}renderMllList(e){const t=qe(ze,"mtable");this.renderClass(e,t),this.renderStyleValues(e.cssStyle,t);const r=this.renderChildren(e);for(let e of r)t.appendChild(qe(ze,"mtr",null,[qe(ze,"mtd",null,[e])]));return t}renderStyleValues(e,t){for(let r in e)r.startsWith("$")?t.setAttribute(r.slice(1),e[r]):t.style[r]=e[r]}renderRunProperties(e,t){this.renderCommonProperties(e,t)}renderCommonProperties(e,t){null!=t&&(t.color&&(e.color=t.color),t.fontSize&&(e["font-size"]=t.fontSize))}renderClass(e,t){e.className&&(t.className=e.className),e.styleName&&t.classList.add(this.processStyleName(e.styleName))}findStyle(e){return e&&this.styleMap?.[e]}tabStopClass(){return`${this.className}-tab-stop`}refreshTabStops(){this.options.experimental&&(clearTimeout(this.tabsTimeout),this.tabsTimeout=setTimeout((()=>{const e=He();for(let t of this.currentTabs)Ve(t.span,t.stops,this.defaultTabSize,e)}),500))}}function Ue(e,t,r){return qe(void 0,e,t,r)}function Xe(e,t,r){return qe(je,e,t,r)}function qe(e,t,r,a){let s=e?document.createElementNS(e,t):document.createElement(t);return Object.assign(s,r),a&&Je(s,a),s}function Ge(e){e.innerHTML=""}function Je(e,t){t.forEach((t=>{e.appendChild(k(t)?document.createTextNode(t):t)}))}function Ze(e){return Ue("style",{innerHTML:e})}function Ye(e,t){e.appendChild(document.createComment(t))}let Ke="http://www.w3.org/2000/svg",Qe="http://www.w3.org/1998/Math/MathML";var et;!function(e){e.TRUE="true",e.FALSE="false",e.UNKNOWN="undetected"}(et||(et={}));class tt{constructor(){this.className="docx",this.styleMap={},this.currentPart=null,this.tableVerticalMerges=[],this.currentVerticalMerge=null,this.tableCellPositions=[],this.currentCellPosition=null,this.footnoteMap={},this.endnoteMap={},this.currentEndnoteIds=[],this.usedHederFooterParts=[],this.currentTabs=[],this.tabsTimeout=0}async render(e,t,r=null,a){this.document=e,this.options=a,this.className=a.className,this.rootSelector=a.inWrapper?`.${this.className}-wrapper`:":root",this.styleMap=null,this.wrapper=t,nt(r=r||t),nt(t),ot(r,"docxjs library predefined styles"),r.appendChild(this.renderDefaultStyle()),e.themePart&&(ot(r,"docxjs document theme values"),this.renderTheme(e.themePart,r)),null!=e.stylesPart&&(this.styleMap=this.processStyles(e.stylesPart.styles),ot(r,"docxjs document styles"),r.appendChild(this.renderStyles(e.stylesPart.styles))),e.numberingPart&&(this.processNumberings(e.numberingPart.domNumberings),ot(r,"docxjs document numbering styles"),r.appendChild(this.renderNumbering(e.numberingPart.domNumberings,r))),!a.ignoreFonts&&e.fontTablePart&&this.renderFontTable(e.fontTablePart,r),e.footnotesPart&&(this.footnoteMap=b(e.footnotesPart.notes,(e=>e.id))),e.endnotesPart&&(this.endnoteMap=b(e.endnotesPart.notes,(e=>e.id))),e.settingsPart&&(this.defaultTabSize=e.settingsPart.settings?.defaultTabStop),this.options.inWrapper?(this.wrapper=this.renderWrapper(),t.appendChild(this.wrapper)):this.wrapper=t,await this.renderSections(e.documentPart.body),this.refreshTabStops()}renderDefaultStyle(){let e=this.className;return it(`\n\t\t\t.${e}-wrapper { background: gray; padding: 30px; padding-bottom: 0px; display: flex; flex-flow: column; align-items: center; line-height:normal; font-weight:normal; } \n\t\t\t.${e}-wrapper>section.${e} { background: white; box-shadow: 0 0 10px rgba(0, 0, 0, 0.5); margin-bottom: 30px; }\n\t\t\t.${e} { color: black; hyphens: auto; text-underline-position: from-font; }\n\t\t\tsection.${e} { box-sizing: border-box; display: flex; flex-flow: column nowrap; position: relative; overflow: hidden; }\n            section.${e}>header { position: absolute; top: 0; z-index: 1; display: flex; align-items: flex-end; }\n\t\t\tsection.${e}>article { z-index: 1; }\n\t\t\tsection.${e}>footer { position: absolute; bottom: 0; z-index: 1; }\n\t\t\t.${e} table { border-collapse: collapse; }\n\t\t\t.${e} table td, .${e} table th { vertical-align: top; }\n\t\t\t.${e} p { margin: 0pt; min-height: 1em; }\n\t\t\t.${e} span { white-space: pre-wrap; overflow-wrap: break-word; }\n\t\t\t.${e} a { color: inherit; text-decoration: inherit; }\n\t\t\t.${e} img, ${e} svg { vertical-align: baseline; }\n\t\t\t.${e} .clearfix::after { content: ""; display: block; line-height: 0; clear: both; }\n\t\t`)}renderTheme(e,t){let r={},a=e.theme?.fontScheme;a&&(a.majorFont&&(r["--docx-majorHAnsi-font"]=a.majorFont.latinTypeface),a.minorFont&&(r["--docx-minorHAnsi-font"]=a.minorFont.latinTypeface));let s=e.theme?.colorScheme;if(s)for(let[e,t]of Object.entries(s.colors))r[`--docx-${e}-color`]=`#${t}`;let n=this.styleToString(`.${this.className}`,r);t.appendChild(it(n))}processStyleName(e){return e?`${this.className}_${m(e)}`:this.className}processStyles(e){let t=b(e.filter((e=>null!=e.id)),(e=>e.id));for(let r of e.filter((e=>e.basedOn))){let e=t[r.basedOn];if(e){r.paragraphProps=w(r.paragraphProps,e.paragraphProps),r.runProps=w(r.runProps,e.runProps);for(let t of e.styles){let e=r.styles.find((e=>e.target==t.target));e?this.copyStyleProperties(t.values,e.values):r.styles.push({...t,values:{...t.values}})}}else this.options.debug&&console.warn(`Can't find base style ${r.basedOn}`)}for(let t of e)t.cssName=this.processStyleName(t.id);return t}renderStyles(e){let t="",r=this.styleMap,a=b(e.filter((e=>e.isDefault)),(e=>e.target));for(let s of e){let e=s.styles;if(s.linked){let t=s.linked&&r[s.linked];t?e=e.concat(t.styles):this.options.debug&&console.warn(`Can't find linked style ${s.linked}`)}for(let r of e){let e=`${s.target??""}.${s.cssName}`;s.target!=r.target&&(e+=` ${r.target}`),a[s.target]==s&&(e=`.${this.className} ${s.target}, `+e),t+=this.styleToString(e,r.values)}}return it(t)}processNumberings(e){for(let t of e.filter((e=>e.pStyleName))){let e=this.findStyle(t.pStyleName);e?.paragraphProps?.numbering&&(e.paragraphProps.numbering.level=t.level)}}renderNumbering(e,t){let r="",a=[];for(let s of e){let e=`p.${this.numberingClass(s.id,s.level)}`,n="none";if(s.bullet){let a=`--${this.className}-${s.bullet.src}`.toLowerCase();r+=this.styleToString(`${e}:before`,{content:"' '",display:"inline-block",background:`var(${a})`},s.bullet.style),this.document.loadNumberingImage(s.bullet.src).then((e=>{let r=`${this.rootSelector} { ${a}: url(${e}) }`;t.appendChild(it(r))}))}else if(s.levelText){let t=this.numberingCounter(s.id,s.level),n=t+" "+(s.start-1);s.level>0&&(r+=this.styleToString(`p.${this.numberingClass(s.id,s.level-1)}`,{"counter-reset":n})),a.push(n),r+=this.styleToString(`${e}:before`,{content:this.levelTextToContent(s.levelText,s.suff,s.id,this.numFormatToCssValue(s.format)),"counter-increment":t,...s.rStyle})}else n=this.numFormatToCssValue(s.format);r+=this.styleToString(e,{display:"list-item","list-style-position":"inside","list-style-type":n,...s.pStyle})}return a.length>0&&(r+=this.styleToString(this.rootSelector,{"counter-reset":a.join(" ")})),it(r)}numberingClass(e,t){return`${this.className}-num-${e}-${t}`}styleToString(e,t,r=null){let a=`${e} {\r\n`;for(let e in t)e.startsWith("$")||(a+=`  ${e}: ${t[e]};\r\n`);return r&&(a+=r),a+"}\r\n"}numberingCounter(e,t){return`${this.className}-num-${e}-${t}`}levelTextToContent(e,t,r,a){return`"${e.replace(/%\d*/g,(e=>{let t=parseInt(e.substring(1),10)-1;return`"counter(${this.numberingCounter(r,t)}, ${a})"`}))}${{tab:"\\9",space:"\\a0"}[t]??""}"`}numFormatToCssValue(e){return{none:"none",bullet:"disc",decimal:"decimal",lowerLetter:"lower-alpha",upperLetter:"upper-alpha",lowerRoman:"lower-roman",upperRoman:"upper-roman",decimalZero:"decimal-leading-zero",aiueo:"katakana",aiueoFullWidth:"katakana",chineseCounting:"simp-chinese-informal",chineseCountingThousand:"simp-chinese-informal",chineseLegalSimplified:"simp-chinese-formal",chosung:"hangul-consonant",ideographDigital:"cjk-ideographic",ideographTraditional:"cjk-heavenly-stem",ideographLegalTraditional:"trad-chinese-formal",ideographZodiac:"cjk-earthly-branch",iroha:"katakana-iroha",irohaFullWidth:"katakana-iroha",japaneseCounting:"japanese-informal",japaneseDigitalTenThousand:"cjk-decimal",japaneseLegal:"japanese-formal",thaiNumbers:"thai",koreanCounting:"korean-hangul-formal",koreanDigital:"korean-hangul-formal",koreanDigital2:"korean-hanja-informal",hebrew1:"hebrew",hebrew2:"hebrew",hindiNumbers:"devanagari",ganada:"hangul",taiwaneseCounting:"cjk-ideographic",taiwaneseCountingThousand:"cjk-ideographic",taiwaneseDigital:"cjk-decimal"}[e]??e}renderFontTable(e,t){for(let r of e.fonts)for(let e of r.embedFontRefs)this.document.loadFont(e.id,e.key).then((a=>{let s={"font-family":r.name,src:`url(${a})`};"bold"!=e.type&&"boldItalic"!=e.type||(s["font-weight"]="bold"),"italic"!=e.type&&"boldItalic"!=e.type||(s["font-style"]="italic"),ot(t,`docxjs ${r.name} font`);let n=this.styleToString("@font-face",s);t.appendChild(it(n)),this.refreshTabStops()}))}renderWrapper(){return rt("div",{className:`${this.className}-wrapper`})}copyStyleProperties(e,t,r=null){if(!e)return t;null==t&&(t={}),null==r&&(r=Object.getOwnPropertyNames(e));for(let a of r)e.hasOwnProperty(a)&&!t.hasOwnProperty(a)&&(t[a]=e[a]);return t}processElement(e){if(e.children)for(let t of e.children)t.parent=e,t.type==T.Table?(this.processTable(t),this.processElement(t)):this.processElement(t)}processTable(e){for(let t of e.children)for(let r of t.children)r.cssStyle=this.copyStyleProperties(e.cellStyle,r.cssStyle,["border-left","border-right","border-top","border-bottom","padding-left","padding-right","padding-top","padding-bottom"])}splitBySection(e){let t={sectProps:null,elements:[],is_split:!1},r=[t];for(let a of e){if(a.level=1,t.elements.push(a),a.type==T.Paragraph){let e=a,s=e.sectionProps;s&&(s.uuid=x());let n=this.findStyle(e.styleName);n?.paragraphProps?.pageBreakBefore&&(t.is_split=!0,t.sectProps=s,t={sectProps:null,elements:[],is_split:!1},r.push(t));let l=-1,i=-1;if(e.children&&(l=e.children.findIndex((e=>(i=e.children?.findIndex((e=>e.type==T.Break&&("lastRenderedPageBreak"==e.break?t.elements.length>2||!this.options.ignoreLastRenderedPageBreak:"page"===e.break||void 0))),i=i??-1,-1!=i)))),-1!=l){t.is_split=!0;let e=t.elements.some((e=>e.type===T.Table));e&&(t.is_split=!1);let r=t.elements.some((e=>e.children.some((e=>e.type===T.Hyperlink&&e?.href?.includes("Toc")))));r&&(t.is_split=!1)}if((-1!=l||s&&s.type!=M.Continuous&&s.type!=M.NextColumn)&&(t.sectProps=s,t={sectProps:null,elements:[],is_split:!1},r.push(t)),-1!=l){let r=e.children[l],a=i<r.children.length-1;if(l<e.children.length-1||a){let s=e.children,n={...e,children:s.slice(l)};if(e.children=s.slice(0,l),t.elements.push(n),a){let t=r.children,a={...r,children:t.slice(0,i)};e.children.push(a),r.children=t.slice(i)}}}}a.type===T.Table&&(t.is_split=!1)}let a=null;for(let e=r.length-1;e>=0;e--)null==r[e].sectProps?r[e].sectProps=a:a=r[e].sectProps;return r}async renderSections(e){let t;this.processElement(e),t=this.options.breakPages?this.splitBySection(e.children):[{sectProps:e.props,elements:e.children,is_split:!1}];let r=null;for(let a=0,s=t.length;a<s;a++){this.currentFootnoteIds=[];let n=t[a],{sectProps:l}=n;n.sectProps=l??e.props,n.isFirstSection=r!=l,n.isLastSection=a===s-1,n.pageIndex=a,n.checking_overflow=!1,this.current_section=n,r=l,await this.renderSection()}}async renderSection(){let e=this.current_section,{is_split:t,sectProps:r,isFirstSection:a,isLastSection:s,pageIndex:n}=e,l=this.createSection(this.className,r);l.dataset.splited=String(t),this.renderStyleValues(this.document.documentPart.body.cssStyle,l),this.options.renderHeaders&&await this.renderHeaderFooterRef(r.headerRefs,r,n,a,l),this.options.renderFootnotes&&await this.renderNotes(this.currentFootnoteIds,this.footnoteMap,l),this.options.renderEndnotes&&s&&await this.renderNotes(this.currentEndnoteIds,this.endnoteMap,l),this.options.renderFooters&&await this.renderHeaderFooterRef(r.footerRefs,r,n,a,l);let i=this.createSectionContent(r);this.options.breakPages?i.style.height=r.contentSize.height:i.style.minHeight=r.contentSize.height,this.current_section.contentElement=i,l.appendChild(i),this.current_section.checking_overflow=!0,await this.renderElements(e.elements,i),this.current_section.checking_overflow=!1}createSection(e,t){let r=rt("section",{className:e});return t&&(r.dataset.uuid=t.uuid,t.pageMargins&&(r.style.paddingLeft=t.pageMargins.left,r.style.paddingRight=t.pageMargins.right,r.style.paddingTop=t.pageMargins.top,r.style.paddingBottom=t.pageMargins.bottom),t.pageSize&&(this.options.ignoreWidth||(r.style.width=t.pageSize.width),this.options.ignoreHeight||(r.style.minHeight=t.pageSize.height))),this.wrapper.appendChild(r),r}createSectionContent(e){const t=rt("article");return e.columns&&e.columns.numberOfColumns&&(t.style.columnCount=`${e.columns.numberOfColumns}`,t.style.columnGap=e.columns.space,e.columns.separator&&(t.style.columnRule="1px solid black")),t}async renderHeaderFooterRef(e,t,r,a,s){if(!e)return;let n=(t.titlePage&&a?e.find((e=>"first"==e.type)):null)??(r%2==1?e.find((e=>"even"==e.type)):null)??e.find((e=>"default"==e.type)),l=n&&this.document.findPartByRelId(n.id,this.document.documentPart);if(l){switch(this.currentPart=l,this.usedHederFooterParts.includes(l.path)||(this.processElement(l.rootElement),this.usedHederFooterParts.push(l.path)),l.rootElement.type){case T.Header:l.rootElement.cssStyle={left:t.pageMargins?.left,width:t.contentSize?.width,height:t.pageMargins?.top};break;case T.Footer:l.rootElement.cssStyle={left:t.pageMargins?.left,width:t.contentSize?.width,height:t.pageMargins?.bottom};break;default:console.warn("set header/footer style error",l.rootElement.type)}await this.renderElements([l.rootElement],s),this.currentPart=null}}async renderNotes(e,t,r){let a=e.map((e=>t[e])).filter((e=>e));if(a.length>0){let e=rt("ol",null);await this.renderElements(a,e),r.appendChild(e)}}async renderElements(e,t){let r=et.FALSE;for(let a=0;a<e.length;a++){1===e[a].level&&(this.current_section.elementIndex=a);let s=await this.renderElement(e[a],t);if(s?.dataset?.overflow===et.TRUE){r=et.TRUE;break}}return r}async renderElement(e,t){let r;switch(e.type){case T.Paragraph:r=await this.renderParagraph(e,t);break;case T.Run:r=await this.renderRun(e,t);break;case T.Text:r=await this.renderText(e,t);break;case T.Table:r=await this.renderTable(e,t);break;case T.Row:r=await this.renderTableRow(e,t);break;case T.Cell:r=await this.renderTableCell(e),t&&lt(t,r);break;case T.Hyperlink:r=await this.renderHyperlink(e,t);break;case T.Drawing:r=await this.renderDrawing(e,t);break;case T.Image:r=await this.renderImage(e,t);break;case T.BookmarkStart:r=this.renderBookmarkStart(e),t&&lt(t,r);break;case T.BookmarkEnd:r=null;break;case T.Tab:r=await this.renderTab(e,t);break;case T.Symbol:r=await this.renderSymbol(e,t);break;case T.Break:r=await this.renderBreak(e,t);break;case T.Inserted:r=await this.renderInserted(e),t&&await this.appendChildren(t,r);break;case T.Deleted:r=await this.renderDeleted(e),t&&await this.appendChildren(t,r);break;case T.DeletedText:r=await this.renderDeletedText(e,t);break;case T.NoBreakHyphen:r=rt("wbr"),t&&await this.appendChildren(t,r);break;case T.CommentRangeStart:r=this.renderCommentRangeStart(e),t&&lt(t,r);break;case T.CommentRangeEnd:r=this.renderCommentRangeEnd(e),t&&lt(t,r);break;case T.CommentReference:r=this.renderCommentReference(e),t&&lt(t,r);break;case T.Footer:r=await this.renderHeaderFooter(e,"footer"),t&&lt(t,r);break;case T.Header:r=await this.renderHeaderFooter(e,"header"),t&&lt(t,r);break;case T.Footnote:case T.Endnote:r=await this.renderContainer(e,"li"),t&&lt(t,r);break;case T.FootnoteReference:r=this.renderFootnoteReference(e),t&&lt(t,r);break;case T.EndnoteReference:r=this.renderEndnoteReference(e),t&&lt(t,r);break;case T.VmlElement:r=await this.renderVmlElement(e,t);break;case T.VmlPicture:r=await this.renderVmlPicture(e),t&&lt(t,r);break;case T.MmlMath:r=await this.renderContainerNS(e,Qe,"math",{xmlns:Qe}),t&&(r.dataset.overflow=await this.appendChildren(t,r));break;case T.MmlMathParagraph:r=await this.renderContainer(e,"span"),t&&lt(t,r);break;case T.MmlFraction:r=await this.renderContainerNS(e,Qe,"mfrac"),t&&lt(t,r);break;case T.MmlBase:r=await this.renderContainerNS(e,Qe,e.parent.type==T.MmlMatrixRow?"mtd":"mrow"),t&&lt(t,r);break;case T.MmlNumerator:case T.MmlDenominator:case T.MmlFunction:case T.MmlLimit:case T.MmlBox:r=await this.renderContainerNS(e,Qe,"mrow"),t&&lt(t,r);break;case T.MmlGroupChar:r=await this.renderMmlGroupChar(e),t&&lt(t,r);break;case T.MmlLimitLower:r=await this.renderContainerNS(e,Qe,"munder"),t&&lt(t,r);break;case T.MmlMatrix:r=await this.renderContainerNS(e,Qe,"mtable"),t&&lt(t,r);break;case T.MmlMatrixRow:r=await this.renderContainerNS(e,Qe,"mtr"),t&&lt(t,r);break;case T.MmlRadical:r=await this.renderMmlRadical(e),t&&lt(t,r);break;case T.MmlSuperscript:r=await this.renderContainerNS(e,Qe,"msup"),t&&lt(t,r);break;case T.MmlSubscript:r=await this.renderContainerNS(e,Qe,"msub"),t&&lt(t,r);break;case T.MmlDegree:case T.MmlSuperArgument:case T.MmlSubArgument:r=await this.renderContainerNS(e,Qe,"mn"),t&&lt(t,r);break;case T.MmlFunctionName:r=await this.renderContainerNS(e,Qe,"ms"),t&&lt(t,r);break;case T.MmlDelimiter:r=await this.renderMmlDelimiter(e),t&&lt(t,r);break;case T.MmlRun:r=await this.renderMmlRun(e),t&&lt(t,r);break;case T.MmlNary:r=await this.renderMmlNary(e),t&&lt(t,r);break;case T.MmlPreSubSuper:r=await this.renderMmlPreSubSuper(e),t&&lt(t,r);break;case T.MmlBar:r=await this.renderMmlBar(e),t&&lt(t,r);break;case T.MmlEquationArray:r=await this.renderMllList(e),t&&lt(t,r)}return r&&1===r?.nodeType&&(r.dataset.tag=e.type),r}isPageBreakElement(e){return e.type==T.Break&&("lastRenderedPageBreak"==e.break?!this.options.ignoreLastRenderedPageBreak:"page"===e.break||void 0)}async renderChildren(e,t){return await this.renderElements(e.children,t)}async appendChildren(e,t,r){lt(e,t);let a=!1,{is_split:s,contentElement:n,pageIndex:l,elementIndex:i,checking_overflow:o,elements:c}=this.current_section;if(s)return et.UNKNOWN;if(o&&(a=function(e){let t=getComputedStyle(e).overflow;t&&"visible"!==t||(e.style.overflow="hidden");let r=e.clientHeight<e.scrollHeight;return e.style.overflow=t,r}(n),a)){if(r?.type===T.Row){let e=c[i],t=e.children.findIndex((e=>e===r)),a=e.children.filter((e=>e.isHeader));e.children.splice(0,t),e.children=[...a,...e.children]}c.splice(0,i),i=0,function(e,t){Array.isArray(e)?e.forEach((e=>{e instanceof Element?e.remove():t&&t.removeChild(e)})):e instanceof Element?e.remove():e&&t.removeChild(e)}(t,e),l+=1,o=!1,this.current_section={...this.current_section,pageIndex:l,checking_overflow:o,elements:c,elementIndex:i},await this.renderSection()}return a?et.TRUE:et.FALSE}async renderContainer(e,t,r){let a=rt(t,r);return await this.renderChildren(e,a),a}async renderContainerNS(e,t,r,a){let s=st(t,r,a);return await this.renderChildren(e,s),s}async renderParagraph(e,t){let r=rt("p");r.dataset.uuid=x(),this.renderClass(e,r),this.renderStyleValues(e.cssStyle,r),this.renderCommonProperties(r.style,e);let a=this.findStyle(e.styleName);e.tabs??(e.tabs=a?.paragraphProps?.tabs);let s=e.numbering??a?.paragraphProps?.numbering;if(s&&r.classList.add(this.numberingClass(s.id,s.level)),e.children.some((e=>{let t=e?.children?.some((e=>e.type===T.Drawing&&e.props.wrapType===A.TopAndBottom)),r=e?.children?.some((e=>e.type===T.Break&&e?.props?.clear));return t||r}))&&r.classList.add("clearfix"),r.style.position="relative",t){if(await this.appendChildren(t,r)===et.TRUE)return r.dataset.overflow=et.TRUE,r}return r.dataset.overflow=await this.renderChildren(e,r),r}async renderRun(e,t){if(e.fieldRun)return null;let r=rt("span");if(e.id&&(r.id=e.id),this.renderClass(e,r),this.renderStyleValues(e.cssStyle,r),t){if(await this.appendChildren(t,r)===et.TRUE)return r.dataset.overflow=et.TRUE,r}if(e.verticalAlign){let t=rt(e.verticalAlign);r.dataset.overflow=await this.renderChildren(e,t),r.dataset.overflow=await this.appendChildren(r,t)}else r.dataset.overflow=await this.renderChildren(e,r);return r}async renderText(e,t){let r=document.createTextNode(e.text);return t&&lt(t,r),r}async renderTable(e,t){let r=rt("table");if(r.dataset.uuid=x(),this.tableCellPositions.push(this.currentCellPosition),this.tableVerticalMerges.push(this.currentVerticalMerge),this.currentVerticalMerge={},this.currentCellPosition={col:0,row:0},this.renderClass(e,r),this.renderStyleValues(e.cssStyle,r),t){if(await this.appendChildren(t,r)===et.TRUE)return r.dataset.overflow=et.TRUE,r}return e.columns&&await this.renderTableColumns(e.columns,r),r.dataset.overflow=await this.renderChildren(e,r),this.currentVerticalMerge=this.tableVerticalMerges.pop(),this.currentCellPosition=this.tableCellPositions.pop(),r}async renderTableColumns(e,t){let r=rt("colgroup");t&&lt(t,r);for(let t of e){let e=rt("col");t.width&&(e.style.width=t.width),lt(r,e)}return r}async renderTableRow(e,t){let r=rt("tr");return this.currentCellPosition.col=0,this.renderClass(e,r),this.renderStyleValues(e.cssStyle,r),this.currentCellPosition.row++,await this.renderChildren(e,r),t&&(r.dataset.overflow=await this.appendChildren(t,r,e)),r}async renderTableCell(e){let t=rt("td"),r=this.currentCellPosition.col;return e.verticalMerge?"restart"==e.verticalMerge?(this.currentVerticalMerge[r]=t,t.rowSpan=1):this.currentVerticalMerge[r]&&(this.currentVerticalMerge[r].rowSpan+=1,t.style.display="none"):this.currentVerticalMerge[r]=null,this.renderClass(e,t),this.renderStyleValues(e.cssStyle,t),e.span&&(t.colSpan=e.span),this.currentCellPosition.col+=t.colSpan,await this.renderChildren(e,t),t}async renderHyperlink(e,t){let r=rt("a");if(this.renderStyleValues(e.cssStyle,r),t){if(await this.appendChildren(t,r)===et.TRUE)return r.dataset.overflow=et.TRUE,r}if(e.href)r.href=e.href;else if(e.id){let t=this.document.documentPart.rels.find((t=>t.id==e.id&&"External"===t.targetMode));r.href=t?.target}return r.dataset.overflow=await this.renderChildren(e,r),r}async renderDrawing(e,t){let r=rt("span");if(r.style.textIndent="0px",r.dataset.wrap=e?.props.wrapType,this.renderStyleValues(e.cssStyle,r),t){if(await this.appendChildren(t,r)===et.TRUE)return r.dataset.overflow=et.TRUE,r}return r.dataset.overflow=await this.renderChildren(e,r),r}async renderImage(e,t){let r=rt("img");return this.renderStyleValues(e.cssStyle,r),this.document&&(r.src=await this.document.loadDocumentImage(e.src,this.currentPart)),t&&(r.dataset.overflow=await this.appendChildren(t,r)),r}renderBookmarkStart(e){let t=rt("span");return t.id=e.name,t}async renderTab(e,t){let r=rt("span");if(r.innerHTML="&emsp;",this.options.experimental){r.className=this.tabStopClass();let t=function(e,t){let r=e.parent;for(;null!=r&&r.type!=t;)r=r.parent;return r}(e,T.Paragraph)?.tabs;this.currentTabs.push({stops:t,span:r})}return t&&await this.appendChildren(t,r),r}async renderSymbol(e,t){let r=rt("span");return r.style.fontFamily=e.font,r.innerHTML=`&#x${e.char};`,t&&await this.appendChildren(t,r),r}async renderBreak(e,t){let r;switch(e.break){case"page":r=rt("br"),r.classList.add("break","page");break;case"textWrapping":r=rt("br"),r.classList.add("break","textWrap");break;case"column":r=rt("br"),r.classList.add("break","column");break;case"lastRenderedPageBreak":r=rt("wbr"),r.classList.add("break","lastRenderedPageBreak")}return t&&lt(t,r),r}renderInserted(e){return this.options.renderChanges?this.renderContainer(e,"ins"):this.renderContainer(e,"span")}async renderDeleted(e){return this.options.renderChanges?await this.renderContainer(e,"del"):null}async renderDeletedText(e,t){let r;return this.options.renderEndnotes?(r=document.createTextNode(e.text),t&&await this.appendChildren(t,r)):r=null,r}renderCommentRangeStart(e){return this.options.experimental?document.createComment(`start of comment #${e.id}`):null}renderCommentRangeEnd(e){return this.options.experimental?document.createComment(`end of comment #${e.id}`):null}renderCommentReference(e){if(!this.options.experimental)return null;const t=this.document.commentsPart?.commentMap[e.id];return t?document.createComment(`comment #${t.id} by ${t.author} on ${t.date}`):null}async renderHeaderFooter(e,t){let r=rt(t);return await this.renderChildren(e,r),this.renderStyleValues(e.cssStyle,r),r}renderFootnoteReference(e){let t=rt("sup");return this.currentFootnoteIds.push(e.id),t.textContent=`${this.currentFootnoteIds.length}`,t}renderEndnoteReference(e){let t=rt("sup");return this.currentEndnoteIds.push(e.id),t.textContent=`${this.currentEndnoteIds.length}`,t}async renderVmlElement(e,t){let r=at("svg");r.setAttribute("style",e.cssStyleText);let a=await this.renderVmlChildElement(e);if(e.imageHref?.id){let t=await(this.document?.loadDocumentImage(e.imageHref.id,this.currentPart));a.setAttribute("href",t)}return lt(r,a),requestAnimationFrame((()=>{let e=r.firstElementChild.getBBox();r.setAttribute("width",`${Math.ceil(e.x+e.width)}`),r.setAttribute("height",`${Math.ceil(e.y+e.height)}`)})),t&&(r.dataset.overflow=await this.appendChildren(t,r)),r}async renderVmlPicture(e){let t=rt("span");return await this.renderChildren(e,t),t}async renderVmlChildElement(e){let t=at(e.tagName);Object.entries(e.attrs).forEach((([e,r])=>t.setAttribute(e,r)));for(let r of e.children)if(r.type==T.VmlElement){let e=await this.renderVmlChildElement(r);lt(t,e)}else await this.renderElement(r,t);return t}async renderMmlRadical(e){let t,r=e.children.find((e=>e.type==T.MmlBase));if(e.props?.hideDegree)return t=st(Qe,"msqrt",null),await this.renderElements([r],t),t;let a=e.children.find((e=>e.type==T.MmlDegree));return t=st(Qe,"mroot",null),await this.renderElements([r,a],t),t}async renderMmlDelimiter(e){let t=st(Qe,"mrow",null);return lt(t,st(Qe,"mo",null,[e.props.beginChar??"("])),await this.renderElements(e.children,t),lt(t,st(Qe,"mo",null,[e.props.endChar??")"])),t}async renderMmlNary(e){let t=[],r=b(e.children,(e=>e.type)),a=r[T.MmlSuperArgument],s=r[T.MmlSubArgument],n=a?st(Qe,"mo",null,S(await this.renderElement(a))):null,l=s?st(Qe,"mo",null,S(await this.renderElement(s))):null,i=st(Qe,"mo",null,[e.props?.char??"∫"]);n||l?t.push(st(Qe,"munderover",null,[i,l,n])):n?t.push(st(Qe,"mover",null,[i,n])):l?t.push(st(Qe,"munder",null,[i,l])):t.push(i);let o=st(Qe,"mrow",null);return lt(o,t),await this.renderElements(r[T.MmlBase].children,o),o}async renderMmlPreSubSuper(e){let t=[],r=b(e.children,(e=>e.type)),a=r[T.MmlSuperArgument],s=r[T.MmlSubArgument],n=a?st(Qe,"mo",null,S(await this.renderElement(a))):null,l=s?st(Qe,"mo",null,S(await this.renderElement(s))):null,i=st(Qe,"mo",null);t.push(st(Qe,"msubsup",null,[i,l,n]));let o=st(Qe,"mrow",null);return lt(o,t),await this.renderElements(r[T.MmlBase].children,o),o}async renderMmlGroupChar(e){let t="bot"===e.props.verticalJustification?"mover":"munder",r=await this.renderContainerNS(e,Qe,t);if(e.props.char){lt(r,st(Qe,"mo",null,[e.props.char]))}return r}async renderMmlBar(e){let t=await this.renderContainerNS(e,Qe,"mrow");switch(e.props.position){case"top":t.style.textDecoration="overline";break;case"bottom":t.style.textDecoration="underline"}return t}async renderMmlRun(e){let t=st(Qe,"ms");return this.renderClass(e,t),this.renderStyleValues(e.cssStyle,t),await this.renderChildren(e,t),t}async renderMllList(e){let t=st(Qe,"mtable");this.renderClass(e,t),this.renderStyleValues(e.cssStyle,t);for(let r of e.children){let e=await this.renderElement(r),a=st(Qe,"mtd",null,[e]);lt(t,st(Qe,"mtr",null,[a]))}return t}renderStyleValues(e,t){for(let r in e)r.startsWith("$")?t.setAttribute(r.slice(1),e[r]):t.style[r]=e[r]}renderRunProperties(e,t){this.renderCommonProperties(e,t)}renderCommonProperties(e,t){null!=t&&(t.color&&(e.color=t.color),t.fontSize&&(e["font-size"]=t.fontSize))}renderClass(e,t){e.className&&(t.className=e.className),e.styleName&&t.classList.add(this.processStyleName(e.styleName))}findStyle(e){return e&&this.styleMap?.[e]}tabStopClass(){return`${this.className}-tab-stop`}refreshTabStops(){this.options.experimental&&(clearTimeout(this.tabsTimeout),this.tabsTimeout=setTimeout((()=>{let e=He();for(let t of this.currentTabs)Ve(t.span,t.stops,this.defaultTabSize,e)}),500))}}function rt(e,t){return st(null,e,t)}function at(e,t){return st(Ke,e,t)}function st(e,t,r,a){let s;switch(e){case"http://www.w3.org/1998/Math/MathML":case"http://www.w3.org/2000/svg":s=document.createElementNS(e,t);break;default:s=document.createElement(t)}return r&&Object.assign(s,r),a&&lt(s,a),s}function nt(e){e.innerHTML=""}function lt(e,t){Array.isArray(t)?e.append(...t):t&&(k(t)?e.append(t):e.appendChild(t))}function it(e){return rt("style",{innerHTML:e})}function ot(e,t){e.appendChild(document.createComment(t))}const ct={className:"docx",inWrapper:!0,ignoreHeight:!1,ignoreWidth:!1,ignoreFonts:!1,ignoreTableWrap:!0,ignoreImageWrap:!1,ignoreLastRenderedPageBreak:!0,breakPages:!0,trimXmlDeclaration:!0,useBase64URL:!1,renderHeaders:!0,renderFooters:!0,renderFootnotes:!0,renderEndnotes:!0,renderChanges:!1,experimental:!1,debug:!1};e.defaultOptions=ct,e.parseAsync=function(e,t=null){const r={...ct,...t};return ge.load(e,new De(r),r)},e.renderAsync=async function(e,t,r=null,a=null){const s={...ct,...a},n=new We,l=await ge.load(e,new De(s),s);return await n.render(l,t,r,s),l},e.renderSync=async function(e,t,r=null,a=null){const s={...ct,...a},n=new tt,l=await ge.load(e,new De(s),s);return await n.render(l,t,r,s),l}}));
//# sourceMappingURL=docx-preview.min.js.map
